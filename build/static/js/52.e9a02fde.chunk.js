"use strict";(self.webpackChunkemployee_management_system=self.webpackChunkemployee_management_system||[]).push([[52],{2052:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});var s=a(5043),r=a(6339),i=a(579);function l(){const[e,t]=(0,s.useState)([]),[a,l]=(0,s.useState)({employee_id:"",title:"",appreciation_date:"",description:""}),[n,d]=(0,s.useState)(!1),[c,o]=(0,s.useState)([]),[p,x]=(0,s.useState)(""),[m,h]=(0,s.useState)([]),[u,y]=(0,s.useState)(!1),[g,f]=(0,s.useState)([]),[b,j]=(0,s.useState)(!1),[w,N]=(0,s.useState)("");(0,s.useEffect)(()=>{(async()=>{const[e,a,s]=await Promise.all([fetch("/api/employees"),fetch("/api/appreciations"),fetch("/api/appreciation-types")]);if(e.ok){const a=await e.json();t(Array.isArray(a.data)?a.data:Array.isArray(a)?a:[])}a.ok&&o(await a.json()),s.ok&&f((await s.json()).map(e=>e.name))})()},[]);const v=(0,s.useMemo)(()=>{const e=p.trim().toLowerCase();return e?c.filter(t=>(t.employee_name||"").toLowerCase().includes(e)):c},[c,p]);return(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Appreciations"}),(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!a.employee_id||!a.title||!a.description.trim())return alert("All fields are required.");d(!0);try{const e=await fetch("/api/appreciations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),t=await e.text();let s;try{s=JSON.parse(t)}catch{s={error:t}}if(!e.ok)throw new Error(s.error||"Failed to save");l({employee_id:"",title:"",appreciation_date:"",description:""}),o(e=>[s.item,...e]),alert("Saved")}catch(t){alert(t.message)}finally{d(!1)}},className:"space-y-4 bg-white p-4 rounded border",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee"}),(0,i.jsxs)("select",{value:a.employee_id,onChange:e=>l(t=>({...t,employee_id:e.target.value})),className:"w-full border rounded px-3 py-2",children:[(0,i.jsx)("option",{value:"",children:"Select..."}),(e||[]).map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appreciation"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)("select",{value:a.title,onChange:e=>l(t=>({...t,title:e.target.value})),className:"w-full border rounded px-3 py-2",children:[(0,i.jsx)("option",{value:"",children:"Select..."}),g.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]}),(0,i.jsx)("button",{type:"button",className:"px-3 py-2 border rounded text-sm",onClick:()=>j(!0),children:"Add"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,i.jsx)("input",{type:"date",value:a.appreciation_date,onChange:e=>l(t=>({...t,appreciation_date:e.target.value})),className:"w-full border rounded px-3 py-2"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,i.jsx)("textarea",{value:a.description,onChange:e=>l(t=>({...t,description:e.target.value})),className:"w-full border rounded px-3 py-2",rows:4})]}),(0,i.jsx)("div",{className:"flex justify-end",children:(0,i.jsx)("button",{type:"submit",disabled:n,className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 disabled:opacity-50",children:n?"Saving...":"Save"})})]}),b&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:(0,i.jsxs)("div",{className:"bg-white rounded shadow-lg w-full max-w-sm p-4",children:[(0,i.jsx)("div",{className:"text-lg font-semibold mb-3",children:"Add Appreciation"}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsx)("input",{type:"text",value:w,onChange:e=>N(e.target.value),placeholder:"e.g. Outstanding Performance",className:"w-full border rounded px-3 py-2"}),(0,i.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,i.jsx)("button",{type:"button",className:"px-3 py-2 border rounded",onClick:()=>{j(!1),N("")},children:"Cancel"}),(0,i.jsx)("button",{type:"button",className:"px-3 py-2 bg-indigo-600 text-white rounded",onClick:async()=>{const e=w.trim();if(e)try{const t=await fetch("/api/appreciation-types",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}),a=await t.text();let s;try{s=JSON.parse(a)}catch{s={error:a}}if(!t.ok)throw new Error(s.error||"Failed");const r=s.name||e;f(e=>Array.from(new Set([...e,r]))),l(e=>({...e,title:r})),j(!1),N("")}catch(t){alert(t.message)}},children:"Save"})]})]})]})}),(0,i.jsxs)("div",{className:"mt-6 bg-white rounded-lg shadow-sm border",children:[(0,i.jsxs)("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Appreciation Records"}),m.length>0&&(0,i.jsxs)("button",{onClick:async()=>{if(0!==m.length){if(confirm(`Are you sure you want to delete ${m.length} appreciation record(s)?`)){y(!0);try{const e=await fetch("/api/appreciations/bulk",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:m})});if(e.ok){const t=await e.json();o(e=>e.filter(e=>!m.includes(e.id))),h([]),alert(t.message)}else{const t=await e.json();alert(t.error||"Error deleting records")}}catch(e){console.error("Error bulk deleting appreciations:",e),alert("Error deleting records")}finally{y(!1)}}}else alert("Please select appreciations to delete")},disabled:u,className:"flex items-center px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,i.jsx)(r.A,{className:"w-4 h-4 mr-2"}),u?"Deleting...":`Delete Selected (${m.length})`]})]}),(0,i.jsx)("input",{type:"text",placeholder:"Search by employee...",value:p,onChange:e=>x(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 w-64 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,i.jsx)("thead",{className:"bg-gray-50",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"px-6 py-3 text-left",children:(0,i.jsx)("input",{type:"checkbox",checked:v.length>0&&v.every(e=>m.includes(e.id)),onChange:()=>{const e=v.map(e=>e.id),t=e.every(e=>m.includes(e));h(t?t=>t.filter(t=>!e.includes(t)):t=>[...new Set([...t,...e])])},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"})}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Appreciation"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,i.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===v.length?(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"7",className:"px-6 py-8 text-center text-gray-500",children:"No appreciation records found"})}):v.map(e=>(0,i.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,i.jsx)("input",{type:"checkbox",checked:m.includes(e.id),onChange:()=>{return t=e.id,void h(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"})}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.employee_name}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.title}),(0,i.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",title:e.description,children:e.description}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.appreciation_date?new Date(e.appreciation_date).toLocaleDateString():"-"}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleString()}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,i.jsx)("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this appreciation record?")){y(!0);try{const t=await fetch(`/api/appreciations/${e}`,{method:"DELETE"});if(t.ok)o(t=>t.filter(t=>t.id!==e)),h(t=>t.filter(t=>t!==e));else{const e=await t.json();alert(e.error||"Error deleting record")}}catch(t){console.error("Error deleting appreciation:",t),alert("Error deleting record")}finally{y(!1)}}})(e.id),disabled:u,className:"text-red-600 hover:text-red-900 disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete appreciation",children:(0,i.jsx)(r.A,{className:"w-4 h-4"})})})]},e.id))})]})})]})]})}}}]);
//# sourceMappingURL=52.e9a02fde.chunk.js.map