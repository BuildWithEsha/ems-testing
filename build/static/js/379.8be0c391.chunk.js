"use strict";(self.webpackChunkemployee_management_system=self.webpackChunkemployee_management_system||[]).push([[379],{1379:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var r=a(5043),s=a(6339),l=a(579);function i(){const[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)({employee_id:"",title:"",warning_date:"",description:"",severity:"Low"}),[n,d]=(0,r.useState)(!1),[c,o]=(0,r.useState)([]),[x,p]=(0,r.useState)(""),[m,h]=(0,r.useState)([]),[u,y]=(0,r.useState)(!1),[g,w]=(0,r.useState)([]),[f,b]=(0,r.useState)(!1),[j,v]=(0,r.useState)(""),N=[{value:"Low",label:"Low",color:"text-yellow-600 bg-yellow-100"},{value:"Medium",label:"Medium",color:"text-orange-600 bg-orange-100"},{value:"High",label:"High",color:"text-red-600 bg-red-100"}];(0,r.useEffect)(()=>{(async()=>{const[e,a,r]=await Promise.all([fetch("/api/employees"),fetch("/api/warning-letters"),fetch("/api/warning-letter-types")]);if(e.ok){const a=await e.json();t(Array.isArray(a.data)?a.data:Array.isArray(a)?a:[])}a.ok&&o(await a.json()),r.ok&&w((await r.json()).map(e=>e.name))})()},[]);const k=(0,r.useMemo)(()=>{const e=x.trim().toLowerCase();return e?c.filter(t=>(t.employee_name||"").toLowerCase().includes(e)):c},[c,x]),S=e=>{const t=N.find(t=>t.value===e);return t?t.color:"text-gray-600 bg-gray-100"};return(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Warning Letters"}),(0,l.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!a.employee_id||!a.title||!a.description.trim())return alert("All fields are required.");d(!0);try{const e=await fetch("/api/warning-letters",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),t=await e.text();let r;try{r=JSON.parse(t)}catch{r={error:t}}if(!e.ok)throw new Error(r.error||"Failed to save");i({employee_id:"",title:"",warning_date:"",description:"",severity:"Low"}),o(e=>[r.item,...e]),alert("Warning letter saved successfully")}catch(t){alert(t.message)}finally{d(!1)}},className:"space-y-4 bg-white p-4 rounded border",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee"}),(0,l.jsxs)("select",{value:a.employee_id,onChange:e=>i(t=>({...t,employee_id:e.target.value})),className:"w-full border rounded px-3 py-2",children:[(0,l.jsx)("option",{value:"",children:"Select..."}),(e||[]).map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warning Type"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)("select",{value:a.title,onChange:e=>i(t=>({...t,title:e.target.value})),className:"w-full border rounded px-3 py-2",children:[(0,l.jsx)("option",{value:"",children:"Select..."}),g.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]}),(0,l.jsx)("button",{type:"button",className:"px-3 py-2 border rounded text-sm",onClick:()=>b(!0),children:"Add"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,l.jsx)("input",{type:"date",value:a.warning_date,onChange:e=>i(t=>({...t,warning_date:e.target.value})),className:"w-full border rounded px-3 py-2"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Severity"}),(0,l.jsx)("select",{value:a.severity,onChange:e=>i(t=>({...t,severity:e.target.value})),className:"w-full border rounded px-3 py-2",children:N.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,l.jsx)("textarea",{value:a.description,onChange:e=>i(t=>({...t,description:e.target.value})),className:"w-full border rounded px-3 py-2",rows:4,placeholder:"Describe the warning details..."})]}),(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsx)("button",{type:"submit",disabled:n,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50",children:n?"Saving...":"Save Warning Letter"})})]}),f&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded shadow-lg w-full max-w-sm p-4",children:[(0,l.jsx)("div",{className:"text-lg font-semibold mb-3",children:"Add Warning Type"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("input",{type:"text",value:j,onChange:e=>v(e.target.value),placeholder:"e.g. Attendance Violation",className:"w-full border rounded px-3 py-2"}),(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)("button",{type:"button",className:"px-3 py-2 border rounded",onClick:()=>{b(!1),v("")},children:"Cancel"}),(0,l.jsx)("button",{type:"button",className:"px-3 py-2 bg-red-600 text-white rounded",onClick:async()=>{const e=j.trim();if(e)try{const t=await fetch("/api/warning-letter-types",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}),a=await t.text();let r;try{r=JSON.parse(a)}catch{r={error:a}}if(!t.ok)throw new Error(r.error||"Failed");const s=r.name||e;w(e=>Array.from(new Set([...e,s]))),i(e=>({...e,title:s})),b(!1),v("")}catch(t){alert(t.message)}},children:"Save"})]})]})]})}),(0,l.jsxs)("div",{className:"mt-6 bg-white rounded-lg shadow-sm border",children:[(0,l.jsxs)("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Warning Letter Records"}),m.length>0&&(0,l.jsxs)("button",{onClick:async()=>{if(0!==m.length){if(confirm(`Are you sure you want to delete ${m.length} warning letter record(s)?`)){y(!0);try{const e=await fetch("/api/warning-letters/bulk",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:m})});if(e.ok){const t=await e.json();o(e=>e.filter(e=>!m.includes(e.id))),h([]),alert(t.message)}else{const t=await e.json();alert(t.error||"Error deleting records")}}catch(e){console.error("Error bulk deleting warning letters:",e),alert("Error deleting records")}finally{y(!1)}}}else alert("Please select warning letters to delete")},disabled:u,className:"flex items-center px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,l.jsx)(s.A,{className:"w-4 h-4 mr-2"}),u?"Deleting...":`Delete Selected (${m.length})`]})]}),(0,l.jsx)("input",{type:"text",placeholder:"Search by employee...",value:x,onChange:e=>p(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 w-64 focus:ring-2 focus:ring-red-500 focus:border-red-500"})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left",children:(0,l.jsx)("input",{type:"checkbox",checked:k.length>0&&k.every(e=>m.includes(e.id)),onChange:()=>{const e=k.map(e=>e.id),t=e.every(e=>m.includes(e));h(t?t=>t.filter(t=>!e.includes(t)):t=>[...new Set([...t,...e])])},className:"h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded"})}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Warning Type"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Severity"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===k.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:"8",className:"px-6 py-8 text-center text-gray-500",children:"No warning letter records found"})}):k.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("input",{type:"checkbox",checked:m.includes(e.id),onChange:()=>{return t=e.id,void h(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded"})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.employee_name}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.title}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${S(e.severity)}`,children:e.severity})}),(0,l.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",title:e.description,children:e.description}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.warning_date?new Date(e.warning_date).toLocaleDateString():"-"}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleString()}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,l.jsx)("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this warning letter record?")){y(!0);try{const t=await fetch(`/api/warning-letters/${e}`,{method:"DELETE"});if(t.ok)o(t=>t.filter(t=>t.id!==e)),h(t=>t.filter(t=>t!==e));else{const e=await t.json();alert(e.error||"Error deleting record")}}catch(t){console.error("Error deleting warning letter:",t),alert("Error deleting record")}finally{y(!1)}}})(e.id),disabled:u,className:"text-red-600 hover:text-red-900 disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete warning letter",children:(0,l.jsx)(s.A,{className:"w-4 h-4"})})})]},e.id))})]})})]})]})}}}]);
//# sourceMappingURL=379.8be0c391.chunk.js.map