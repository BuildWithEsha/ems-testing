"use strict";(self.webpackChunkemployee_management_system=self.webpackChunkemployee_management_system||[]).push([[888],{2380:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(3797).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5104:(e,t,s)=>{s.d(t,{A:()=>l});s(5043);var a=s(579);const l=e=>{let{label:t,name:s,type:l="text",placeholder:r="",required:i=!1,disabled:n=!1,defaultValue:c="",className:o="",onChange:d,error:m,...h}=e;return(0,a.jsxs)("div",{className:o,children:[t&&(0,a.jsxs)("label",{htmlFor:s,className:"block text-sm font-medium text-gray-700 mb-1",children:[t,i&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,a.jsx)("input",{id:s,name:s,type:l,placeholder:r,required:i,disabled:n,onChange:d,className:`\n          w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm\n          focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\n          disabled:bg-gray-50 disabled:text-gray-500\n          ${m?"border-red-500 focus:ring-red-500 focus:border-red-500":""}\n        `,...h}),m&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:m})]})}},6787:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(3797).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},8192:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(3797).A)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]])},8888:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});var a=s(5043),l=s(1676),r=s(2938),i=s(917),n=s(8775),c=s(430),o=s(8192),d=s(6787),m=s(2380),h=s(9256),x=s(6339),p=s(2817),u=s(5016),y=s(4450),g=s(1425),f=s(5104),j=s(9749),v=s(579);const b=e=>{let{isOpen:t,onClose:s,notice:l,employees:r,departments:i,onSave:n}=e;const{user:c}=(0,u.A)(),[o,d]=(0,a.useState)({title:"",description:"",priority:"medium",status:"draft",selectedDepartments:[],recipients:[],attachments:[]}),[m,h]=(0,a.useState)(!1),[p,b]=(0,a.useState)({});(0,a.useEffect)(()=>{d(l?{title:l.title||"",description:l.description||"",priority:l.priority||"medium",status:l.status||"draft",selectedDepartments:l.selectedDepartments||[],recipients:l.recipients||[],attachments:l.attachments||[]}:{title:"",description:"",priority:"medium",status:"draft",selectedDepartments:[],recipients:[],attachments:[]})},[l,t]);const N=(r||[]).map(e=>({value:e.id,label:e.name,type:"employee"})),w=(i||[]).map(e=>({value:e.id,label:e.name,type:"department"}));return(0,v.jsx)(g.A,{isOpen:t,onClose:s,title:l?"Edit Notice":"Add New Notice",size:"lg",children:(0,v.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),h(!0),b({});try{const e=l?`http://localhost:5000/api/notices/${l.id}`:"http://localhost:5000/api/notices",t=l?"PUT":"POST",s=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify({...o,created_by:c.id})});if(s.ok)n();else{const e=await s.json();b(e.errors||{})}}catch(t){console.error("Error saving notice:",t),b({general:"An error occurred while saving the notice"})}finally{h(!1)}},className:"space-y-6",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notice Title *"}),(0,v.jsx)(f.A,{type:"text",value:o.title,onChange:e=>d(t=>({...t,title:e.target.value})),placeholder:"Enter notice title",required:!0}),p.title&&(0,v.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p.title})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,v.jsx)("textarea",{value:o.description,onChange:e=>d(t=>({...t,description:e.target.value})),placeholder:"Enter notice description",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0}),p.description&&(0,v.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p.description})]}),(0,v.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),(0,v.jsxs)("select",{value:o.priority,onChange:e=>d(t=>({...t,priority:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,v.jsx)("option",{value:"low",children:"Low"}),(0,v.jsx)("option",{value:"medium",children:"Medium"}),(0,v.jsx)("option",{value:"high",children:"High"})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,v.jsxs)("select",{value:o.status,onChange:e=>d(t=>({...t,status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,v.jsx)("option",{value:"draft",children:"Draft"}),(0,v.jsx)("option",{value:"published",children:"Published"}),(0,v.jsx)("option",{value:"archived",children:"Archived"})]})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Departments"}),(0,v.jsx)(j.A,{options:w,value:o.selectedDepartments,onChange:e=>{d(t=>{const s=e,a=r.filter(t=>e.includes(t.department_id)),l=[...a.map(e=>({value:e.id,label:e.name,type:"employee"})),...t.recipients.filter(e=>!a.some(t=>t.id===e.value))];return{...t,selectedDepartments:s,recipients:l}})},placeholder:"Select departments (all employees will be automatically added)"}),(0,v.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Selecting departments will automatically include all employees from those departments"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Individual Recipients"}),(0,v.jsx)(j.A,{options:N,value:o.recipients.filter(e=>"employee"===e.type),onChange:e=>{const t=r.filter(e=>o.selectedDepartments.includes(e.department_id)).map(e=>({value:e.id,label:e.name,type:"employee"}));d(s=>({...s,recipients:[...t,...e]}))},placeholder:"Select individual employees (optional)"}),(0,v.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"You can also select individual employees in addition to department selections"}),p.recipients&&(0,v.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p.recipients})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Attachments"}),(0,v.jsx)("input",{type:"file",multiple:!0,onChange:async e=>{const t=Array.from(e.target.files),s=new FormData;t.forEach(e=>{s.append("attachments",e)});try{const e=await fetch("http://localhost:5000/api/notices/upload",{method:"POST",body:s});if(e.ok){const t=await e.json();d(e=>({...e,attachments:[...e.attachments,...t.files]}))}}catch(a){console.error("Error uploading files:",a)}},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"}),o.attachments.length>0&&(0,v.jsx)("div",{className:"mt-2 space-y-1",children:o.attachments.map((e,t)=>(0,v.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded",children:[(0,v.jsx)("span",{className:"text-sm text-gray-700",children:e.name}),(0,v.jsx)("button",{type:"button",onClick:()=>d(e=>({...e,attachments:e.attachments.filter((e,s)=>s!==t)})),className:"text-red-500 hover:text-red-700",children:(0,v.jsx)(x.A,{className:"w-4 h-4"})})]},t))})]}),p.general&&(0,v.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,v.jsx)("p",{className:"text-red-600 text-sm",children:p.general})}),(0,v.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,v.jsx)(y.A,{type:"button",variant:"secondary",onClick:s,children:"Cancel"}),(0,v.jsx)(y.A,{type:"submit",disabled:m,children:m?"Saving...":l?"Update Notice":"Create Notice"})]})]})})},N=()=>{const{user:e}=(0,u.A)(),[t,s]=(0,a.useState)([]),[g,j]=(0,a.useState)(!0),[N,w]=(0,a.useState)(""),[A,k]=(0,a.useState)("all"),[C,S]=(0,a.useState)("all"),[D,E]=(0,a.useState)(!1),[_,P]=(0,a.useState)(null),[L,M]=(0,a.useState)([]),[O,T]=(0,a.useState)([]);(0,a.useEffect)(()=>{null!==e&&void 0!==e&&e.id&&($(),q(),z())},[null===e||void 0===e?void 0:e.id]);const $=async()=>{try{j(!0);const t=await fetch(`http://localhost:5000/api/notices?user_id=${e.id}&user_role=${e.role||e.user_role||"employee"}`);if(t.ok){const e=await t.json();s(e)}}catch(t){console.error("Error fetching notices:",t)}finally{j(!1)}},q=async()=>{try{const e=await fetch("http://localhost:5000/api/employees");if(e.ok){const t=await e.json();M(t.data||t)}}catch(e){console.error("Error fetching employees:",e)}},z=async()=>{try{const e=await fetch("http://localhost:5000/api/departments");if(e.ok){const t=await e.json();T(t)}}catch(e){console.error("Error fetching departments:",e)}},F=t.filter(e=>{const t=e.title.toLowerCase().includes(N.toLowerCase())||e.description.toLowerCase().includes(N.toLowerCase()),s="all"===A||e.status===A,a="all"===C||e.priority===C;return t&&s&&a}),H=e=>{switch(e){case"high":return"text-red-600 bg-red-50";case"medium":return"text-yellow-600 bg-yellow-50";case"low":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}},U=e=>{switch(e){case"published":return"text-green-600 bg-green-50";case"draft":return"text-yellow-600 bg-yellow-50";default:return"text-gray-600 bg-gray-50"}};return g?(0,v.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,v.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):(0,v.jsxs)("div",{className:"space-y-6",children:[(0,v.jsxs)("div",{className:"flex justify-between items-center",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Notice Board"}),(0,v.jsx)("p",{className:"text-gray-600",children:"Manage and view company notices"})]}),(0,v.jsxs)(y.A,{onClick:()=>E(!0),className:"flex items-center space-x-2",children:[(0,v.jsx)(m.A,{className:"w-4 h-4"}),(0,v.jsx)("span",{children:"Add Notice"})]})]}),(0,v.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:(0,v.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,v.jsx)("div",{className:"flex-1 min-w-64",children:(0,v.jsxs)("div",{className:"relative",children:[(0,v.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,v.jsx)(f.A,{type:"text",placeholder:"Search notices...",value:N,onChange:e=>w(e.target.value),className:"pl-10"})]})}),(0,v.jsxs)("select",{value:A,onChange:e=>k(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,v.jsx)("option",{value:"all",children:"All Status"}),(0,v.jsx)("option",{value:"published",children:"Published"}),(0,v.jsx)("option",{value:"draft",children:"Draft"}),(0,v.jsx)("option",{value:"archived",children:"Archived"})]}),(0,v.jsxs)("select",{value:C,onChange:e=>S(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,v.jsx)("option",{value:"all",children:"All Priority"}),(0,v.jsx)("option",{value:"high",children:"High"}),(0,v.jsx)("option",{value:"medium",children:"Medium"}),(0,v.jsx)("option",{value:"low",children:"Low"})]})]})}),(0,v.jsx)("div",{className:"space-y-4",children:0===F.length?(0,v.jsxs)("div",{className:"text-center py-12",children:[(0,v.jsx)(c.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,v.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No notices found"}),(0,v.jsx)("p",{className:"text-gray-500",children:"Create your first notice to get started."})]}):F.map(a=>{return(0,v.jsx)("div",{className:"bg-white rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:(0,v.jsx)("div",{className:"p-6",children:(0,v.jsxs)("div",{className:"flex items-start justify-between",children:[(0,v.jsxs)("div",{className:"flex-1",children:[(0,v.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,v.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:a.title}),(0,v.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${H(a.priority)}`,children:a.priority}),(0,v.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${U(a.status)}`,children:a.status})]}),(0,v.jsx)("p",{className:"text-gray-600 mb-4 line-clamp-3",children:a.description}),(0,v.jsxs)("div",{className:"flex items-center space-x-6 text-sm text-gray-500",children:[(0,v.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,v.jsx)(r.A,{className:"w-4 h-4"}),(0,v.jsx)("span",{children:(c=a.created_at,new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,v.jsx)(p.A,{className:"w-4 h-4"}),(0,v.jsxs)("span",{children:["By ",a.created_by_name]})]}),a.attachments&&a.attachments.length>0&&(0,v.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,v.jsx)(o.A,{className:"w-4 h-4"}),(0,v.jsxs)("span",{children:[a.attachments.length," attachment(s)"]})]})]}),(0,v.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:a.recipients&&a.recipients.map((e,t)=>(0,v.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-50 text-blue-700",children:"employee"===e.type?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(p.A,{className:"w-3 h-3 mr-1"}),e.name]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(l.A,{className:"w-3 h-3 mr-1"}),e.name]})},t))})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[!a.is_read&&(0,v.jsxs)(y.A,{variant:"secondary",size:"sm",onClick:()=>(async t=>{try{(await fetch(`http://localhost:5000/api/notices/${t}/mark-read`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.id})})).ok&&$()}catch(s){console.error("Error marking notice as read:",s)}})(a.id),className:"flex items-center space-x-1",children:[(0,v.jsx)(i.A,{className:"w-4 h-4"}),(0,v.jsx)("span",{children:"Mark Read"})]}),(0,v.jsx)(y.A,{variant:"secondary",size:"sm",onClick:()=>P(a),children:(0,v.jsx)(n.A,{className:"w-4 h-4"})}),"admin"===e.role&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(y.A,{variant:"secondary",size:"sm",onClick:()=>P(a),children:(0,v.jsx)(d.A,{className:"w-4 h-4"})}),(0,v.jsx)(y.A,{variant:"secondary",size:"sm",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this notice?"))try{(await fetch(`http://localhost:5000/api/notices/${e}`,{method:"DELETE"})).ok&&s(t.filter(t=>t.id!==e))}catch(a){console.error("Error deleting notice:",a)}})(a.id),className:"text-red-600 hover:text-red-700",children:(0,v.jsx)(x.A,{className:"w-4 h-4"})})]})]})]})})},a.id);var c})}),(0,v.jsx)(b,{isOpen:D||!!_,onClose:()=>{E(!1),P(null)},notice:_,employees:L,departments:O,onSave:()=>{$(),E(!1),P(null)}})]})}}}]);
//# sourceMappingURL=888.2c259e33.chunk.js.map