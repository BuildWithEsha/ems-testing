"use strict";(self.webpackChunkemployee_management_system=self.webpackChunkemployee_management_system||[]).push([[607],{5104:(e,t,a)=>{a.d(t,{A:()=>l});a(5043);var s=a(579);const l=e=>{let{label:t,name:a,type:l="text",placeholder:o="",required:r=!1,disabled:n=!1,defaultValue:i="",className:c="",onChange:d,error:m,...u}=e;return(0,s.jsxs)("div",{className:c,children:[t&&(0,s.jsxs)("label",{htmlFor:a,className:"block text-sm font-medium text-gray-700 mb-1",children:[t,r&&(0,s.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,s.jsx)("input",{id:a,name:a,type:l,placeholder:o,required:r,disabled:n,onChange:d,className:`\n          w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm\n          focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\n          disabled:bg-gray-50 disabled:text-gray-500\n          ${m?"border-red-500 focus:ring-red-500 focus:border-red-500":""}\n        `,...u}),m&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:m})]})}},7607:(e,t,a)=>{a.r(t),a.d(t,{default:()=>$});var s=a(5043),l=a(8112),o=a(2817),r=a(1676),n=a(7081),i=a(3458);const c=(0,a(3797).A)("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]);var d=a(8147),m=a(2380),u=a(9256),p=a(7219),x=a(1490),h=a(7008),g=a(8775),y=a(6787),f=a(4450),b=a(1425),j=a(5016);function v(e){const t=Number(e.time_estimate_minutes);if(!Number.isNaN(t)&&t>0)return t;const a=Number(e.time_estimate_hours);if(!Number.isNaN(a)&&a>0)return Math.round(60*a);if("number"===typeof e.time_estimate&&Number.isFinite(e.time_estimate)){const t=Math.round(e.time_estimate);if(t>0)return t}const s=e.time_estimate;if(null==s)return 0;if("number"===typeof s&&Number.isFinite(s))return Math.max(0,Math.round(s));if("string"===typeof s){const e=s.trim().toLowerCase(),t=Number(e);if(Number.isFinite(t))return Math.max(0,Math.round(t));let a=0;const l=e.match(/(\d+(?:\.\d+)?)\s*h/),o=e.match(/(\d+(?:\.\d+)?)\s*m/);return l&&(a+=Math.round(60*parseFloat(l[1]))),o&&(a+=Math.round(parseFloat(o[1]))),Math.max(0,a)}return 0}function N(e,t){return String(e.labels||"").toLowerCase().includes(String(t).toLowerCase())}function _(e){return String(e||"").trim().replace(/\s*\([^)]*\)\s*$/,"").toLowerCase()}function w(e,t){const a=_(t);return String(e.assigned_to||"").split(/[,|;]+/).map(e=>e.trim()).filter(Boolean).map(_).some(e=>e===a||e.startsWith(a))}function k(e){const t=new Date(e);return new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().slice(0,10)}function A(e,t){const a=new Date(e);return a.setDate(a.getDate()+t),a}function E(e){const t=new Date(e),a=t.getDay();return A(t,(0===a?-6:1)-a)}function C(e){if(!e)return"";return{mon:"monday",monday:"monday",tue:"tuesday",tues:"tuesday",tuesday:"tuesday",wed:"wednesday",wednesday:"wednesday",thu:"thursday",thur:"thursday",thurs:"thursday",thursday:"thursday",fri:"friday",friday:"friday",sat:"saturday",saturday:"saturday",sun:"sunday",sunday:"sunday"}[String(e).trim().toLowerCase()]||""}function S(e,t){const a=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][new Date(t).getDay()];const s=[e.weekly_day,e.week_day,e.weekday,e.repeat_day,e.repeat_on];for(const n of s){if(!n)continue;const e=C(n);if(e&&e===a)return!0}const l=String(e.title||e.task||"").toLowerCase();if(l){const e=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(const t of e)if(l.includes(t)&&t===a)return!0}return!(!e.due_date||(o=e.due_date,r=t,new Date(o).getDay()!==new Date(r).getDay()));var o,r}function D(e,t,a){const s=k(a);let l=0,o=0,r=0;for(const n of Array.isArray(e)?e:[]){if(!w(n,t))continue;const e=v(n);if(e<=0)continue;const a=N(n,"Daily")||N(n,"Daily Task"),i=N(n,"Weekly")||N(n,"Weekly Task"),c=N(n,"Monthly")||N(n,"Monthly Task");if(a&&(l+=e),i&&S(n,s)&&(o+=e),c){const t=n.due_date?k(n.due_date):"",a=new Date(s);let l=!1;if(t&&t===s)l=!0;else{const e=String(n.title||n.task||"").toLowerCase(),t=e.match(/\((\d{1,2})(?:st|nd|rd|th)?\s*(?:of)?\s*month\)/i)||e.match(/\bmonthly\s*\(?(\d{1,2})(?:st|nd|rd|th)?\)?/i);if(t){const e=Math.max(1,Math.min(31,parseInt(t[1],10)));a.getDate()===e&&(l=!0)}}l&&(r+=e)}}return{iso:s,totals:{daily:l,weekly:o,monthly:r},totalMinutes:l+o+r}}function O(e,t,a){const s=(null===t||void 0===t?void 0:t.name)||t,l=Number(null===t||void 0===t?void 0:t.working_hours)||8,o=a?new Date(a):new Date,r=D(e,s,o),n=E(o),i=function(e){return A(E(e),6)}(o),c=[];let d=new Date(n);for(;d<=i;)c.push(new Date(d)),d=A(d,1);const m=c.map(t=>D(e,s,t)),u=m.reduce((e,t)=>e+t.totalMinutes,0),p=function(e){const t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),1)}(o),x=function(e){const t=new Date(e);return new Date(t.getFullYear(),t.getMonth()+1,0)}(o),h=[];for(d=new Date(p);d<=x;)h.push(new Date(d)),d=A(d,1);const g=h.map(t=>D(e,s,t)),y=g.reduce((e,t)=>e+t.totalMinutes,0);return{shiftHours:l,day:{dateISO:r.iso,totalMinutes:r.totalMinutes,breakdown:r.totals,deltaMinutes:r.totalMinutes-60*l},week:{startISO:k(n),endISO:k(i),days:m,totalMinutes:u},month:{startISO:k(p),endISO:k(x),days:g,totalMinutes:y}}}function M(e){const t=Math.max(0,Math.round(Number(e)||0));return`${Math.floor(t/60)}h ${String(t%60).padStart(2,"0")}m`}var T=a(5104),P=a(9749),L=a(7679),R=a(1238),F=a(579);const I=(0,s.memo)(()=>{var e,t;const[a,j]=(0,s.useState)({employees:[],departments:[],designations:[],roles:[],stats:{total:0,managers:0,teamLeaders:0,operators:0,staff:0,admin:0,officeEmployees:0,remoteEmployees:0,fullTimeEmployees:0,partTimeEmployees:0,internEmployees:0}}),[v,N]=(0,s.useState)({loading:!0,searchTerm:"",selectedEmployee:null,showPassword:!1,showColumnModal:!1,showCategoryModal:!1,selectedCategory:null,categorySearchTerm:"",filteredCategoryEmployees:[],sortKey:null,sortDirection:"asc"}),[_,w]=(0,s.useState)({isOpen:!1,isImportOpen:!1,showDetail:!1,editingEmployee:null,selectedFile:null,importLoading:!1}),[k,A]=(0,s.useState)({formPhotoPreview:null,formPhotoFile:null}),[E,C]=(0,s.useState)({employee_id:!0,name:!0,email:!0,user_role:!0,department:!0,joining_date:!0,work_from:!0,status:!0,designation:!1,mobile:!1,gender:!1,date_of_birth:!1,reporting_to:!1,language:!1,hourly_rate:!1,employment_type:!1,marital_status:!1,job_title:!1,emergency_contact_number:!1,emergency_contact_relation:!1}),S=e=>{j(t=>({...t,...e}))},D=e=>{N(t=>({...t,...e}))},O=e=>{w(t=>({...t,...e}))},M=e=>{A(t=>({...t,...e}))},{employees:I,departments:$,designations:W,roles:B,stats:z}=a,{loading:H,searchTerm:J,selectedEmployee:V,showPassword:Y,showColumnModal:G,showCategoryModal:q,selectedCategory:K,categorySearchTerm:Q,filteredCategoryEmployees:X,sortKey:Z,sortDirection:ee}=v,{isOpen:te,isImportOpen:ae,showDetail:se,editingEmployee:le,selectedFile:oe,importLoading:re}=_,{formPhotoPreview:ne,formPhotoFile:ie}=k,[ce,de]=(0,s.useState)({employee_id:"",salutation:"",name:"",email:"",password:"",designation:"",department:"",work_from:"",country:"",mobile:"",gender:"",joining_date:"",date_of_birth:"",reporting_to:"",language:[],user_role:"",address:"",about:"",photo:"",login_allowed:!0,email_notifications:!0,hourly_rate:"",slack_member_id:"",skills:"",probation_end_date:"",notice_period_start_date:"",notice_period_end_date:"",employment_type:"",marital_status:"",business_address:"",status:"Active",working_hours:8,job_title:"",emergency_contact_number:"",emergency_contact_relation:""}),me=async()=>{try{const e=await fetch("/api/employees?limit=1000"),t=await e.json(),a=t.data||t,s=Array.isArray(a)?a:[];S({employees:s})}catch(e){console.error("Error fetching employees:",e),S({employees:[]})}finally{D({loading:!1})}},ue=async()=>{try{const e=await fetch("/api/employees/stats"),t=await e.json();S({stats:t||{}})}catch(e){console.error("Error fetching stats:",e),S({stats:{total:0,managers:0,teamLeaders:0,operators:0,staff:0,admin:0,officeEmployees:0,remoteEmployees:0,fullTimeEmployees:0,partTimeEmployees:0,internEmployees:0}})}};(0,s.useEffect)(()=>{me(),ue(),(async()=>{try{const[e,t,a]=await Promise.all([fetch("/api/departments"),fetch("/api/designations"),fetch("/api/roles")]);e.ok&&S({departments:await e.json()}),t.ok&&S({designations:await t.json()}),a.ok&&S({roles:await a.json()})}catch(e){}})()},[]);const pe=(e,t)=>{de(a=>({...a,[e]:t}))},xe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(D({showPassword:!1}),e){O({editingEmployee:e});const t={...e,login_allowed:Boolean(e.login_allowed),email_notifications:Boolean(e.email_notifications)};de({...t,language:e.language?String(e.language).split(",").map(e=>({value:e.trim(),label:e.trim()})):[]}),M({formPhotoPreview:e.photo||null})}else O({editingEmployee:null}),de({employee_id:"",salutation:"",name:"",email:"",password:"",designation:"",department:"",work_from:"",country:"",mobile:"",gender:"",joining_date:"",date_of_birth:"",reporting_to:"",language:[],user_role:"",address:"",about:"",photo:"",login_allowed:!0,email_notifications:!0,hourly_rate:"",slack_member_id:"",skills:"",probation_end_date:"",notice_period_start_date:"",notice_period_end_date:"",employment_type:"",marital_status:"",business_address:"",status:"Active",working_hours:8,job_title:"",emergency_contact_number:"",emergency_contact_relation:""}),M({formPhotoPreview:null});O({isOpen:!0})},he=()=>{O({isOpen:!1,editingEmployee:null}),M({formPhotoFile:null,formPhotoPreview:null}),D({showPassword:!1})},ge=e=>{D({selectedEmployee:e}),O({showDetail:!0})},ye=()=>{O({showDetail:!1}),D({selectedEmployee:null})},fe=()=>{D({showCategoryModal:!1,selectedCategory:null,filteredCategoryEmployees:[],categorySearchTerm:""})},be=()=>Q?X.filter(e=>{var t,a,s,l;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(Q.toLowerCase()))||(null===(a=e.email)||void 0===a?void 0:a.toLowerCase().includes(Q.toLowerCase()))||(null===(s=e.employee_id)||void 0===s?void 0:s.toLowerCase().includes(Q.toLowerCase()))||(null===(l=e.department)||void 0===l?void 0:l.toLowerCase().includes(Q.toLowerCase()))}):X,je=e=>({employee_id:"Employee ID",name:"Name",email:"Email",user_role:"User Role",department:"Department",joining_date:"Joining Date",work_from:"Work From",status:"Status",designation:"Designation",mobile:"Mobile",gender:"Gender",date_of_birth:"Date of Birth",reporting_to:"Reporting To",language:"Language",hourly_rate:"Hourly Rate",employment_type:"Employment Type",marital_status:"Marital Status",job_title:"Job Title",emergency_contact_number:"Emergency Contact",emergency_contact_relation:"Emergency Relation"}[e]||e),ve=(e,t)=>{switch(t){case"joining_date":case"date_of_birth":return e[t]?new Date(e[t]).toLocaleDateString():"N/A";case"hourly_rate":return e[t]?`$${e[t]}`:"N/A";case"status":return(0,F.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full "+("Active"===e.status?"bg-green-100 text-green-800":"Resigned"===e.status?"bg-yellow-100 text-yellow-800":"Terminated"===e.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:e.status||"Active"});default:return e[t]||"N/A"}},Ne=()=>{try{const e=Object.keys(E).filter(e=>E[e]),t=e.reduce((e,t)=>(e[t]=je(t),e),{}),a=(_e||[]).map(a=>{const s={};return e.forEach(e=>{s[t[e]]=((e,t)=>{switch(t){case"joining_date":case"date_of_birth":return e[t]?new Date(e[t]).toISOString().slice(0,10):"";case"hourly_rate":return null!=e[t]&&""!==e[t]?String(e[t]):"";case"status":return e.status||"Active";case"language":return Array.isArray(e.language)?e.language.join(", "):e.language||"";default:return null!=e[t]?String(e[t]):""}})(a,e)}),s}),s=R.Wp.json_to_sheet(a),l=R.Wp.book_new();R.Wp.book_append_sheet(l,s,"Employees"),R._h(l,"employees_export.xlsx")}catch(e){console.error("Error exporting employees:",e),alert("Export failed. Please try again.")}},_e=(I||[]).filter(e=>{var t,a,s;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(J.toLowerCase()))||(null===(a=e.email)||void 0===a?void 0:a.toLowerCase().includes(J.toLowerCase()))||(null===(s=e.employee_id)||void 0===s?void 0:s.toLowerCase().includes(J.toLowerCase()))}),we=(e,t)=>{var a;if(!e)return"";switch(t){case"joining_date":case"date_of_birth":return e[t]&&Date.parse(e[t])||0;case"hourly_rate":case"working_hours":return null!=e[t]&&""!==e[t]?Number(e[t]):-1/0;case"language":return Array.isArray(e.language)?e.language.join(", ").toLowerCase():String(e.language||"").toLowerCase();case"status":case"employment_type":case"user_role":case"department":case"designation":case"work_from":case"marital_status":case"job_title":case"reporting_to":case"name":case"email":case"employee_id":return String(e[t]||"").toLowerCase();default:return String(null!==(a=e[t])&&void 0!==a?a:"").toLowerCase()}},ke=s.useMemo(()=>{if(!Z)return _e;const e=[..._e],t="asc"===ee?1:-1;return e.sort((e,a)=>{const s=we(e,Z),l=we(a,Z);return s>l?1*t:s<l?-1*t:0}),e},[_e,Z,ee]),Ae=[{title:"Total Employees",value:z.total,icon:l.A,color:"bg-blue-500",key:"total"},{title:"Managers",value:z.managers,icon:o.A,color:"bg-purple-500",key:"managers"},{title:"Team Leaders",value:z.teamLeaders,icon:o.A,color:"bg-indigo-500",key:"teamLeaders"},{title:"Operators",value:z.operators,icon:o.A,color:"bg-cyan-500",key:"operators"},{title:"Staff",value:z.staff,icon:o.A,color:"bg-emerald-500",key:"staff"},{title:"Admin",value:z.admin,icon:o.A,color:"bg-red-500",key:"admin"},{title:"Office Employees",value:z.officeEmployees,icon:r.A,color:"bg-green-500",key:"officeEmployees"},{title:"Remote Employees",value:z.remoteEmployees,icon:n.A,color:"bg-orange-500",key:"remoteEmployees"},{title:"Full Time",value:z.fullTimeEmployees,icon:i.A,color:"bg-teal-500",key:"fullTimeEmployees"},{title:"Part Time",value:z.partTimeEmployees,icon:i.A,color:"bg-yellow-500",key:"partTimeEmployees"},{title:"Interns",value:z.internEmployees,icon:c,color:"bg-pink-500",key:"internEmployees"}];return(0,F.jsxs)("div",{className:"space-y-6",children:[(0,F.jsxs)("div",{className:"flex items-center justify-between",children:[(0,F.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Employees"}),(0,F.jsxs)("div",{className:"flex space-x-3",children:[(0,F.jsxs)(f.A,{variant:"secondary",onClick:()=>O({isImportOpen:!0}),className:"flex items-center space-x-2",children:[(0,F.jsx)(d.A,{className:"w-4 h-4"}),(0,F.jsx)("span",{children:"Import"})]}),(0,F.jsxs)(f.A,{onClick:()=>xe(),className:"flex items-center space-x-2",children:[(0,F.jsx)(m.A,{className:"w-4 h-4"}),(0,F.jsx)("span",{children:"Add Employee"})]})]})]}),(0,F.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-11 gap-6",children:Ae.map((e,t)=>{const a=e.icon;return(0,F.jsx)("div",{className:"bg-white rounded-lg shadow p-6 cursor-pointer hover:shadow-lg transition-shadow duration-200 hover:scale-105 transform",onClick:()=>(e=>{D({selectedCategory:e,categorySearchTerm:""});let t=[];switch(e.key){case"managers":t=(I||[]).filter(e=>"Manager"===e.designation);break;case"teamLeaders":t=(I||[]).filter(e=>"Team Leader"===e.designation);break;case"operators":t=(I||[]).filter(e=>"Operator"===e.designation);break;case"staff":t=(I||[]).filter(e=>"Staff"===e.designation);break;case"admin":t=(I||[]).filter(e=>"Admin"===e.designation);break;case"officeEmployees":t=(I||[]).filter(e=>"Office"===e.work_from);break;case"remoteEmployees":t=(I||[]).filter(e=>"Remote"===e.work_from);break;case"fullTimeEmployees":t=(I||[]).filter(e=>"Full-time"===e.employment_type);break;case"partTimeEmployees":t=(I||[]).filter(e=>"Part-time"===e.employment_type);break;case"internEmployees":t=(I||[]).filter(e=>"Intern"===e.employment_type);break;default:t=I||[]}D({filteredCategoryEmployees:t,showCategoryModal:!0})})(e),children:(0,F.jsxs)("div",{className:"flex items-center justify-between",children:[(0,F.jsxs)("div",{children:[(0,F.jsx)("p",{className:"text-sm font-medium text-gray-600",children:e.title}),(0,F.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:e.value})]}),(0,F.jsx)("div",{className:`p-3 rounded-lg ${e.color}`,children:(0,F.jsx)(a,{className:"w-6 h-6 text-white"})})]})},t)})}),(0,F.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,F.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,F.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,F.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,F.jsx)("input",{type:"text",placeholder:"Search employees...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 w-full",value:J,onChange:e=>D({searchTerm:e.target.value})})]}),(0,F.jsxs)("div",{className:"flex space-x-2",children:[(0,F.jsxs)(f.A,{variant:"outline",className:"flex items-center space-x-2",onClick:()=>D({showColumnModal:!0}),children:[(0,F.jsx)(p.A,{className:"w-4 h-4"}),(0,F.jsx)("span",{children:"Customize Columns"})]}),(0,F.jsxs)(f.A,{variant:"outline",className:"flex items-center space-x-2",onClick:Ne,children:[(0,F.jsx)(x.A,{className:"w-4 h-4"}),(0,F.jsx)("span",{children:"Filter"})]}),(0,F.jsxs)(f.A,{variant:"outline",className:"flex items-center space-x-2",onClick:Ne,children:[(0,F.jsx)(h.A,{className:"w-4 h-4"}),(0,F.jsx)("span",{children:"Export"})]})]})]}),(0,F.jsx)("div",{className:"overflow-x-auto",children:(0,F.jsxs)("table",{className:"w-full text-sm text-left text-gray-500",children:[(0,F.jsx)("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:(0,F.jsxs)("tr",{children:[Object.keys(E).map(e=>E[e]&&(0,F.jsx)("th",{className:"px-6 py-3",children:(0,F.jsxs)("button",{type:"button",onClick:()=>(e=>{N(t=>{const a=t.sortKey===e&&"asc"===t.sortDirection?"desc":"asc";return{...t,sortKey:e,sortDirection:a}})})(e),className:"flex items-center space-x-2 group select-none cursor-pointer text-gray-700 hover:text-gray-900",title:`Sort by ${je(e)}`,children:[(0,F.jsx)("span",{children:je(e)}),(0,F.jsx)("span",{className:"text-xs opacity-60 group-hover:opacity-100",children:Z===e?"asc"===ee?"\u25b2":"\u25bc":""})]})},e)),(0,F.jsx)("th",{className:"px-6 py-3",children:"Action"})]})}),(0,F.jsx)("tbody",{children:H?(0,F.jsx)("tr",{children:(0,F.jsx)("td",{colSpan:Object.values(E).filter(Boolean).length+1,className:"px-6 py-4 text-center",children:"Loading..."})}):0===_e.length?(0,F.jsx)("tr",{children:(0,F.jsx)("td",{colSpan:Object.values(E).filter(Boolean).length+1,className:"px-6 py-4 text-center text-gray-500",children:"No employees found"})}):ke.map(e=>(0,F.jsxs)("tr",{className:"bg-white border-b hover:bg-gray-50",children:[Object.keys(E).map(t=>{var a;return E[t]&&(0,F.jsx)("td",{className:"px-6 py-4",children:"name"===t?(0,F.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,F.jsx)("div",{className:"w-8 h-8 rounded-full overflow-hidden flex items-center justify-center",children:e.photo?(0,F.jsx)("img",{src:e.photo,alt:e.name,className:"w-full h-full object-cover"}):(0,F.jsx)("div",{className:"w-full h-full bg-indigo-600 flex items-center justify-center",children:(0,F.jsx)("span",{className:"text-white text-sm font-medium",children:(null===(a=e.name)||void 0===a?void 0:a.charAt(0))||"U"})})}),(0,F.jsx)("button",{onClick:()=>ge(e),className:"font-medium text-gray-900 hover:text-blue-600 cursor-pointer",children:e.name})]}):ve(e,t)},t)}),(0,F.jsx)("td",{className:"px-6 py-4",children:(0,F.jsx)(L.A,{onSelect:()=>{D({selectedEmployee:e}),O({showDetail:!0})},onEdit:()=>xe(e),onDelete:()=>(async e=>{if(confirm("Are you sure you want to delete this employee?"))try{(await fetch(`/api/employees/${e}`,{method:"DELETE"})).ok?(me(),ue()):alert("Error deleting employee")}catch(t){console.error("Error deleting employee:",t),alert("Error deleting employee")}})(e.id),itemType:"employee"})})]},e.id))})]})})]}),(0,F.jsx)(b.A,{isOpen:te,onClose:he,title:(le?"Edit":"Add")+" Employee",size:"xl",children:(0,F.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=le?`/api/employees/${le.id}`:"/api/employees",a=le?"PUT":"POST",s={...ce,language:Array.isArray(ce.language)?ce.language.map(e=>e.label||e.value).join(", "):ce.language};if(!s.hourly_rate||""===String(s.hourly_rate).trim())return void alert("Hourly rate is required");if("Part-time"===s.employment_type||"Intern"===s.employment_type){if(!s.working_hours||Number(s.working_hours)<=0)return void alert("Please enter working hours for selected employment type")}else s.working_hours=8;const l=await fetch(e,{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(l.ok)he(),me(),ue();else{let e="Error saving employee";try{const t=await l.text();try{const a=JSON.parse(t);null!==a&&void 0!==a&&a.error&&(e=a.error)}catch{t&&(e=t)}}catch(t){}alert(e)}}catch(a){console.error("Error saving employee:",a),alert("Error saving employee")}},className:"space-y-6",children:[(0,F.jsx)("div",{className:"col-span-full mb-6",children:(0,F.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,F.jsx)("div",{className:"flex-shrink-0",children:(0,F.jsx)("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-100 border-2 border-gray-300 flex items-center justify-center",children:ne?(0,F.jsx)("img",{src:ne,alt:"Employee photo",className:"w-full h-full object-cover"}):(0,F.jsx)("div",{className:"text-gray-400",children:(0,F.jsx)("svg",{className:"w-12 h-12",fill:"currentColor",viewBox:"0 0 20 20",children:(0,F.jsx)("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})})})}),(0,F.jsxs)("div",{className:"flex-1",children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee Photo"}),(0,F.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,F.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t){M({formPhotoFile:t});const e=new FileReader;e.onload=e=>{M({formPhotoPreview:e.target.result}),de(t=>({...t,photo:e.target.result}))},e.readAsDataURL(t)}},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"}),ne&&(0,F.jsx)("button",{type:"button",onClick:()=>{M({formPhotoFile:null,formPhotoPreview:null}),de(e=>({...e,photo:""}))},className:"px-3 py-2 text-sm text-red-600 hover:text-red-800",children:"Remove"})]}),(0,F.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Upload a profile photo (JPG, PNG, GIF up to 5MB)"})]})]})}),(0,F.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,F.jsx)(T.A,{label:"Employee ID",name:"employee_id",value:ce.employee_id,onChange:e=>pe("employee_id",e.target.value),placeholder:"e.g. Employee ID"}),(0,F.jsx)(T.A,{label:"Salutation",name:"salutation",value:ce.salutation,onChange:e=>pe("salutation",e.target.value),placeholder:"Select..."}),(0,F.jsx)(T.A,{label:"Employee Name",name:"name",value:ce.name,onChange:e=>pe("name",e.target.value),placeholder:"e.g. Employee Name",required:!0}),(0,F.jsx)(T.A,{label:"Employee Email",name:"email",type:"email",value:ce.email,onChange:e=>pe("email",e.target.value),placeholder:"e.g. Employee Email",required:!0}),(0,F.jsxs)("div",{className:"space-y-2",children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,F.jsxs)("div",{className:"relative",children:[(0,F.jsx)("input",{type:Y?"text":"password",name:"password",value:ce.password,onChange:e=>pe("password",e.target.value),placeholder:"Min. 8 characters",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),(0,F.jsx)("button",{type:"button",onClick:()=>D({showPassword:!Y}),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:(0,F.jsx)(g.A,{className:"w-4 h-4"})})]})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Designation"}),(0,F.jsxs)("select",{value:ce.designation,onChange:e=>pe("designation",e.target.value),className:"w-full border rounded px-3 py-2",children:[(0,F.jsx)("option",{value:"",children:"Select..."}),W.map(e=>(0,F.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),(0,F.jsxs)("select",{value:ce.department,onChange:e=>pe("department",e.target.value),className:"w-full border rounded px-3 py-2",children:[(0,F.jsx)("option",{value:"",children:"Select..."}),$.map(e=>(0,F.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Work From"}),(0,F.jsxs)("select",{value:ce.work_from,onChange:e=>pe("work_from",e.target.value),className:"w-full border rounded px-3 py-2",children:[(0,F.jsx)("option",{value:"",children:"Select..."}),(0,F.jsx)("option",{children:"Remote"}),(0,F.jsx)("option",{children:"Office"}),(0,F.jsx)("option",{children:"Hybrid"})]})]}),(0,F.jsx)(T.A,{label:"Country",name:"country",value:ce.country,onChange:e=>pe("country",e.target.value),placeholder:"e.g. Country"}),(0,F.jsx)(T.A,{label:"Mobile",name:"mobile",value:ce.mobile,onChange:e=>pe("mobile",e.target.value),placeholder:"e.g. Mobile"}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),(0,F.jsxs)("select",{value:ce.gender,onChange:e=>pe("gender",e.target.value),className:"w-full border rounded px-3 py-2",children:[(0,F.jsx)("option",{value:"",children:"Select..."}),(0,F.jsx)("option",{children:"Male"}),(0,F.jsx)("option",{children:"Female"})]})]}),(0,F.jsx)(T.A,{label:"Joining Date",name:"joining_date",type:"date",value:ce.joining_date,onChange:e=>pe("joining_date",e.target.value)}),(0,F.jsx)(T.A,{label:"Date of Birth",name:"date_of_birth",type:"date",value:ce.date_of_birth,onChange:e=>pe("date_of_birth",e.target.value)}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reporting To"}),(0,F.jsxs)("select",{value:ce.reporting_to,onChange:e=>pe("reporting_to",e.target.value),className:"w-full border rounded px-3 py-2",children:[(0,F.jsx)("option",{value:"",children:"Select..."}),(I||[]).map(e=>(0,F.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Languages"}),(0,F.jsx)(P.A,{options:["English","Urdu","Punjabi","Sindhi","Pashto","Balochi","Arabic"].map(e=>({value:e,label:e})),value:ce.language,onChange:e=>pe("language",e),placeholder:"Select languages"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Role"}),(0,F.jsxs)("select",{value:ce.user_role,onChange:e=>pe("user_role",e.target.value),className:"w-full border rounded px-3 py-2",children:[(0,F.jsx)("option",{value:"",children:"Select..."}),B.map(e=>(0,F.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]}),(0,F.jsxs)("div",{className:"space-y-4",children:[(0,F.jsx)(T.A,{label:"Address",name:"address",value:ce.address,onChange:e=>pe("address",e.target.value),placeholder:"e.g. Address",className:"md:col-span-2"}),(0,F.jsx)(T.A,{label:"About",name:"about",value:ce.about,onChange:e=>pe("about",e.target.value),placeholder:"e.g. About",className:"md:col-span-2"})]}),(0,F.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,F.jsxs)("div",{className:"space-y-2",children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Login Allowed?"}),(0,F.jsxs)("div",{className:"flex space-x-4",children:[(0,F.jsxs)("label",{className:"flex items-center",children:[(0,F.jsx)("input",{type:"radio",name:"login_allowed",value:"true",checked:!0===ce.login_allowed,onChange:e=>pe("login_allowed","true"===e.target.value),className:"mr-2"}),"Yes"]}),(0,F.jsxs)("label",{className:"flex items-center",children:[(0,F.jsx)("input",{type:"radio",name:"login_allowed",value:"false",checked:!1===ce.login_allowed,onChange:e=>pe("login_allowed","true"===e.target.value),className:"mr-2"}),"No"]})]})]}),(0,F.jsxs)("div",{className:"space-y-2",children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Receive email notifications?"}),(0,F.jsxs)("div",{className:"flex space-x-4",children:[(0,F.jsxs)("label",{className:"flex items-center",children:[(0,F.jsx)("input",{type:"radio",name:"email_notifications",value:"true",checked:!0===ce.email_notifications,onChange:e=>pe("email_notifications","true"===e.target.value),className:"mr-2"}),"Yes"]}),(0,F.jsxs)("label",{className:"flex items-center",children:[(0,F.jsx)("input",{type:"radio",name:"email_notifications",value:"false",checked:!1===ce.email_notifications,onChange:e=>pe("email_notifications","true"===e.target.value),className:"mr-2"}),"No"]})]})]}),(0,F.jsx)(T.A,{label:"Hourly Rate*",name:"hourly_rate",value:ce.hourly_rate,onChange:e=>pe("hourly_rate",e.target.value),placeholder:"e.g. 50",required:!0}),(0,F.jsx)(T.A,{label:"Slack Member ID",name:"slack_member_id",value:ce.slack_member_id,onChange:e=>pe("slack_member_id",e.target.value),placeholder:"e.g. Slack Member ID"}),(0,F.jsx)(T.A,{label:"Skills",name:"skills",value:ce.skills,onChange:e=>pe("skills",e.target.value),placeholder:"e.g. Skills"}),(0,F.jsx)(T.A,{label:"Probation End Date",name:"probation_end_date",type:"date",value:ce.probation_end_date,onChange:e=>pe("probation_end_date",e.target.value)}),(0,F.jsx)(T.A,{label:"Notice Period Start Date",name:"notice_period_start_date",type:"date",value:ce.notice_period_start_date,onChange:e=>pe("notice_period_start_date",e.target.value)}),(0,F.jsx)(T.A,{label:"Notice Period End Date",name:"notice_period_end_date",type:"date",value:ce.notice_period_end_date,onChange:e=>pe("notice_period_end_date",e.target.value)}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employment Type"}),(0,F.jsxs)("select",{value:ce.employment_type,onChange:e=>pe("employment_type",e.target.value),className:"w-full border rounded px-3 py-2",children:[(0,F.jsx)("option",{value:"",children:"Select..."}),(0,F.jsx)("option",{children:"Full-time"}),(0,F.jsx)("option",{children:"Part-time"}),(0,F.jsx)("option",{children:"Intern"})]})]}),("Part-time"===ce.employment_type||"Intern"===ce.employment_type)&&(0,F.jsx)(T.A,{label:"Working Hours",name:"working_hours",value:ce.working_hours,onChange:e=>pe("working_hours",e.target.value),placeholder:"e.g. 4"}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Marital Status"}),(0,F.jsxs)("select",{value:ce.marital_status,onChange:e=>pe("marital_status",e.target.value),className:"w-full border rounded px-3 py-2",children:[(0,F.jsx)("option",{value:"",children:"Select..."}),(0,F.jsx)("option",{children:"Single"}),(0,F.jsx)("option",{children:"Married"})]})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,F.jsxs)("select",{value:ce.status,onChange:e=>pe("status",e.target.value),className:"w-full border rounded px-3 py-2",children:[(0,F.jsx)("option",{children:"Active"}),(0,F.jsx)("option",{children:"Resigned"}),(0,F.jsx)("option",{children:"Terminated"}),(0,F.jsx)("option",{children:"Inactive"})]})]}),(0,F.jsx)(T.A,{label:"Job Title",name:"job_title",value:ce.job_title,onChange:e=>pe("job_title",e.target.value),placeholder:"e.g. Software Engineer"}),(0,F.jsx)(T.A,{label:"Emergency Contact Number",name:"emergency_contact_number",value:ce.emergency_contact_number,onChange:e=>pe("emergency_contact_number",e.target.value),placeholder:"e.g. 03001234567"}),(0,F.jsx)(T.A,{label:"Emergency Contact Relation",name:"emergency_contact_relation",value:ce.emergency_contact_relation,onChange:e=>pe("emergency_contact_relation",e.target.value),placeholder:"e.g. Brother"})]}),(0,F.jsx)(T.A,{label:"Business Address",name:"business_address",value:ce.business_address,onChange:e=>pe("business_address",e.target.value),placeholder:"e.g. Business Address",className:"md:col-span-2"}),(0,F.jsxs)("div",{className:"flex justify-end space-x-3 pt-6",children:[(0,F.jsx)(f.A,{variant:"secondary",onClick:he,children:"Cancel"}),(0,F.jsxs)(f.A,{type:"submit",children:[le?"Update":"Create"," Employee"]})]})]})}),(0,F.jsx)(b.A,{isOpen:ae,onClose:()=>O({isImportOpen:!1}),title:"Import Employees",size:"md",children:(0,F.jsxs)("div",{className:"space-y-4",children:[(0,F.jsx)("div",{className:"flex justify-end",children:(0,F.jsx)(f.A,{variant:"outline",onClick:async()=>{try{const[t,a,s,l]=await Promise.all([fetch("/api/designations"),fetch("/api/departments"),fetch("/api/roles"),fetch("/api/employees")]),o=t.ok?await t.json():[],r=a.ok?await a.json():[],n=s.ok?await s.json():[],i=l.ok?await l.json():[],c=o.map(e=>e.name),d=r.map(e=>e.name),m=n.map(e=>e.name),u=(i||[]).map(e=>e.name),p=[["Name*","Email*","Employee ID","Salutation","Password","Designation","Department","Work From","Country","Mobile","Gender","Joining Date","Date of Birth","Reporting To","Language","User Role","Address","About","Login Allowed","Email Notifications","Hourly Rate*","Slack Member ID","Skills","Probation End Date","Notice Period Start Date","Notice Period End Date","Employment Type","Marital Status","Business Address","Status","Working Hours","Job Title","Emergency Contact Number","Emergency Contact Relation"],["John Doe","john.doe@company.com","EMP001","Mr.","password123","Software Engineer","IT","Remote","USA","1234567890","Male","2023-01-01","1990-01-01","Jane Smith","English","Employee","123 Main St","About John","TRUE","TRUE","50.00","SLACK123","JavaScript,React","2023-06-01","2023-07-01","2023-08-01","Full-time","Single","456 Business Rd","Active","8","Software Engineer","03001234567","Brother"],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]];p.push(["OPTIONS:","","","","",`Available: ${c.join(" | ")}`,`Available: ${d.join(" | ")}`,"Remote | Office | Hybrid","","","Male | Female","","",`Available: ${u.join(" | ")}`,"English | Urdu | Punjabi | Sindhi | Pashto | Balochi | Arabic",`Available: ${m.join(" | ")}`,"","","TRUE | FALSE","TRUE | FALSE","","","","","","","Full-time | Part-time | Intern","Single | Married","","Active | Resigned | Terminated | Inactive","","","",""]);const x=R.Wp.aoa_to_sheet(p),h=[["Designation_Options"],...c.map(e=>[e]),[""],["Department_Options"],...d.map(e=>[e]),[""],["WorkFrom_Options"],["Remote"],["Office"],["Hybrid"],[""],["Gender_Options"],["Male"],["Female"],[""],["ReportingTo_Options"],...u.map(e=>[e]),[""],["Language_Options"],["English"],["Urdu"],["Punjabi"],["Sindhi"],["Pashto"],["Balochi"],["Arabic"],[""],["UserRole_Options"],...m.map(e=>[e]),[""],["Boolean_Options"],["TRUE"],["FALSE"],[""],["EmploymentType_Options"],["Full-time"],["Part-time"],["Intern"],[""],["MaritalStatus_Options"],["Single"],["Married"],[""],["Status_Options"],["Active"],["Resigned"],["Terminated"],["Inactive"]],g=R.Wp.aoa_to_sheet(h),y=R.Wp.book_new();y.Workbook||(y.Workbook={}),y.Workbook.Names||(y.Workbook.Names=[]);const f=(e,t,a,s,l)=>{y.Workbook.Names.push({Name:e,Ref:`${t}!$${String.fromCharCode(65+l)}$${a}:$${String.fromCharCode(65+l)}$${s}`})};let b=1;const j=b+1,v=b+c.length;f("Designation_Options","Dropdown Options",j,v,0),b=v+2;const N=b+1,_=b+d.length;f("Department_Options","Dropdown Options",N,_,0),b=_+2;const w=b+3;f("WorkFrom_Options","Dropdown Options",b+1,w,0),b=w+2;const k=b+2;f("Gender_Options","Dropdown Options",b+1,k,0),b=k+2;const A=b+1,E=b+u.length;f("ReportingTo_Options","Dropdown Options",A,E,0),b=E+2;const C=b+7;f("Language_Options","Dropdown Options",b+1,C,0),b=C+2;const S=b+1,D=b+m.length;f("UserRole_Options","Dropdown Options",S,D,0),b=D+2;const O=b+2;f("Boolean_Options","Dropdown Options",b+1,O,0),b=O+2;const M=b+3;f("EmploymentType_Options","Dropdown Options",b+1,M,0),b=M+2;const T=b+2;f("MaritalStatus_Options","Dropdown Options",b+1,T,0),b=T+2;f("Status_Options","Dropdown Options",b+1,b+4,0);try{x["!dataValidations"]||(x["!dataValidations"]=[]);[{col:5,options:c,name:"Designation"},{col:6,options:d,name:"Department"},{col:7,options:["Remote","Office","Hybrid"],name:"Work From"},{col:10,options:["Male","Female"],name:"Gender"},{col:13,options:u,name:"Reporting To"},{col:14,options:["English","Urdu","Punjabi","Sindhi","Pashto","Balochi","Arabic"],name:"Language"},{col:15,options:m,name:"User Role"},{col:18,options:["TRUE","FALSE"],name:"Login Allowed"},{col:19,options:["TRUE","FALSE"],name:"Email Notifications"},{col:26,options:["Full-time","Part-time","Intern"],name:"Employment Type"},{col:27,options:["Single","Married"],name:"Marital Status"},{col:29,options:["Active","Resigned","Terminated","Inactive"],name:"Status"}].forEach(e=>{if(e.options&&e.options.length>0){const t=String.fromCharCode(65+e.col),a=`${t}3:${t}1000`;x["!dataValidations"].push({sqref:a,type:"list",formula1:`"${e.options.join(",")}"`,allowBlank:!0,showErrorMessage:!0,errorTitle:"Invalid Value",error:`Please select a valid ${e.name}.`,showInputMessage:!0,promptTitle:`Select ${e.name}`,prompt:"Please select a value from the dropdown list."})}})}catch(e){console.warn("Data validation could not be added:",e)}p.push(["INSTRUCTIONS:","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]),p.push(["1. Required fields are marked with * (Name, Email, Hourly Rate)","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]),p.push(["2. To add dropdowns manually in Excel:","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]),p.push(["   a) Select column (e.g., F for Designation)","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]),p.push(["   b) Go to Data > Data Validation","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]),p.push(["   c) Set Allow: List, Source: use values from OPTIONS row","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]),p.push(['3. For languages, separate multiple values with commas (e.g., "English, Urdu")',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]),p.push(["4. Dates should be in YYYY-MM-DD format (e.g., 2023-01-01)","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]),p.push(["5. For Part-time or Intern employment, Working Hours field is required","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]),p.push(['6. See "Dropdown Options" sheet for all available values',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]),p.push(["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]),R.Wp.book_append_sheet(y,x,"Employees"),R.Wp.book_append_sheet(y,g,"Dropdown Options"),R._h(y,"employee_template.xlsx")}catch(e){console.error("Error generating sample file:",e),alert("Error generating sample file. Please try again.")}},children:"Download Sample File"})}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Excel File"}),(0,F.jsx)("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{const t=e.target.files[0];setSelectedFile(t)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),(0,F.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,F.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"File Format Requirements:"}),(0,F.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,F.jsx)("li",{children:"\u2022 File should be in Excel format (.xlsx or .xls)"}),(0,F.jsx)("li",{children:"\u2022 First row should contain column headers"}),(0,F.jsx)("li",{children:"\u2022 Required columns: Name*, Email*, Hourly Rate*"}),(0,F.jsx)("li",{children:"\u2022 All columns are included in the sample file with current dropdown options"}),(0,F.jsx)("li",{children:"\u2022 Dropdown values are automatically updated when you download the sample file"}),(0,F.jsx)("li",{children:"\u2022 Use exact values from the OPTIONS row for dropdown fields"}),(0,F.jsx)("li",{children:"\u2022 For languages, separate multiple values with commas"}),(0,F.jsx)("li",{children:"\u2022 Dates should be in YYYY-MM-DD format"})]})]}),(0,F.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,F.jsx)(f.A,{variant:"secondary",onClick:()=>O({isImportOpen:!1}),children:"Cancel"}),(0,F.jsx)(f.A,{onClick:async()=>{if(!oe)return void alert("Please select a file");setImportLoading(!0);const e=new FormData;e.append("file",oe);try{const t=await fetch("/api/employees/import",{method:"POST",body:e}),a=await t.json();t.ok?(alert(a.message),O({isImportOpen:!1}),setSelectedFile(null),me(),ue()):alert(a.error||"Error importing employees")}catch(t){console.error("Error importing employees:",t),alert("Error importing employees")}finally{setImportLoading(!1)}},disabled:!oe||re,children:re?"Importing...":"Import"})]})]})}),(0,F.jsx)(b.A,{isOpen:se,onClose:ye,title:"Employee Details",size:"xl",children:V&&(0,F.jsxs)("div",{className:"space-y-6",children:[(0,F.jsxs)("div",{className:"flex items-center space-x-4 pb-4 border-b border-gray-200",children:[(0,F.jsx)("div",{className:"w-16 h-16 rounded-full overflow-hidden flex items-center justify-center",children:V.photo?(0,F.jsx)("img",{src:V.photo,alt:V.name,className:"w-full h-full object-cover"}):(0,F.jsx)("div",{className:"w-full h-full bg-indigo-600 flex items-center justify-center",children:(0,F.jsx)("span",{className:"text-white text-xl font-medium",children:(null===(e=V.name)||void 0===e?void 0:e.charAt(0))||"U"})})}),(0,F.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,F.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:V.name}),(0,F.jsx)("p",{className:"text-gray-600",children:V.designation}),(0,F.jsx)("p",{className:"text-sm text-gray-500",children:V.department})]}),(0,F.jsx)("div",{className:"ml-auto",children:(0,F.jsx)(U,{employee:V})})]}),(0,F.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,F.jsxs)("div",{className:"space-y-4",children:[(0,F.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Basic Information"}),(0,F.jsxs)("div",{className:"space-y-3",children:[(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Employee ID"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.employee_id||"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.email})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Mobile"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.mobile||"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Gender"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.gender||"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Country"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.country||"N/A"})]})]})]}),(0,F.jsxs)("div",{className:"space-y-4",children:[(0,F.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Employment Details"}),(0,F.jsxs)("div",{className:"space-y-3",children:[(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"User Role"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.user_role||"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Work From"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.work_from||"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Joining Date"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.joining_date?new Date(V.joining_date).toLocaleDateString():"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Date of Birth"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.date_of_birth?new Date(V.date_of_birth).toLocaleDateString():"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Employment Type"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.employment_type||"N/A"})]})]})]}),(0,F.jsxs)("div",{className:"space-y-4",children:[(0,F.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Additional Information"}),(0,F.jsxs)("div",{className:"space-y-3",children:[(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Reporting To"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.reporting_to||"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Language"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.language||"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Hourly Rate"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.hourly_rate?`$${V.hourly_rate}`:"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Slack Member ID"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.slack_member_id||"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Marital Status"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.marital_status||"N/A"})]})]})]}),(0,F.jsxs)("div",{className:"space-y-4",children:[(0,F.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Skills & Dates"}),(0,F.jsxs)("div",{className:"space-y-3",children:[(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Skills"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.skills||"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Probation End Date"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.probation_end_date?new Date(V.probation_end_date).toLocaleDateString():"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Notice Period Start"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.notice_period_start_date?new Date(V.notice_period_start_date).toLocaleDateString():"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Notice Period End"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.notice_period_end_date?new Date(V.notice_period_end_date).toLocaleDateString():"N/A"})]})]})]})]}),(0,F.jsxs)("div",{className:"space-y-4",children:[(0,F.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Addresses"}),(0,F.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Personal Address"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.address||"N/A"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Business Address"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.business_address||"N/A"})]})]})]}),V.about&&(0,F.jsxs)("div",{className:"space-y-4",children:[(0,F.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"About"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.about})]}),(0,F.jsxs)("div",{className:"space-y-4",children:[(0,F.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Settings"}),(0,F.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Login Allowed"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.login_allowed?"Yes":"No"})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email Notifications"}),(0,F.jsx)("p",{className:"text-sm text-gray-900",children:V.email_notifications?"Yes":"No"})]})]})]}),(0,F.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[(0,F.jsx)(f.A,{variant:"secondary",onClick:ye,children:"Close"}),(0,F.jsx)(f.A,{onClick:()=>{ye(),xe(V)},children:"Edit Employee"})]})]})}),(0,F.jsx)(b.A,{isOpen:G,onClose:()=>D({showColumnModal:!1}),title:"Customize Table Columns",size:"md",children:(0,F.jsxs)("div",{className:"space-y-4",children:[(0,F.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Select which columns you want to display in the employee table:"}),(0,F.jsx)("div",{className:"grid grid-cols-2 gap-3 max-h-96 overflow-y-auto",children:Object.keys(E).map(e=>(0,F.jsxs)("label",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",children:[(0,F.jsx)("input",{type:"checkbox",checked:E[e],onChange:()=>(e=>{C(t=>({...t,[e]:!t[e]}))})(e),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,F.jsx)("span",{className:"text-sm font-medium text-gray-700",children:je(e)})]},e))}),(0,F.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[(0,F.jsx)(f.A,{variant:"secondary",onClick:()=>{C({employee_id:!0,name:!0,email:!0,user_role:!0,department:!0,joining_date:!0,work_from:!0,status:!0,designation:!1,mobile:!1,gender:!1,date_of_birth:!1,reporting_to:!1,language:!1,hourly_rate:!1,employment_type:!1,marital_status:!1,job_title:!1,emergency_contact_number:!1,emergency_contact_relation:!1})},children:"Reset to Default"}),(0,F.jsxs)("div",{className:"flex space-x-3",children:[(0,F.jsx)(f.A,{variant:"secondary",onClick:()=>D({showColumnModal:!1}),children:"Cancel"}),(0,F.jsx)(f.A,{onClick:()=>D({showColumnModal:!1}),children:"Apply"})]})]})]})}),(0,F.jsx)(b.A,{isOpen:q,onClose:fe,title:`${null===K||void 0===K?void 0:K.title} - ${X.length} Employees`,size:"xl",children:(0,F.jsxs)("div",{className:"space-y-4",children:[(0,F.jsxs)("div",{className:"relative",children:[(0,F.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,F.jsx)("input",{type:"text",placeholder:`Search within ${null===K||void 0===K||null===(t=K.title)||void 0===t?void 0:t.toLowerCase()}...`,className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 w-full",value:Q,onChange:e=>D({categorySearchTerm:e.target.value})})]}),(0,F.jsx)("div",{className:"overflow-x-auto",children:(0,F.jsxs)("table",{className:"w-full text-sm text-left text-gray-500",children:[(0,F.jsx)("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:(0,F.jsxs)("tr",{children:[(0,F.jsx)("th",{className:"px-6 py-3",children:"Employee"}),(0,F.jsx)("th",{className:"px-6 py-3",children:"Department"}),(0,F.jsx)("th",{className:"px-6 py-3",children:"Designation"}),(0,F.jsx)("th",{className:"px-6 py-3",children:"Status"}),(0,F.jsx)("th",{className:"px-6 py-3",children:"Work From"}),(0,F.jsx)("th",{className:"px-6 py-3",children:"Action"})]})}),(0,F.jsx)("tbody",{children:0===be().length?(0,F.jsx)("tr",{children:(0,F.jsx)("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500",children:Q?"No employees found matching your search":"No employees in this category"})}):be().map(e=>{var t;return(0,F.jsxs)("tr",{className:"bg-white border-b hover:bg-gray-50",children:[(0,F.jsx)("td",{className:"px-6 py-4",children:(0,F.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,F.jsx)("div",{className:"w-8 h-8 rounded-full overflow-hidden flex items-center justify-center",children:e.photo?(0,F.jsx)("img",{src:e.photo,alt:e.name,className:"w-full h-full object-cover"}):(0,F.jsx)("div",{className:"w-full h-full bg-indigo-600 flex items-center justify-center",children:(0,F.jsx)("span",{className:"text-white text-sm font-medium",children:(null===(t=e.name)||void 0===t?void 0:t.charAt(0))||"U"})})}),(0,F.jsxs)("div",{children:[(0,F.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,F.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]})]})}),(0,F.jsx)("td",{className:"px-6 py-4",children:e.department||"N/A"}),(0,F.jsx)("td",{className:"px-6 py-4",children:e.designation||"N/A"}),(0,F.jsx)("td",{className:"px-6 py-4",children:(0,F.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full "+("Active"===e.status?"bg-green-100 text-green-800":"Resigned"===e.status?"bg-yellow-100 text-yellow-800":"Terminated"===e.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:e.status||"Active"})}),(0,F.jsx)("td",{className:"px-6 py-4",children:e.work_from||"N/A"}),(0,F.jsx)("td",{className:"px-6 py-4",children:(0,F.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,F.jsx)("button",{onClick:()=>{fe(),ge(e)},className:"p-2 text-indigo-600 hover:text-indigo-800 hover:bg-indigo-50 rounded-lg transition-colors",title:"View Details",children:(0,F.jsx)(g.A,{className:"w-4 h-4"})}),(0,F.jsx)("button",{onClick:()=>{fe(),xe(e)},className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-50 rounded-lg transition-colors",title:"Edit Employee",children:(0,F.jsx)(y.A,{className:"w-4 h-4"})})]})})]},e.id)})})]})}),(0,F.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[(0,F.jsxs)("p",{className:"text-sm text-gray-600",children:["Showing ",be().length," of ",X.length," employees"]}),(0,F.jsx)("div",{className:"flex space-x-3",children:(0,F.jsx)(f.A,{variant:"secondary",onClick:fe,children:"Close"})})]})]})})]})});I.displayName="Employees";const $=I;function U(e){var t,a;let{employee:l}=e;const[o,r]=(0,s.useState)(()=>{const e=new Date;return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(0,10)}),{workload:n,loading:i}=function(e){let{employee:t,anchorDate:a}=e;const{user:l}=j.A?(0,j.A)():{user:null},[o,r]=(0,s.useState)([]),[n,i]=(0,s.useState)(!0),[c,d]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=!0;return(async()=>{try{i(!0),d(null);const t=new URLSearchParams;t.set("all","true");let a=`/api/tasks?${t.toString()}`;const s={};l&&(s["user-role"]=l.role||"employee",s["user-permissions"]=JSON.stringify("admin"===l.role||"Admin"===l.role?["all"]:l.permissions||[]),s["user-name"]=l.name||"");const o=await fetch(a,{headers:s});if(!o.ok)throw new Error("Failed to load tasks");const n=await o.json(),c=Array.isArray(null===n||void 0===n?void 0:n.data)?n.data:Array.isArray(n)?n:[];e&&r(c)}catch(t){e&&d(t)}finally{e&&i(!1)}})(),()=>{e=!1}},[]);const m=(0,s.useMemo)(()=>t?O(o,t,a):null,[o,t,a]);return{tasks:o,workload:m,loading:n,error:c}}({employee:l,anchorDate:o}),c=((null===n||void 0===n||null===(t=n.day)||void 0===t?void 0:t.deltaMinutes)||0)>0;return(0,F.jsxs)("div",{className:"flex flex-col items-end space-y-1",children:[(0,F.jsx)("div",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Workload"}),(0,F.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,F.jsx)("input",{type:"date",value:o,onChange:e=>r(e.target.value),className:"border rounded px-2 py-1 text-sm"}),(0,F.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-semibold "+(c?"bg-red-100 text-red-700":"bg-indigo-100 text-indigo-700"),children:i?"...":M((null===n||void 0===n||null===(a=n.day)||void 0===a?void 0:a.totalMinutes)||0)})]})]})}},7679:(e,t,a)=>{a.d(t,{A:()=>d});var s=a(5043);const l=(0,a(3797).A)("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var o=a(8775),r=a(6787),n=a(6339),i=a(5016),c=a(579);const d=e=>{let{onSelect:t,onEdit:a,onDelete:d,isErrorMenu:m=!1,itemType:u="item"}=e;const{user:p}=(0,i.A)(),[x,h]=(0,s.useState)(!1),[g,y]=(0,s.useState)({top:0,left:0}),f=(0,s.useRef)(null);(0,s.useEffect)(()=>{const e=()=>h(!1);return x&&(window.addEventListener("click",e),window.addEventListener("scroll",e,!0)),()=>{window.removeEventListener("click",e),window.removeEventListener("scroll",e,!0)}},[x]);const b={canView:!0,canEdit:!0,canDelete:!0};return console.log("\ud83d\udd0d Final Permission Check:",b),console.log("\ud83d\udd0d Can View:",b.canView),console.log("\ud83d\udd0d Can Edit:",b.canEdit),console.log("\ud83d\udd0d Can Delete:",b.canDelete),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("button",{ref:f,onClick:e=>{if(e.stopPropagation(),f.current){const e=f.current.getBoundingClientRect();y({top:e.bottom+2,left:e.right-160})}h(e=>!e)},className:"p-2 rounded-full hover:bg-gray-100 transition-colors",title:"Actions",children:(0,c.jsx)(l,{size:16})}),x&&(0,c.jsx)("div",{style:{position:"fixed",top:`${g.top}px`,left:`${g.left}px`},className:"w-40 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50",onClick:e=>e.stopPropagation(),children:(0,c.jsxs)("div",{className:"py-1",role:"menu","aria-orientation":"vertical",children:[!m&&b.canView&&t&&(0,c.jsxs)("button",{onClick:e=>{e.preventDefault(),t(),h(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",role:"menuitem",children:[(0,c.jsx)(o.A,{size:14,className:"mr-3 flex-shrink-0"}),"View"]}),b.canEdit&&a&&(0,c.jsxs)("button",{onClick:e=>{e.preventDefault(),a(),h(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",role:"menuitem",children:[(0,c.jsx)(r.A,{size:14,className:"mr-3 flex-shrink-0"}),"Edit"]}),b.canDelete&&d&&(0,c.jsxs)("button",{onClick:e=>{e.preventDefault(),d(),h(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100 transition-colors",role:"menuitem",children:[(0,c.jsx)(n.A,{size:14,className:"mr-3 flex-shrink-0"}),"Delete"]}),!b.canView&&!b.canEdit&&!b.canDelete&&(0,c.jsx)("div",{className:"px-4 py-2 text-sm text-gray-500 italic",children:"No actions available"})]})})]})}}}]);
//# sourceMappingURL=607.519d4b0d.chunk.js.map