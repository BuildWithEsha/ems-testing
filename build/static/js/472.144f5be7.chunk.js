"use strict";(self.webpackChunkemployee_management_system=self.webpackChunkemployee_management_system||[]).push([[472],{1472:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var s=a(5043),r=a(2380),n=a(8147),o=a(7008),i=a(6339),l=a(6787);const d=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const a=await fetch(e,t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return null==e?t:e&&"object"===typeof e&&"data"in e?Array.isArray(e.data)?e.data:t:Array.isArray(e)?e:t}(await a.json())}catch(a){return console.error("API fetch error:",a),[]}};var c=a(579);function m(){const[e,t]=(0,s.useState)([]),[a,m]=(0,s.useState)(""),[x,p]=(0,s.useState)({active:!1,entry:null}),[g,u]=(0,s.useState)({total_seconds:0,entries:[]}),[h,y]=(0,s.useState)((new Date).getMonth()+1),[f,b]=(0,s.useState)((new Date).getFullYear()),[j,w]=(0,s.useState)((new Date).toISOString().slice(0,10)),[N,v]=(0,s.useState)((new Date).toISOString().slice(0,10)),[k,_]=(0,s.useState)(!1),[S,C]=(0,s.useState)(()=>(new Date).toISOString().slice(0,10)),[A,E]=(0,s.useState)({date:"",entries:[],notClockedIn:[]}),[$,D]=(0,s.useState)(!1),[I,T]=(0,s.useState)(!1),[L,O]=(0,s.useState)(null),[R,U]=(0,s.useState)([]),[F,M]=(0,s.useState)(!1),[P,H]=(0,s.useState)({total_days:0,total_hours:0,total_seconds:0,absentees:0}),[q,z]=(0,s.useState)(!0),[B,W]=(0,s.useState)([]),[Y,J]=(0,s.useState)(!1),[G,Z]=(0,s.useState)(!1),[K,Q]=(0,s.useState)(!1),[V,X]=(0,s.useState)("management");(0,s.useEffect)(()=>{d("/api/employees").then(e=>{console.log("Attendance - Employees data:",e),t(e)}).catch(e=>{console.error("Error fetching employees:",e),t([])})},[]);const ee=async()=>{if(!a)return;const[e,t]=await Promise.all([fetch(`/api/attendance/status?employee_id=${a}`),fetch(`/api/attendance/summary?employee_id=${a}&month=${h}&year=${f}`)]);e.ok&&p(await e.json()),t.ok&&u(await t.json())};(0,s.useEffect)(()=>{ee()},[a,h,f]);(0,s.useEffect)(()=>{(async()=>{const e=await fetch(`/api/attendance/daily-log?date=${S}`);e.ok&&E(await e.json())})()},[S]);const te=e=>{const t="number"===typeof e?e:0,a=Math.floor(t/3600),s=Math.floor(t%3600/60),r=t%60;return`${String(a).padStart(2,"0")}:${String(s).padStart(2,"0")}:${String(r).padStart(2,"0")}`},ae=e=>{if(!e)return"-";if("number"===typeof e||!isNaN(e)){return new Date(86400*(parseInt(e)-25569)*1e3).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})}try{const t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})}catch(t){return e}},[se,re]=(0,s.useState)({employee_id:"",date:(new Date).toISOString().slice(0,10),clock_in:"09:00",clock_out:"",hours_worked:""}),ne=async()=>{M(!0);try{const e=new URLSearchParams;a&&e.append("employee_id",a),j&&e.append("from_date",j),N&&e.append("to_date",N),q||e.append("exclude_imported","true");const t=await fetch(`/api/attendance/records?${e}`);if(t.ok){const e=await t.json();U(e)}const s=new URLSearchParams;a&&s.append("employee_id",a),j&&s.append("from_date",j),N&&s.append("to_date",N),q||s.append("exclude_imported","true");const r=await fetch(`/api/attendance/summary?${s}`);if(r.ok){const e=await r.json();H({total_days:parseInt(e.total_days)||0,total_hours:parseFloat(e.total_hours)||0,total_seconds:parseInt(e.total_seconds)||0,absentees:parseInt(e.absentees)||0})}}catch(e){console.error("Error loading attendance data:",e)}finally{M(!1)}};(0,s.useEffect)(()=>{ne()},[a,j,N,q]);const oe=async()=>{try{const e=await fetch("/api/attendance/sample");if(e.ok){const t=await e.blob(),a=window.URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download="attendance_import_sample.xlsx",document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(a),document.body.removeChild(s)}else alert("Error downloading sample file")}catch(e){console.error("Error downloading sample:",e),alert("Error downloading sample file")}};return(0,c.jsxs)("div",{className:"p-6",children:[(0,c.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Attendance"}),(0,c.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,c.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,c.jsx)("button",{onClick:()=>X("management"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("management"===V?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Attendance Management"}),(0,c.jsx)("button",{onClick:()=>X("log"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("log"===V?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Attendance Log"})]})}),"management"===V&&(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border space-y-6",children:[(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee"}),(0,c.jsxs)("select",{value:a,onChange:e=>m(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[(0,c.jsx)("option",{value:"",children:"Select Employee..."}),Array.isArray(e)?e.map(e=>(0,c.jsx)("option",{value:e.id,children:e.name},e.id)):[]]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),(0,c.jsx)("input",{type:"date",value:j,onChange:e=>w(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),(0,c.jsx)("input",{type:"date",value:N,onChange:e=>v(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]}),(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,c.jsx)("button",{onClick:ne,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium",children:"Search"}),(0,c.jsxs)("button",{onClick:()=>{re(e=>({...e,employee_id:a||""})),T(!0)},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm font-medium",children:[(0,c.jsx)(r.A,{className:"w-4 h-4 inline mr-1"}),"Add Record"]}),(0,c.jsxs)("button",{onClick:()=>Q(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm font-medium",children:[(0,c.jsx)(n.A,{className:"w-4 h-4 inline mr-1"}),"Import"]}),(0,c.jsxs)("button",{onClick:oe,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-sm font-medium",children:[(0,c.jsx)(o.A,{className:"w-4 h-4 inline mr-1"}),"Sample"]})]}),(0,c.jsx)("div",{className:"flex items-center space-x-3",children:(0,c.jsxs)("button",{onClick:async()=>{if(confirm("\u26a0\ufe0f WARNING: This will permanently delete ALL attendance records from the database. This action cannot be undone. Are you absolutely sure?")&&confirm("Final confirmation: You are about to delete ALL attendance records. This will affect all employees and cannot be recovered. Continue?"))try{const e=await fetch("/api/attendance/clear-all",{method:"DELETE",headers:{"Content-Type":"application/json","x-confirm-clear-all":"true"}});if(e.ok){const t=await e.json();alert(t.message),W([]),J(!1),await ne(),await ee()}else{const t=await e.json();alert(t.error||"Error clearing all attendance data")}}catch(e){console.error("Error clearing all attendance data:",e),alert("Error clearing all attendance data")}},className:"px-4 py-2 bg-red-700 text-white rounded-lg hover:bg-red-800 text-sm font-medium",title:"Clear all attendance data from database",children:[(0,c.jsx)(i.A,{className:"w-4 h-4 inline mr-1"}),"Clear All Data"]})})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 bg-gray-50 p-4 rounded-lg",children:[(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:P.total_days}),(0,c.jsx)("div",{className:"text-sm text-gray-600",children:"Total Days"})]}),(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsx)("div",{className:"text-2xl font-bold text-green-900",children:"number"===typeof P.total_hours?`${P.total_hours.toFixed(2)}h`:"0.00h"}),(0,c.jsx)("div",{className:"text-sm text-gray-600",children:"Total Hours"})]}),(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsx)("div",{className:"text-2xl font-bold text-red-900",children:P.absentees>0?P.absentees:"N/A"}),(0,c.jsx)("div",{className:"text-sm text-gray-600",children:"Absentees"})]})]}),(0,c.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("div",{className:"flex-shrink-0",children:(0,c.jsx)("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,c.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,c.jsx)("div",{className:"ml-3",children:(0,c.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,c.jsx)("strong",{children:"Note:"})," All attendance records are now displayed without any limit. You can view, edit, or delete any record in the system."]})})]})}),(0,c.jsxs)("div",{className:"mt-6 bg-white rounded-lg shadow-sm border",children:[(0,c.jsxs)("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,c.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Attendance Records"}),(0,c.jsx)("span",{className:"text-sm text-gray-500",children:F?"Loading...":`${R.length} record(s) loaded`})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[B.length>0&&(0,c.jsxs)("button",{onClick:async()=>{if(0!==B.length){if(confirm(`Are you sure you want to delete ${B.length} attendance record(s)?`)){console.log("Sending bulk delete request with IDs:",B);try{const e=await fetch("/api/attendance/bulk",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:B})});if(e.ok){const t=await e.json();console.log("Bulk delete success:",t),alert(t.message),W([]),J(!1),await ne(),await ee()}else{const t=await e.json();console.error("Bulk delete error response:",t),alert(t.error||"Error deleting attendance records")}}catch(e){console.error("Error deleting attendance records:",e),alert("Error deleting attendance records")}}}else alert("Please select records to delete")},className:"px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium",children:[(0,c.jsx)(i.A,{className:"w-4 h-4 inline mr-1"}),"Delete Selected (",B.length,")"]}),(0,c.jsxs)("button",{onClick:()=>{re(e=>({...e,employee_id:a||""})),T(!0)},className:"px-3 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm font-medium",children:[(0,c.jsx)(r.A,{className:"w-4 h-4 inline mr-1"}),"Add Record"]})]})]}),(0,c.jsx)("div",{className:"overflow-x-auto",children:(0,c.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,c.jsx)("thead",{className:"bg-gray-50",children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,c.jsx)("input",{type:"checkbox",checked:Y&&R.length>0,onChange:()=>{Y?(W([]),J(!1)):(W(R.map(e=>e.id)),J(!0))},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"})}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clock In"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clock Out"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,c.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:F?(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:"7",className:"px-6 py-8 text-center text-gray-500",children:"Loading attendance records..."})}):0===R.length?(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:"7",className:"px-6 py-8 text-center text-gray-500",children:"No attendance records found for the selected date range"})}):R.map(e=>(0,c.jsxs)("tr",{className:"hover:bg-gray-50 "+(e.is_imported?"bg-blue-50":""),children:[(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:(0,c.jsx)("input",{type:"checkbox",checked:B.includes(e.id),onChange:()=>{return t=e.id,void W(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"})}),(0,c.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[e.employee_name,e.is_imported&&(0,c.jsx)("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"Imported"})]}),(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ae(e.date)}),(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.clock_in}),(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.clock_out||"-"}),(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,c.jsx)("button",{onClick:()=>{if(e.session_count>1&&e.sessions){const t=e.sessions.map((e,t)=>`Session ${t+1}: ${e.clock_in} - ${e.clock_out||"Active"} (${te(e.duration_seconds||0)})`).join("\n");alert(`${e.employee_name}'s Sessions for ${ae(e.date)}:\n\n${t}\n\nTotal: ${te(e.duration_seconds||0)}`)}},className:"text-left "+(e.session_count>1?"cursor-pointer hover:text-indigo-600":""),title:e.session_count>1?"Click to view detailed sessions":"Single session",children:e.duration_seconds&&e.duration_seconds>0?te(e.duration_seconds):e.hours_worked&&"number"===typeof e.hours_worked&&e.hours_worked>0?`${e.hours_worked.toFixed(2)}h`:"-"})}),(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("button",{onClick:()=>(e=>{O(e);let t=e.date;if(e.date)if("number"!==typeof e.date&&isNaN(e.date)){if("string"===typeof e.date){const a=new Date(e.date);isNaN(a.getTime())||(t=a.toISOString().split("T")[0])}}else t=new Date(86400*(parseInt(e.date)-25569)*1e3).toISOString().split("T")[0];re({employee_id:e.employee_id,date:t,clock_in:e.clock_in,clock_out:e.clock_out||"",hours_worked:e.hours_worked||""}),T(!0)})(e),className:"text-indigo-600 hover:text-indigo-900",title:"Edit record",children:(0,c.jsx)(l.A,{className:"w-4 h-4"})}),(0,c.jsx)("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this attendance record?"))try{const t=await fetch(`/api/attendance/${e}`,{method:"DELETE"});if(t.ok)alert("Attendance record deleted successfully"),await ne(),await ee();else{const e=await t.json();alert(e.error||"Error deleting attendance record")}}catch(t){console.error("Error deleting attendance:",t),alert("Error deleting attendance record")}})(e.id),className:"text-red-600 hover:text-red-900",title:"Delete record",children:(0,c.jsx)(i.A,{className:"w-4 h-4"})})]})})]},e.id))})]})})]})]}),I&&(0,c.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[(0,c.jsx)("div",{className:"px-6 py-4 border-b",children:(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:L?"Edit Attendance Record":"Add Attendance Record"})}),(0,c.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=L?`/api/attendance/${L.id}`:"/api/attendance/add",t=L?"PUT":"POST",a=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(se)});if(a.ok){const e=await a.json();alert(e.message),T(!1),O(null),re({employee_id:"",date:(new Date).toISOString().slice(0,10),clock_in:"09:00",clock_out:"",hours_worked:""}),await ne(),await ee()}else{const e=await a.json();alert(e.error||"Error saving attendance record")}}catch(t){console.error("Error saving attendance:",t),alert("Error saving attendance record")}},className:"px-6 py-4 space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee"}),(0,c.jsxs)("select",{value:se.employee_id,onChange:e=>re(t=>({...t,employee_id:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:[(0,c.jsx)("option",{value:"",children:"Select Employee..."}),Array.isArray(e)?e.map(e=>(0,c.jsx)("option",{value:e.id,children:e.name},e.id)):[]]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,c.jsx)("input",{type:"date",value:se.date,onChange:e=>re(t=>({...t,date:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clock In"}),(0,c.jsx)("input",{type:"time",value:se.clock_in,onChange:e=>re(t=>({...t,clock_in:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clock Out"}),(0,c.jsx)("input",{type:"time",value:se.clock_out,onChange:e=>re(t=>({...t,clock_out:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hours Worked (optional)"}),(0,c.jsx)("input",{type:"number",step:"0.01",value:se.hours_worked,onChange:e=>re(t=>({...t,hours_worked:e.target.value})),placeholder:"e.g., 8.5",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),(0,c.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to calculate from clock in/out times"})]}),(0,c.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,c.jsx)("button",{type:"button",onClick:()=>{T(!1),O(null),re({employee_id:"",date:(new Date).toISOString().slice(0,10),clock_in:"09:00",clock_out:"",hours_worked:""})},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,c.jsxs)("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:[L?"Update":"Add"," Record"]})]})]})]})}),"log"===V&&(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,c.jsxs)("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[(0,c.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Attendance Log"}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("input",{type:"date",value:S,onChange:e=>C(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),(0,c.jsx)("button",{onClick:()=>D(!1),className:"px-3 py-2 rounded-lg text-sm font-medium "+($?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-indigo-600 text-white"),children:"All"}),(0,c.jsx)("button",{onClick:()=>D(!0),className:"px-3 py-2 rounded-lg text-sm font-medium "+($?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Not Clocked In"})]})]}),(0,c.jsx)("div",{className:"overflow-x-auto",children:(0,c.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,c.jsx)("thead",{className:"bg-gray-50",children:(0,c.jsx)("tr",{children:$?(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clock In"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clock Out"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"})]})})}),(0,c.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:$?A.notClockedIn&&0!==A.notClockedIn.length?(A.notClockedIn||[]).map(e=>(0,c.jsx)("tr",{className:"hover:bg-gray-50",children:(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name})},e.id)):(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:"1",className:"px-6 py-8 text-center text-gray-500",children:"All employees have clocked in today"})}):A.entries&&0!==A.entries.length?(A.entries||[]).map(e=>{var t,a;return(0,c.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:(0,c.jsx)("button",{onClick:()=>{var t;const a=null===(t=A.employee_totals)||void 0===t?void 0:t.find(t=>t.employee_id===e.employee_id);a&&a.sessions.length>1&&alert(`${e.employee_name}'s Sessions for ${S}:\n\n${a.sessions.map((e,t)=>`Session ${t+1}: ${e.clock_in} - ${e.clock_out||"Active"} (${te(e.duration_seconds||0)})`).join("\n")}\n\nTotal: ${te(e.total_seconds||0)}`)},className:"text-indigo-600 hover:text-indigo-900 font-medium cursor-pointer",title:(null===(t=A.employee_totals)||void 0===t||null===(a=t.find(t=>t.employee_id===e.employee_id))||void 0===a?void 0:a.sessions.length)>1?"Click to view detailed sessions":"Single session",children:e.employee_name})}),(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.first_clock_in||"-"}),(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.last_clock_out||"-"}),(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:te(e.total_seconds||0)})]},e.employee_id)}):(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:"4",className:"px-6 py-8 text-center text-gray-500",children:"No attendance entries found for this date"})})})]})})]}),K&&(0,c.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[(0,c.jsx)("div",{className:"px-6 py-4 border-b",children:(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Import Attendance Records"})}),(0,c.jsxs)("div",{className:"px-6 py-4 space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Upload an Excel file with attendance records. The file should contain columns for Employee Name, Date, Clock In, Clock Out (optional), and Hours Worked (optional)."}),(0,c.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,c.jsx)("input",{type:"file",accept:".xlsx,.xls",onChange:async e=>{const t=e.target.files[0];if(t){Z(!0);try{const e=new FormData;e.append("file",t);const a=await fetch("/api/attendance/import",{method:"POST",body:e});if(a.ok){const e=await a.json();alert(e.message),await ne(),await ee()}else{const e=await a.json();alert(e.error||"Error importing attendance records")}}catch(a){console.error("Error importing attendance:",a),alert("Error importing attendance records")}finally{Z(!1),Q(!1),e.target.value=""}}},disabled:G,className:"hidden",id:"attendance-import-file"}),(0,c.jsxs)("label",{htmlFor:"attendance-import-file",className:"cursor-pointer inline-flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:[(0,c.jsx)(n.A,{className:"w-4 h-4 mr-2"}),G?"Importing...":"Choose File"]}),(0,c.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Supports .xlsx and .xls files"})]})]}),(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsxs)("button",{onClick:oe,className:"text-indigo-600 hover:text-indigo-800 text-sm flex items-center",children:[(0,c.jsx)(o.A,{className:"w-4 h-4 mr-1"}),"Download Sample File"]}),(0,c.jsx)("button",{onClick:()=>Q(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"})]})]})]})})]})}},2380:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(3797).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},6787:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(3797).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},8147:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(3797).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])}}]);
//# sourceMappingURL=472.144f5be7.chunk.js.map