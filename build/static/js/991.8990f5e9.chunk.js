"use strict";(self.webpackChunkemployee_management_system=self.webpackChunkemployee_management_system||[]).push([[991],{2380:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(3797).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5104:(e,t,s)=>{s.d(t,{A:()=>l});s(5043);var a=s(579);const l=e=>{let{label:t,name:s,type:l="text",placeholder:r="",required:i=!1,disabled:n=!1,defaultValue:o="",className:d="",onChange:c,error:m,...x}=e;return(0,a.jsxs)("div",{className:d,children:[t&&(0,a.jsxs)("label",{htmlFor:s,className:"block text-sm font-medium text-gray-700 mb-1",children:[t,i&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,a.jsx)("input",{id:s,name:s,type:l,placeholder:r,required:i,disabled:n,onChange:c,className:`\n          w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm\n          focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\n          disabled:bg-gray-50 disabled:text-gray-500\n          ${m?"border-red-500 focus:ring-red-500 focus:border-red-500":""}\n        `,...x}),m&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:m})]})}},6787:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(3797).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},7679:(e,t,s)=>{s.d(t,{A:()=>c});var a=s(5043);const l=(0,s(3797).A)("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var r=s(8775),i=s(6787),n=s(6339),o=s(5016),d=s(579);const c=e=>{let{onSelect:t,onEdit:s,onDelete:c,isErrorMenu:m=!1,itemType:x="item"}=e;const{user:u}=(0,o.A)(),[h,p]=(0,a.useState)(!1),[g,y]=(0,a.useState)({top:0,left:0}),f=(0,a.useRef)(null);(0,a.useEffect)(()=>{const e=()=>p(!1);return h&&(window.addEventListener("click",e),window.addEventListener("scroll",e,!0)),()=>{window.removeEventListener("click",e),window.removeEventListener("scroll",e,!0)}},[h]);const b={canView:!0,canEdit:!0,canDelete:!0};return console.log("\ud83d\udd0d Final Permission Check:",b),console.log("\ud83d\udd0d Can View:",b.canView),console.log("\ud83d\udd0d Can Edit:",b.canEdit),console.log("\ud83d\udd0d Can Delete:",b.canDelete),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{ref:f,onClick:e=>{if(e.stopPropagation(),f.current){const e=f.current.getBoundingClientRect();y({top:e.bottom+2,left:e.right-160})}p(e=>!e)},className:"p-2 rounded-full hover:bg-gray-100 transition-colors",title:"Actions",children:(0,d.jsx)(l,{size:16})}),h&&(0,d.jsx)("div",{style:{position:"fixed",top:`${g.top}px`,left:`${g.left}px`},className:"w-40 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50",onClick:e=>e.stopPropagation(),children:(0,d.jsxs)("div",{className:"py-1",role:"menu","aria-orientation":"vertical",children:[!m&&b.canView&&t&&(0,d.jsxs)("button",{onClick:e=>{e.preventDefault(),t(),p(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",role:"menuitem",children:[(0,d.jsx)(r.A,{size:14,className:"mr-3 flex-shrink-0"}),"View"]}),b.canEdit&&s&&(0,d.jsxs)("button",{onClick:e=>{e.preventDefault(),s(),p(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",role:"menuitem",children:[(0,d.jsx)(i.A,{size:14,className:"mr-3 flex-shrink-0"}),"Edit"]}),b.canDelete&&c&&(0,d.jsxs)("button",{onClick:e=>{e.preventDefault(),c(),p(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100 transition-colors",role:"menuitem",children:[(0,d.jsx)(n.A,{size:14,className:"mr-3 flex-shrink-0"}),"Delete"]}),!b.canView&&!b.canEdit&&!b.canDelete&&(0,d.jsx)("div",{className:"px-4 py-2 text-sm text-gray-500 italic",children:"No actions available"})]})})]})}},8147:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(3797).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},8991:(e,t,s)=>{s.r(t),s.d(t,{default:()=>E});var a=s(5043),l=s(7219),r=s(1490),i=s(7008),n=s(8147),o=s(6787),d=s(2380),c=s(1372),m=s(917),x=s(3458),u=s(2543),h=s(9256),p=s(6339),g=s(3957);const y=(0,s(3797).A)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);var f=s(1172),b=s(1425),j=s(4450),v=s(5104),k=s(9749),N=s(7679),w=s(5016),_=s(699);const C=new class{constructor(){this.metrics={},this.isEnabled=!1}startTiming(e){this.isEnabled&&(this.metrics[e]={startTime:performance.now(),endTime:null,duration:null})}endTiming(e){if(!this.isEnabled||!this.metrics[e])return;const t=this.metrics[e];return t.endTime=performance.now(),t.duration=t.endTime-t.startTime,t.duration>1e3?console.warn(`\ud83d\udc0c Slow operation detected: ${e} took ${t.duration.toFixed(2)}ms`):t.duration>500?console.info(`\u26a0\ufe0f  Moderate operation: ${e} took ${t.duration.toFixed(2)}ms`):console.log(`\u2705 Fast operation: ${e} took ${t.duration.toFixed(2)}ms`),t.duration}measureApiCall(e,t){if(!this.isEnabled)return t;const s=`API: ${e}`;return this.startTiming(s),t.then(e=>(this.endTiming(s),e)).catch(e=>{throw this.endTiming(s),e})}getReport(){if(!this.isEnabled)return{};const e={};return Object.keys(this.metrics).forEach(t=>{const s=this.metrics[t];null!==s.duration&&(e[t]={duration:s.duration,startTime:s.startTime,endTime:s.endTime})}),e}clear(){this.metrics={}}},T=e=>C.measureApiCall("Task Loading",e),A=(e,t)=>C.measureApiCall(`Task Details ${e}`,t);var S=s(579);const D=(0,a.memo)(function(e){let{initialOpenTask:t,onConsumeInitialOpenTask:s}=e;const{user:D}=(0,w.A)();console.log("\ud83d\ude80 Tasks component initialized");const[E,M]=(0,a.useState)({tasks:[],departments:[],employees:[],labels:[],loading:!0,error:null}),[L,P]=(0,a.useState)({searchTerm:"",selectedTask:null,selectedTasks:new Set,taskDetailTab:"files",showModal:!1,showImportModal:!1,showFilterModal:!1,showColumnModal:!1,showDetailModal:!1,showBulkStatusModal:!1,showTaskCalculationModal:!1,showStopTimerModal:!1,showDeleteHistoryModal:!1,showDeleteAllHistoryModal:!1,showChecklistWarningModal:!1,showExportModal:!1,showUpdateModal:!1,totalTasks:0,currentPage:1,hasMoreTasks:!0,loadingMore:!1}),[I,$]=(0,a.useState)({files:[],subtasks:[],comments:[],timesheet:[],timesheetTotal:0,notes:"",history:[],newComment:"",newSubtask:"",uploadedFile:null,editingSubtaskId:null,editingSubtaskTitle:"",editingCommentId:null,editingCommentText:""}),U=(0,a.useMemo)(()=>I.timesheet.reduce((e,t)=>e+(t.hours_logged_seconds||0),0),[I.timesheet]),[R,O]=(0,a.useState)({editingTask:null,importLoading:!1,selectedFile:null,importResult:null,bulkStatus:"",newValues:{impact:"",priority:"",complexity:"",effort:"",labels:""},newScores:{impact:50,priority:50,complexity:50,effort:50,labels:50},editingItem:null,editingScore:0}),[F,H]=(0,a.useState)({status:"",priority:"",complexity:"",impact:"",effortEstimateLabel:"",unit:"",target:"",department:"",assignedTo:[],labels:"",responsible:[],accountable:[],consulted:[],informed:[],trained:[]}),[W,z]=(0,a.useState)({activeTimers:{},intervals:{},stopTimerTaskId:null,stopTimerMemo:"",stopTimerStartTime:"",stopTimerEndTime:"",stopTimerTotalTime:""}),[B,V]=(0,a.useState)({historyToDelete:null,checklistWarningTask:null,checklistCompletion:{}}),[Y,J]=(0,a.useState)(()=>{try{const e=localStorage.getItem(`taskColumns_${(null===D||void 0===D?void 0:D.id)||"default"}`),t={checkbox:!0,id:!1,title:!0,task:!0,department:!0,task_category:!1,project:!1,start_date:!1,due_date:!0,without_due_date:!1,assigned_to:!0,assignedTo:!0,status:!0,description:!1,responsible:!1,accountable:!1,consulted:!1,informed:!1,trained:!1,labels:!0,label_id:!1,milestones:!1,priority:!0,complexity:!0,impact:!0,unit:!0,target:!0,effort_estimate_label:!0,effortEstimate:!0,time_estimate:!0,make_private:!1,share:!1,repeat:!1,is_dependent:!1,validation_by:!1,effort_label:!1,checklist:!1,workflow_guide:!1,timer_started_at:!1,logged_seconds:!0,timer:!0,created_at:!1,updated_at:!1,score:!0,actions:!0};if(e){const s=JSON.parse(e);return{...t,...s}}return t}catch(e){return{checkbox:!0,id:!1,title:!0,department:!0,task_category:!1,project:!1,start_date:!1,due_date:!0,without_due_date:!1,assigned_to:!0,status:!0,description:!1,responsible:!1,accountable:!1,consulted:!1,informed:!1,trained:!1,labels:!0,label_id:!1,milestones:!1,priority:!0,complexity:!0,impact:!0,unit:!0,target:!0,effort_estimate_label:!0,time_estimate:!0,make_private:!1,share:!1,repeat:!1,is_dependent:!1,validation_by:!1,effort_label:!1,checklist:!1,workflow_guide:!1,timer_started_at:!1,logged_seconds:!0,created_at:!1,updated_at:!1,score:!0,actions:!0}}}),[G,q]=(0,a.useState)(()=>{try{const e=localStorage.getItem(`taskColumnWidths_${(null===D||void 0===D?void 0:D.id)||"default"}`),t={checkbox:60,id:80,title:300,task:300,department:120,task_category:120,project:120,start_date:100,due_date:100,without_due_date:100,assigned_to:150,assignedTo:150,status:100,description:200,responsible:120,accountable:120,consulted:120,informed:120,trained:120,labels:120,label_id:80,milestones:120,priority:100,complexity:100,impact:100,unit:80,target:80,effort_estimate_label:120,effortEstimate:120,time_estimate:120,make_private:100,share:80,repeat:80,is_dependent:100,validation_by:120,effort_label:120,checklist:150,workflow_guide:150,timer_started_at:120,logged_seconds:100,timer:120,created_at:120,updated_at:120,score:80,actions:100};if(e){const s=JSON.parse(e);return{...t,...s}}return t}catch(e){return{checkbox:60,id:80,title:300,task:300,department:120,task_category:120,project:120,start_date:100,due_date:100,without_due_date:100,assigned_to:150,assignedTo:150,status:100,description:200,responsible:120,accountable:120,consulted:120,informed:120,trained:120,labels:120,label_id:80,milestones:120,priority:100,complexity:100,impact:100,unit:80,target:80,effort_estimate_label:120,effortEstimate:120,time_estimate:120,make_private:100,share:80,repeat:80,is_dependent:100,validation_by:120,effort_label:120,checklist:150,workflow_guide:150,timer_started_at:120,logged_seconds:100,timer:120,created_at:120,updated_at:120,score:80,actions:100}}}),[K,Q]=(0,a.useState)(()=>{try{const e=localStorage.getItem(`taskColumnOrder_${(null===D||void 0===D?void 0:D.id)||"default"}`),t=["checkbox","task","title","department","assignedTo","assigned_to","priority","complexity","impact","effortEstimate","effort_estimate_label","time_estimate","score","unit","target","status","timer","logged_seconds","actions","id","task_category","project","start_date","due_date","without_due_date","description","responsible","accountable","consulted","informed","trained","labels","label_id","milestones","make_private","share","repeat","is_dependent","validation_by","effort_label","checklist","workflow_guide","timer_started_at","created_at","updated_at"];if(e){const s=JSON.parse(e),a=t.filter(e=>!s.includes(e));return[...s,...a]}return t}catch(e){return["checkbox","task","title","department","assignedTo","assigned_to","priority","complexity","impact","effortEstimate","effort_estimate_label","time_estimate","score","unit","target","status","timer","logged_seconds","actions","id","task_category","project","start_date","due_date","without_due_date","description","responsible","accountable","consulted","informed","trained","labels","label_id","milestones","make_private","share","repeat","is_dependent","validation_by","effort_label","checklist","workflow_guide","timer_started_at","created_at","updated_at"]}});(0,a.useEffect)(()=>{t&&(se({selectedTask:t,showDetailModal:!0}),(0,a.startTransition)(()=>{Jt(t.id)}),s&&s())},[t,s]),(0,a.useEffect)(()=>{null!==D&&void 0!==D&&D.id&&(localStorage.setItem(`taskColumns_${D.id}`,JSON.stringify(Y)),localStorage.setItem(`taskColumnWidths_${D.id}`,JSON.stringify(G)),localStorage.setItem(`taskColumnOrder_${D.id}`,JSON.stringify(K)))},[Y,G,K,null===D||void 0===D?void 0:D.id]);const{scoringWeights:X,scoringPoints:Z,updateScoringPoints:ee}=(0,_.j)(),te=(0,a.useCallback)(e=>{M(t=>({...t,...e}))},[]),se=(0,a.useCallback)(e=>{P(t=>({...t,...e}))},[]),ae=(0,a.useCallback)(e=>{$(t=>({...t,...e}))},[]),le=(0,a.useCallback)(e=>{O(t=>({...t,...e}))},[]),re=(0,a.useCallback)(e=>{H(t=>({...t,...e}))},[]),ie=(0,a.useCallback)(e=>{z(t=>({...t,...e}))},[]),ne=(0,a.useCallback)(e=>{V(t=>({...t,...e}))},[]),{tasks:oe,departments:de,employees:ce,labels:me,loading:xe,error:ue}=E,{searchTerm:he,selectedTask:pe,selectedTasks:ge,taskDetailTab:ye,showModal:fe,showImportModal:be,showFilterModal:je,showColumnModal:ve,showDetailModal:ke,showBulkStatusModal:Ne,showTaskCalculationModal:we,showStopTimerModal:_e,showDeleteHistoryModal:Ce,showDeleteAllHistoryModal:Te,showChecklistWarningModal:Ae,showExportModal:Se,showUpdateModal:De,totalTasks:Ee,currentPage:Me,hasMoreTasks:Le,loadingMore:Pe}=L,{files:Ie,subtasks:$e,comments:Ue,timesheet:Re,timesheetTotal:Oe,notes:Fe,history:He,newComment:We,newSubtask:ze,uploadedFile:Be,editingSubtaskId:Ve,editingSubtaskTitle:Ye,editingCommentId:Je,editingCommentText:Ge}=I;(0,a.useEffect)(()=>{ce&&0!==ce.length&&Wt(e=>{const t=e.assignedTo||[];if(0===t.length)return e;let s=!1;const a=t.map(e=>{const t="string"===typeof e.label&&e.label.includes("(");if(!("string"===typeof e.value&&e.value.startsWith("fallback-"))&&t)return e;const a=(e.label||"").split(" (")[0],l=ce.find(e=>(e.name||"").toLowerCase()===a.toLowerCase());return l?(s=!0,{value:l.id,label:`${l.name} (${l.employee_id||""})`}):e});return s?{...e,assignedTo:a}:e})},[ce]);const qe=(0,a.useCallback)(e=>ae({files:e}),[ae]),Ke=(0,a.useCallback)(e=>{if("function"===typeof e)$(t=>({...t,comments:e(t.comments)}));else{const t=Array.isArray(e)?e:[];ae({comments:t})}},[ae]),Qe=(0,a.useCallback)(e=>{if("function"===typeof e)$(t=>({...t,subtasks:e(t.subtasks)}));else{const t=Array.isArray(e)?e:[];ae({subtasks:t})}},[ae]),Xe=(0,a.useCallback)(e=>ae({timesheet:e}),[ae]),Ze=(0,a.useCallback)(e=>ae({notes:e}),[ae]),et=(0,a.useCallback)(e=>ae({history:e}),[ae]),tt=(0,a.useCallback)(e=>ae({newComment:e}),[ae]),st=(0,a.useCallback)(e=>ae({newSubtask:e}),[ae]),at=(0,a.useCallback)(e=>ae({editingSubtaskId:e}),[ae]),lt=(0,a.useCallback)(e=>ae({editingSubtaskTitle:e}),[ae]),rt=(0,a.useCallback)(e=>ae({editingCommentId:e}),[ae]),it=(0,a.useCallback)(e=>ae({editingCommentText:e}),[ae]),{editingTask:nt,importLoading:ot,selectedFile:dt,importResult:ct,bulkStatus:mt,newValues:xt,newScores:ut,editingItem:ht,editingScore:pt}=R,{status:gt,priority:yt,complexity:ft,impact:bt,effortEstimateLabel:jt,unit:vt,target:kt,department:Nt,assignedTo:wt,labels:_t,responsible:Ct,accountable:Tt,consulted:At,informed:St,trained:Dt}=F,{activeTimers:Et,intervals:Mt,stopTimerTaskId:Lt,stopTimerMemo:Pt,stopTimerStartTime:It,stopTimerEndTime:$t,stopTimerTotalTime:Ut}=W,{historyToDelete:Rt,checklistWarningTask:Ot,checklistCompletion:Ft}=B,[Ht,Wt]=(0,a.useState)({title:"",department:"",taskCategory:"",project:"",startDate:"",dueDate:"",withoutDueDate:!1,assignedTo:[],status:"",description:"",responsible:[],accountable:[],consulted:[],informed:[],trained:[],labels:"",milestones:"",priority:"",complexity:"",impact:"",unit:"",target:"",effortEstimateLabel:"",makePrivate:!1,share:!1,repeat:!1,isDependent:!1,validationBy:"",effortLabel:"",checklist:"",workflowGuide:"",timeEstimateHours:0,timeEstimateMinutes:0}),zt=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{console.log("\ud83d\udd0d fetchAllData called with:",{skipLoadingState:e,page:t,append:s,searchParams:l}),e||(0,a.startTransition)(()=>{te({loading:!0})});let r="http://localhost:5000/api/tasks";if(D){const e=D.permissions&&D.permissions.includes("view_own_tasks"),s=new URLSearchParams({user_id:D.id,role:D.role,employee_name:D.name||"",..."admin"===D.role?{all:"true"}:{limit:100,page:t},...l.search&&{search:l.search},...l.status&&{status:l.status},...l.priority&&{priority:l.priority},...l.complexity&&{complexity:l.complexity},...l.impact&&{impact:l.impact},...l.effortEstimateLabel&&{effortEstimateLabel:l.effortEstimateLabel},...l.unit&&{unit:l.unit},...l.target&&{target:l.target},...l.labels&&{labels:l.labels},...l.assignedTo&&{assignedTo:l.assignedTo},...l.assignedTo&&{assigned_to:l.assignedTo},...l.department&&{department:l.department}});e&&!D.name&&console.warn("\u26a0\ufe0f User has view_own_tasks permission but no name - this will cause API error"),r+=`?${s.toString()}`}console.log("\ud83d\udd0d Final tasks URL:",r);const i={};if(D){i["user-role"]=D.role||"employee";const e="admin"===D.role?["all"]:D.permissions||[];i["user-permissions"]=JSON.stringify(e),i["user-name"]=D.name||""}const[n,o,d,c]=await Promise.all([T(fetch(r,{headers:i})),fetch("http://localhost:5000/api/departments"),fetch("http://localhost:5000/api/employees?all=true"),fetch("http://localhost:5000/api/labels")]);if(n.ok&&o.ok&&d.ok&&c.ok){const e=await n.json(),l=await o.json(),r=await d.json(),i=await c.json();(0,a.startTransition)(()=>{const a=Array.isArray(e.data)?e.data:Array.isArray(e)?e:[];if(te({tasks:s?[...oe,...a]:a,departments:Array.isArray(l.data)?l.data:Array.isArray(l)?l:[],employees:Array.isArray(r.data)?r.data:Array.isArray(r)?r:[],labels:Array.isArray(i)?i:[]}),e.pagination){const s=100*t<e.pagination.total;se({totalTasks:e.pagination.total,currentPage:t,hasMoreTasks:s,loadingMore:!1})}else"admin"===(null===D||void 0===D?void 0:D.role)&&se({totalTasks:a.length,hasMoreTasks:!1,loadingMore:!1})})}else(0,a.startTransition)(()=>{te({error:"Failed to fetch data"})})}catch(ue){console.error("Error fetching data:",ue),(0,a.startTransition)(()=>{te({error:"Failed to fetch data"})})}finally{e||(0,a.startTransition)(()=>{te({loading:!1})})}},Bt=async()=>{try{let e="http://localhost:5000/api/tasks";if(D){e+=`?${new URLSearchParams({user_id:D.id,role:D.role,employee_name:D.name||"",limit:100,page:1}).toString()}`}const t={};if(D){t["user-role"]=D.role||"employee";const e="admin"===D.role?["all"]:D.permissions||[];t["user-permissions"]=JSON.stringify(e),t["user-name"]=D.name||""}const s=await T(fetch(e,{headers:t}));if(s.ok){const e=await s.json();(0,a.startTransition)(()=>{te({tasks:Array.isArray(e.data)?e.data:Array.isArray(e)?e:[]})})}}catch(ue){console.error("Error refreshing tasks:",ue)}},Vt=(0,a.useRef)(null),Yt=(0,a.useCallback)(async e=>{console.log("\ud83d\udd0d Search triggered with value:",e),se({searchTerm:e}),Vt.current&&clearTimeout(Vt.current),Vt.current=setTimeout(async()=>{se({currentPage:1,hasMoreTasks:!0});const t={search:e,status:gt||"",priority:yt||"",complexity:ft||"",impact:bt||"",effortEstimateLabel:jt||"",unit:vt||"",target:kt||"",labels:_t||"",assignedTo:Qt(),department:Nt||""};console.log("\ud83d\udd0d Search params:",t),await zt(!0,1,!1,t)},500)},[gt,yt,ft,bt,jt,vt,kt,_t,wt,Nt]);(0,a.useEffect)(()=>{if(D){const e=Xt();zt(!1,1,!1,e),Kt()}},[D]),(0,a.useEffect)(()=>{D&&Gt.length},[he,gt,yt,ft,bt,jt,vt,kt,Nt,wt,_t,Ct,Tt,At,St,Dt]),(0,a.useEffect)(()=>{if(oe.length>0){const e={};(oe||[]).forEach(t=>{if(t.timer_started_at&&!Mt[t.id]){const s=setInterval(()=>{ie(e=>({...e}))},1e3);e[t.id]=s}}),Object.keys(e).length>0&&ie(t=>({...t,intervals:{...t.intervals,...e}}))}},[oe,Mt]),(0,a.useEffect)(()=>()=>{Object.values(Mt).forEach(e=>{clearInterval(e)})},[Mt]);const Jt=async e=>{try{try{const t=await fetch(`http://localhost:5000/api/tasks/${e}/attachments`);if(t.ok){const e=await t.json();qe(e.attachments||[])}else qe([])}catch(ue){console.error("Error loading task attachments:",ue),qe([])}Ke(e=>Array.isArray(e)&&e.length>0?e:[{id:1,user:"Junaid",comment:"Started working on this task",timestamp:"2025-08-07 10:30"},{id:2,user:"Admin",comment:"Please review the requirements",timestamp:"2025-08-07 11:00"}]),Qe(e=>Array.isArray(e)&&e.length>0?e:[{id:1,title:"Research requirements",completed:!0},{id:2,title:"Create wireframes",completed:!1},{id:3,title:"Implement frontend",completed:!1}]),Ze("Important notes about this task implementation...");const[t,s]=await Promise.allSettled([A(e,fetch(`http://localhost:5000/api/tasks/${e}/timesheet`)),A(e,fetch(`http://localhost:5000/api/tasks/${e}/history`))]);if("fulfilled"===t.status&&t.value.ok){const e=await t.value.json();Xe(e);const s=e.reduce((e,t)=>{var s,a;return e+(null!==(s=null!==(a=t.hours_logged_seconds)&&void 0!==a?a:t.hours_logged)&&void 0!==s?s:0)},0);setTaskTimesheetTotal(s)}else console.error("Failed to load task timesheet"),Xe([]),setTaskTimesheetTotal(0);if("fulfilled"===s.status&&s.value.ok){const e=await s.value.json();et(e)}else console.error("Failed to load task history"),et([])}catch(ue){console.error("Error loading task details:",ue)}};(0,a.useEffect)(()=>{pe&&ke&&Jt(pe.id)},[pe,ke]);const[Gt,qt]=(0,a.useState)([]),Kt=async()=>{try{let e="http://localhost:5000/api/tasks";if(D){e+=`?${new URLSearchParams({user_id:D.id,role:D.role,employee_name:D.name||"",limit:1e4,page:1}).toString()}`}const t={};if(D){t["user-role"]=D.role||"employee";const e="admin"===D.role?["all"]:D.permissions||[];t["user-permissions"]=JSON.stringify(e),t["user-name"]=D.name||""}const s=await fetch(e,{headers:t});if(s.ok){const e=await s.json(),t=Array.isArray(e.data)?e.data:Array.isArray(e)?e:[];qt(t)}}catch(ue){console.error("Error fetching all tasks for dashboard:",ue)}},Qt=()=>{try{if(!Array.isArray(wt)||0===wt.length)return"";if(!Array.isArray(ce)||0===ce.length)return"";const e=new Map((ce||[]).map(e=>[e.id,e.name]));return wt.map(t=>{var s;const a="object"===typeof t?null!==(s=t.value)&&void 0!==s?s:t.id:t;let l=e.get(a);return l||"object"!==typeof t||"string"!==typeof t.label||(l=t.label.split(" (")[0]),l}).filter(Boolean).join(",")}catch(e){return""}},Xt=()=>({search:he||"",status:gt||"",priority:yt||"",complexity:ft||"",impact:bt||"",effortEstimateLabel:jt||"",unit:vt||"",target:kt||"",labels:_t||"",assignedTo:Qt(),department:Nt||""}),Zt=()=>Array.isArray(oe)?oe:[],es=Zt(),ts=Array.isArray(Gt)?Gt:[],ss=(0,a.useMemo)(()=>es.length>0&&es.every(e=>ge.has(e.id)),[ge,es]),as=(ts||[]).filter(e=>"Completed"===e.status).length,ls=(ts||[]).filter(e=>"In Progress"===e.status).length,rs=(ts||[]).filter(e=>!!e.due_date&&(new Date(e.due_date)<new Date&&"Completed"!==e.status)).length,is=e=>{try{if(se({selectedTask:e,showDetailModal:!0}),e.checklist_completed)try{const t=JSON.parse(e.checklist_completed);setChecklistCompletion(s=>({...s,[e.id]:t}))}catch(t){console.error("Error parsing checklist completion:",t)}Jt(e.id),fetch(`http://localhost:5000/api/tasks/${e.id}/history`).then(e=>e.json()).then(e=>et(e)).catch(e=>console.error("History API error:",e))}catch(ue){console.error("Error in handleTaskClick:",ue)}},ns=()=>{rt(null),it("")},os=()=>{var e,t;Je&&Ge.trim()&&(e=Je,t=Ge.trim(),Ke(s=>(Array.isArray(s)?s:[]).map(s=>s.id===e?{...s,comment:t}:s)),ns())},ds=()=>{at(null),lt("")},cs=()=>{var e,t;Ve&&Ye.trim()&&(e=Ve,t=Ye.trim(),Qe(s=>(Array.isArray(s)?s:[]).map(s=>s.id===e?{...s,title:t}:s)),ds())},ms=(e,t)=>{if(!e)return[];return e.split(",").map(e=>e.trim()).filter(e=>e).map(e=>{let s=t.find(t=>t.name===e);return s||(s=t.find(t=>{var s;return(null===(s=t.name)||void 0===s?void 0:s.toLowerCase())===e.toLowerCase()})),s||(s=t.find(t=>{var s;return null===(s=t.name)||void 0===s?void 0:s.toLowerCase().includes(e.toLowerCase())})),s?{value:s.id,label:`${s.name} (${s.employee_id})`}:{value:`fallback-${e.replace(/\s+/g,"-").toLowerCase()}`,label:`${e}`}}).filter(Boolean)},xs=e=>e.map(e=>e.label.split(" (")[0]).join(", "),us=()=>oe.find(e=>e.timer_started_at&&e.assigned_to&&e.assigned_to.includes((null===D||void 0===D?void 0:D.name)||"Admin")),{calculateTaskScore:hs}=(0,_.j)(),ps=e=>hs(e),gs=e=>e>=80?"Critical":e>=65?"High":e>=50?"Medium":e>=35?"Low":"Very Low",ys=e=>e>=80?"bg-red-100 text-red-800":e>=65?"bg-orange-100 text-orange-800":e>=50?"bg-yellow-100 text-yellow-800":e>=35?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600",{getScoreBreakdown:fs}=(0,_.j)(),bs=async e=>{const t=oe.find(t=>t.id===e);var s,a;if(t)if(Ds(t))try{const t=await(s="Start",a=fetch(`http://localhost:5000/api/tasks/${e}/start-timer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_name:(null===D||void 0===D?void 0:D.name)||"Admin",user_id:(null===D||void 0===D?void 0:D.id)||1})}),C.measureApiCall(`Timer ${s}`,a));if(t.ok){const t=Date.now(),s=setInterval(()=>{ie(e=>({...e}))},1e3);ie(t=>({...t,intervals:{...t.intervals,[e]:s}})),ie(s=>({...s,activeTimers:{...s.activeTimers,[e]:t}})),Bt(),pe&&pe.id===e&&(Jt(e),fetch(`http://localhost:5000/api/tasks/${e}/history`).then(e=>e.json()).then(e=>et(e)).catch(e=>console.error("Error refreshing history:",e)))}else{const e=await t.json();"You already have an active timer"===e.error?alert(`\u26a0\ufe0f ${e.message}\n\nPlease stop your current timer before starting a new one.`):"Access denied"===e.error?alert(`\u274c ${e.message}\n\nYou can only start timers on tasks assigned to you.`):"Timer already running"===e.error?alert(`\u23f1\ufe0f ${e.message}\n\nThis task already has an active timer.`):alert(`\u274c Failed to start timer: ${e.message||"Unknown error"}`)}}catch(ue){console.error("Error starting timer:",ue),alert("\u274c Failed to start timer: Network error")}else alert("You do not have permission to start timer on this task.");else alert("Task not found")},js=e=>{const t=oe.find(t=>t.id===e);if(!t||!t.timer_started_at)return;const s=new Date;let a;if(Et[e])a=new Date(Et[e]);else{const e=Math.floor((Date.now()-new Date(t.timer_started_at).getTime())/1e3);a=new Date(s.getTime()-1e3*e)}const l=Math.floor((s-a)/1e3);ie({stopTimerTaskId:e,stopTimerStartTime:a.toLocaleTimeString("en-US",{hour12:!1}),stopTimerEndTime:s.toLocaleTimeString("en-US",{hour12:!1}),stopTimerTotalTime:`${Math.floor(l/3600)}h ${Math.floor(l%3600/60)}m`,stopTimerMemo:""}),se({showStopTimerModal:!0})},vs=async e=>{const t=oe.find(t=>t.id===e);t?Es(t)?js(e):alert("You do not have permission to stop timer on this task."):alert("Task not found")},ks=e=>{if(!e.checklist||""===e.checklist.trim())return!0;const t=e.checklist.split("\n").filter(e=>""!==e.trim());if(0===t.length)return!0;if((Ft[e.id]||[]).length===t.length)return!0;if(e.checklist_completed){return JSON.parse(e.checklist_completed).length===t.length}return!1},Ns=e=>{if(!e.unit)return!1;const t=parseFloat(e.unit);return!isNaN(t)&&t>0},ws=e=>pe&&e.id===pe.id?ks(e)&&Ns(pe):ks(e)&&Ns(e),_s=(e,t)=>(Ft[e]||[]).includes(t),Cs=e=>{const t=Math.floor(e/3600),s=Math.floor(e%3600/60),a=e%60;return`${t.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},Ts=e=>{const t=Et[e.id],s=e.timer_started_at;let a=0;if(t)a=Math.floor((Date.now()-t)/1e3);else if(s){const e=new Date(s);a=Math.floor((Date.now()-e)/1e3)}return Cs(t||s?a:e.logged_seconds||0)},As=e=>{if(!D||!D.permissions)return!1;if(D.permissions.includes("all")||D.permissions.includes("edit_tasks"))return!0;if(D.permissions.includes("edit_own_tasks")){var t;return(e.assigned_to||"").toLowerCase().includes((null===(t=D.name)||void 0===t?void 0:t.toLowerCase())||"")}return!1},Ss=e=>{if(!D||!D.permissions)return!1;if(D.permissions.includes("all")||D.permissions.includes("delete_tasks"))return!0;if(D.permissions.includes("delete_own_tasks")){var t;return(e.assigned_to||"").toLowerCase().includes((null===(t=D.name)||void 0===t?void 0:t.toLowerCase())||"")}return!1},Ds=e=>{if(!D||!D.permissions)return!1;if(D.permissions.includes("all")||D.permissions.includes("start_timer"))return!0;if(D.permissions.includes("start_own_timer")){var t;return(e.assigned_to||"").toLowerCase().includes((null===(t=D.name)||void 0===t?void 0:t.toLowerCase())||"")}return!1},Es=e=>{if(!D||!D.permissions)return!1;if(D.permissions.includes("all")||D.permissions.includes("stop_timer"))return!0;if(D.permissions.includes("stop_own_timer")){var t;return(e.assigned_to||"").toLowerCase().includes((null===(t=D.name)||void 0===t?void 0:t.toLowerCase())||"")}return!1},Ms=async(e,t)=>{try{const s=oe.find(t=>t.id===e);if(!s)return void alert("Task not found");const l=s.status;if(l===t)return;const r=((e,t)=>{if("Completed"===t&&!ws(e)){let t="Cannot complete task: ";const s=[];return ks(e)||s.push("all checklist items must be completed"),Ns(e)||s.push("unit value must be set"),t+=s.join(" and "),{isValid:!1,message:t}}return{isValid:!0}})(s,t);if(!r.isValid)return void alert(r.message);const i=await fetch(`http://localhost:5000/api/tasks/${e}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t,user_name:(null===D||void 0===D?void 0:D.name)||"Admin",user_id:(null===D||void 0===D?void 0:D.id)||1,old_status:l})});if(i.ok)te({tasks:oe.map(s=>s.id===e?{...s,status:t}:s)}),pe&&pe.id===e&&(se({selectedTask:{...pe,status:t}}),(0,a.startTransition)(()=>{Jt(e)}),fetch(`http://localhost:5000/api/tasks/${e}/history`).then(e=>e.json()).then(e=>et(e)).catch(e=>console.error("Error refreshing history:",e))),console.log(`Task ${e} status updated from ${l} to ${t}`);else{const e=await i.json();alert(e.error||"Failed to update task status")}}catch(ue){console.error("Error updating task status:",ue),alert("Failed to update task status")}},Ls=(0,a.useCallback)(()=>{const e=Zt(),t=new Set(e.map(e=>e.id)),s=e.length>0&&e.every(e=>ge.has(e.id));P(e=>({...e,selectedTasks:s?new Set:t}))},[ge,Zt]),Ps=()=>{se({showModal:!1}),le({editingTask:null}),Wt({title:"",department:"",taskCategory:"",project:"",startDate:"",dueDate:"",withoutDueDate:!1,assignedTo:[],status:"",description:"",responsible:[],accountable:[],consulted:[],informed:[],trained:[],labels:"",milestones:"",priority:"",complexity:"",impact:"",unit:"",target:"",effortEstimateLabel:"",timeEstimateHours:0,timeEstimateMinutes:0,makePrivate:!1,share:!1,repeat:!1,isDependent:!1,validationBy:"",effortLabel:"",checklist:"",workflowGuide:""})},Is=e=>{switch(e){case"Completed":return"bg-green-100 text-green-800";case"In Progress":return"bg-blue-100 text-blue-800";case"Pending":return"bg-yellow-100 text-yellow-800";case"On Hold":return"bg-orange-100 text-orange-800";case"Cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},$s=e=>{switch(e){case"High":return"bg-red-100 text-red-800";case"Medium":return"bg-yellow-100 text-yellow-800";case"Low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},Us=e=>{switch(e){case"High":return"bg-purple-100 text-purple-800";case"Medium":return"bg-orange-100 text-orange-800";case"Low":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},Rs=e=>{switch(e){case"Compliance & Risk":return"bg-red-100 text-red-800";case"Revenue Growth":return"bg-green-100 text-green-800";case"Customer Experience":return"bg-blue-100 text-blue-800";case"Cost Reduction":return"bg-purple-100 text-purple-800";case"Efficiency & Process":return"bg-orange-100 text-orange-800";case"Innovation & Development":return"bg-indigo-100 text-indigo-800";case"Knowledge & Training":return"bg-teal-100 text-teal-800";default:return"bg-gray-100 text-gray-800"}};return xe?(0,S.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,S.jsx)("div",{className:"text-lg",children:"Loading tasks..."})}):ue?(0,S.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,S.jsx)("div",{className:"text-red-600",children:ue})}):(console.log("\ud83c\udfa8 Tasks component rendering..."),(0,S.jsxs)("div",{className:"space-y-6",children:[(0,S.jsxs)("div",{className:"flex justify-between items-center",children:[(0,S.jsx)("div",{children:(0,S.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Tasks"})}),(0,S.jsxs)("div",{className:"flex space-x-3",children:[(0,S.jsxs)(j.A,{variant:"secondary",onClick:()=>se({showColumnModal:!0}),children:[(0,S.jsx)(l.A,{className:"w-4 h-4 mr-2"}),"Customize Columns"]}),(0,S.jsxs)(j.A,{variant:"secondary",onClick:()=>se({showTaskCalculationModal:!0}),children:[(0,S.jsx)(r.A,{className:"w-4 h-4 mr-2"}),"Task Calculation"]}),(0,S.jsxs)(j.A,{variant:"secondary",onClick:()=>se({showFilterModal:!0}),children:[(0,S.jsx)(r.A,{className:"w-4 h-4 mr-2"}),"Filters"]}),(0,S.jsxs)(j.A,{variant:"secondary",onClick:()=>se({showExportModal:!0}),children:[(0,S.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"Export Data"]}),(0,S.jsxs)(j.A,{variant:"secondary",onClick:()=>se({showImportModal:!0}),children:[(0,S.jsx)(n.A,{className:"w-4 h-4 mr-2"}),"Import"]}),(0,S.jsxs)(j.A,{variant:"secondary",onClick:()=>se({showUpdateModal:!0}),children:[(0,S.jsx)(o.A,{className:"w-4 h-4 mr-2"}),"Update Tasks"]}),!(!D||!D.permissions)&&(D.permissions.includes("all")||D.permissions.includes("create_tasks")||"admin"===D.role)&&(0,S.jsxs)(j.A,{variant:"primary",onClick:()=>{le({editingTask:null});const e=null!==D&&void 0!==D&&D.name?[{value:D.id||"current-user",label:`${D.name} (${D.employee_id||D.id||"current-user"})`}]:[];Wt({title:"",department:"",taskCategory:"",project:"",startDate:"",dueDate:"",withoutDueDate:!1,assignedTo:e,status:"",description:"",responsible:[],accountable:[],consulted:[],informed:[],trained:[],labels:"",milestones:"",priority:"",complexity:"",impact:"",unit:"",target:"",effortEstimateLabel:"",timeEstimateHours:0,timeEstimateMinutes:0,makePrivate:!1,share:!1,repeat:!1,isDependent:!1,validationBy:"",effortLabel:"",checklist:"",workflowGuide:""}),se({showModal:!0})},children:[(0,S.jsx)(d.A,{className:"w-4 h-4 mr-2"}),"Add Task"]})]})]}),(0,S.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,S.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)(c.A,{className:"w-8 h-8 text-purple-600 mr-3"}),(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:ts.length}),(0,S.jsxs)("div",{className:"text-sm text-gray-600",children:["Total Tasks",Le&&"admin"!==(null===D||void 0===D?void 0:D.role)&&(0,S.jsxs)("span",{className:"text-blue-600 ml-1",children:["(",Ee," total)"]})]})]})]})}),(0,S.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)(m.A,{className:"w-8 h-8 text-green-600 mr-3"}),(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:as}),(0,S.jsx)("div",{className:"text-sm text-gray-600",children:"Completed"})]})]})}),(0,S.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)(x.A,{className:"w-8 h-8 text-blue-600 mr-3"}),(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:ls}),(0,S.jsx)("div",{className:"text-sm text-gray-600",children:"In Progress"})]})]})}),(0,S.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)(u.A,{className:"w-8 h-8 text-red-600 mr-3"}),(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:rs}),(0,S.jsx)("div",{className:"text-sm text-gray-600",children:"Overdue"})]})]})})]}),"employee"===(null===D||void 0===D?void 0:D.role)&&us()&&(0,S.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)(u.A,{className:"w-5 h-5 text-yellow-600 mr-2"}),(0,S.jsxs)("div",{className:"flex-1",children:[(0,S.jsxs)("p",{className:"text-sm font-medium text-yellow-800",children:['You have an active timer on task: "',us().title,'"']}),(0,S.jsx)("p",{className:"text-xs text-yellow-700 mt-1",children:"You can only have one active timer at a time. Stop the current timer before starting a new one."})]}),(0,S.jsx)("button",{onClick:()=>vs(us().id),className:"px-3 py-1 bg-yellow-600 text-white text-xs rounded hover:bg-yellow-700 transition-colors",children:"Stop Timer"})]})}),(0,S.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,S.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,S.jsx)("div",{className:"flex-1",children:(0,S.jsxs)("div",{className:"relative",children:[(0,S.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,S.jsx)("input",{type:"text",placeholder:"Search tasks...",value:he,onChange:e=>{console.log("\ud83d\udd0d Input onChange triggered:",e.target.value),Yt(e.target.value)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),ge.size>0&&(0,S.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,S.jsxs)("div",{className:"text-sm text-gray-600",children:[ge.size," task(s) selected"]}),(0,S.jsx)("div",{className:"relative inline-block text-left",children:(0,S.jsxs)("div",{className:"flex gap-2",children:[(0,S.jsxs)(j.A,{variant:"danger",onClick:async()=>{if(0===ge.size)return;const e=`Are you sure you want to delete ${ge.size} selected task(s)?`;if(confirm(e))try{const e=Array.from(ge),t=await fetch("http://localhost:5000/api/tasks/bulk",{method:"DELETE",headers:{"Content-Type":"application/json","user-role":(null===D||void 0===D?void 0:D.role)||"admin","user-permissions":JSON.stringify(["all"]),"user-name":(null===D||void 0===D?void 0:D.name)||"Admin"},body:JSON.stringify({ids:e})});if(t.ok){const e=await t.json();(0,a.startTransition)(()=>{zt()}),P(e=>({...e,selectedTasks:new Set})),alert(e.message)}else{const e=await t.json();403===t.status?alert(`Access denied: ${e.error}`):alert(e.error||"Failed to delete tasks")}}catch(ue){alert("Failed to delete tasks: "+ue.message)}},className:"flex items-center space-x-2",children:[(0,S.jsx)(p.A,{className:"w-4 h-4"}),(0,S.jsx)("span",{children:"Delete"})]}),(0,S.jsx)(j.A,{variant:"secondary",onClick:()=>se({showBulkStatusModal:!0}),className:"flex items-center space-x-2",children:(0,S.jsx)("span",{children:"Actions"})})]})})]})]})}),Ne&&(0,S.jsx)("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:(0,S.jsxs)("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md p-6",children:[(0,S.jsx)("div",{className:"text-lg font-semibold mb-4",children:"Change Status for Selected Tasks"}),(0,S.jsxs)("div",{className:"space-y-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Status"}),(0,S.jsxs)("select",{value:mt,onChange:e=>le({bulkStatus:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),(0,S.jsx)("option",{value:"Pending",children:"Pending"}),(0,S.jsx)("option",{value:"In Progress",children:"In Progress"}),(0,S.jsx)("option",{value:"Completed",children:"Completed"}),(0,S.jsx)("option",{value:"On Hold",children:"On Hold"}),(0,S.jsx)("option",{value:"Cancelled",children:"Cancelled"})]})]}),(0,S.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,S.jsx)(j.A,{variant:"secondary",onClick:()=>{se({showBulkStatusModal:!1}),le({bulkStatus:""})},children:"Cancel"}),(0,S.jsx)(j.A,{variant:"primary",onClick:async()=>{if(0===ge.size||!mt)return;const e=`Change status of ${ge.size} selected task(s) to "${mt}"?`;if(confirm(e))try{const e=Array.from(ge).map(e=>fetch(`http://localhost:5000/api/tasks/${e}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:mt,user_name:(null===D||void 0===D?void 0:D.name)||"Admin",user_id:(null===D||void 0===D?void 0:D.id)||1})})),t=await Promise.all(e);if(!t.every(e=>e.ok))throw new Error("One or more updates failed");const s={};D&&(s["user-role"]=D.role||"employee",s["user-permissions"]=JSON.stringify("admin"===D.role?["all"]:D.permissions||[]));let a="http://localhost:5000/api/tasks";if(D){a+=`?${new URLSearchParams({user_id:D.id,role:D.role,employee_name:D.name||""}).toString()}`}const l=await fetch(a,{headers:s});if(l.ok){const e=await l.json();te({tasks:Array.isArray(e.data)?e.data:Array.isArray(e)?e:[]})}se({showBulkStatusModal:!1}),le({bulkStatus:""}),P(e=>({...e,selectedTasks:new Set})),pe&&fetch(`http://localhost:5000/api/tasks/${pe.id}/history`).then(e=>e.json()).then(e=>et(e)).catch(e=>console.error("Error refreshing history:",e)),alert("Status updated for selected tasks")}catch(ue){console.error("Bulk status change error:",ue),alert("Failed to change status for selected tasks")}},children:"Save"})]})]})]})}),(0,S.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,S.jsx)("div",{className:"overflow-x-auto",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,S.jsx)("thead",{className:"bg-gray-50",children:(0,S.jsx)("tr",{children:K.map(e=>{var t;return Y[e]&&(0,S.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:`${G[e]}px`},children:"checkbox"===e?(0,S.jsx)("input",{type:"checkbox",className:"rounded border-gray-300",checked:ss,onChange:Ls}):(null===(t=[{key:"checkbox",name:"Select"},{key:"id",name:"ID"},{key:"title",name:"Title"},{key:"task",name:"Task"},{key:"department",name:"Department"},{key:"task_category",name:"Task Category"},{key:"project",name:"Project"},{key:"start_date",name:"Start Date"},{key:"due_date",name:"Due Date"},{key:"without_due_date",name:"Without Due Date"},{key:"assigned_to",name:"Assigned To"},{key:"assignedTo",name:"Assigned To"},{key:"status",name:"Status"},{key:"description",name:"Description"},{key:"responsible",name:"Responsible"},{key:"accountable",name:"Accountable"},{key:"consulted",name:"Consulted"},{key:"informed",name:"Informed"},{key:"trained",name:"Trained"},{key:"labels",name:"Labels"},{key:"label_id",name:"Label ID"},{key:"milestones",name:"Milestones"},{key:"priority",name:"Priority"},{key:"complexity",name:"Complexity"},{key:"impact",name:"Impact"},{key:"unit",name:"Unit"},{key:"target",name:"Target"},{key:"effort_estimate_label",name:"Effort Estimate"},{key:"effortEstimate",name:"Effort Estimate"},{key:"time_estimate",name:"Time Estimate"},{key:"make_private",name:"Make Private"},{key:"share",name:"Share"},{key:"repeat",name:"Repeat"},{key:"is_dependent",name:"Is Dependent"},{key:"validation_by",name:"Validation By"},{key:"effort_label",name:"Effort Label"},{key:"checklist",name:"Checklist"},{key:"workflow_guide",name:"Workflow Guide"},{key:"timer_started_at",name:"Timer Started At"},{key:"logged_seconds",name:"Logged Seconds"},{key:"timer",name:"Timer / Time"},{key:"created_at",name:"Created At"},{key:"updated_at",name:"Updated At"},{key:"score",name:"Score"},{key:"actions",name:"Actions"}].find(t=>t.key===e))||void 0===t?void 0:t.name)||e},e)})})}),(0,S.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===es.length?(0,S.jsx)("tr",{children:(0,S.jsx)("td",{colSpan:Object.values(Y).filter(Boolean).length,className:"px-6 py-4 text-center text-gray-500",children:"No tasks found"})}):es.map(e=>(0,S.jsx)("tr",{className:"hover:bg-gray-50",children:K.map(t=>{var s,l,r,i;return Y[t]&&(0,S.jsxs)("td",{className:"px-6 py-4",style:{width:`${G[t]}px`},children:["checkbox"===t&&(0,S.jsx)("input",{type:"checkbox",className:"rounded border-gray-300 cursor-pointer",checked:ge.has(e.id),onChange:t=>{var s;t.stopPropagation(),s=e.id,P(e=>{const t=new Set(e.selectedTasks);return t.has(s)?t.delete(s):t.add(s),{...e,selectedTasks:t}})},style:{pointerEvents:"auto",zIndex:10}}),"id"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.id}),"title"===t&&(0,S.jsxs)("div",{children:[(0,S.jsx)("button",{onClick:()=>is(e),className:"text-sm font-medium text-gray-900 hover:text-blue-600 cursor-pointer text-left",children:e.title}),e.description&&(0,S.jsx)("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:e.description}),e.checklist&&(0,S.jsx)("div",{className:"flex items-center space-x-1 mt-1",children:ks(e)?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(m.A,{className:"w-3 h-3 text-green-500"}),(0,S.jsx)("span",{className:"text-xs text-green-600",children:"Checklist complete"})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(u.A,{className:"w-3 h-3 text-yellow-500"}),(0,S.jsx)("span",{className:"text-xs text-yellow-600",children:"Checklist incomplete"})]})}),!Ns(e)&&(0,S.jsxs)("div",{className:"flex items-center space-x-1 mt-1",children:[(0,S.jsx)(u.A,{className:"w-3 h-3 text-red-500"}),(0,S.jsx)("span",{className:"text-xs text-red-600",children:"Unit required"})]})]}),"task"===t&&(0,S.jsxs)("div",{children:[(0,S.jsx)("button",{onClick:()=>is(e),className:"text-sm font-medium text-gray-900 hover:text-blue-600 cursor-pointer text-left",children:e.title}),e.description&&(0,S.jsx)("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:e.description}),e.checklist&&(0,S.jsx)("div",{className:"flex items-center space-x-1 mt-1",children:ks(e)?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(m.A,{className:"w-3 h-3 text-green-500"}),(0,S.jsx)("span",{className:"text-xs text-green-600",children:"Checklist complete"})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(u.A,{className:"w-3 h-3 text-yellow-500"}),(0,S.jsx)("span",{className:"text-xs text-yellow-600",children:"Checklist incomplete"})]})}),!Ns(e)&&(0,S.jsxs)("div",{className:"flex items-center space-x-1 mt-1",children:[(0,S.jsx)(u.A,{className:"w-3 h-3 text-red-500"}),(0,S.jsx)("span",{className:"text-xs text-red-600",children:"Unit required"})]})]}),"department"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.department||"-"}),"task_category"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.task_category||"-"}),"project"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.project||"-"}),"start_date"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.start_date||"-"}),"due_date"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.due_date||"-"}),"without_due_date"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.without_due_date?"Yes":"No"}),"assigned_to"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.assigned_to||"-"}),"assignedTo"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.assigned_to||"-"}),"status"===t&&(0,S.jsx)("div",{children:"employee"===(null===D||void 0===D||null===(s=D.role)||void 0===s?void 0:s.toLowerCase())||"admin"===(null===D||void 0===D||null===(l=D.role)||void 0===l?void 0:l.toLowerCase())||"manager"===(null===D||void 0===D||null===(r=D.role)||void 0===r?void 0:r.toLowerCase())||"team lead"===(null===D||void 0===D||null===(i=D.role)||void 0===i?void 0:i.toLowerCase())?(0,S.jsxs)("div",{className:"relative",children:[(0,S.jsxs)("select",{value:e.status,onChange:t=>Ms(e.id,t.target.value),className:"text-xs border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"Pending",children:"Pending"}),(0,S.jsx)("option",{value:"In Progress",children:"In Progress"}),(0,S.jsx)("option",{value:"Completed",disabled:!ws(e),className:ws(e)?"":"text-gray-400",children:ws(e)?"Completed":"Completed (Requirements not met)"}),(0,S.jsx)("option",{value:"On Hold",children:"On Hold"}),(0,S.jsx)("option",{value:"Cancelled",children:"Cancelled"})]}),!ws(e)&&"Completed"!==e.status&&(0,S.jsx)("div",{className:"absolute -bottom-6 left-0 text-xs text-red-600 whitespace-nowrap",children:ks(e)||Ns(e)?ks(e)?"Set unit value to complete":"Complete checklist to finish":"Complete checklist & set unit to complete"})]}):(0,S.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Is(e.status)}`,children:e.status})}),"description"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900 truncate max-w-xs",children:e.description||"-"}),"responsible"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.responsible||"-"}),"accountable"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.accountable||"-"}),"consulted"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.consulted||"-"}),"informed"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.informed||"-"}),"trained"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.trained||"-"}),"labels"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.labels||"-"}),"label_id"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.label_id||"-"}),"milestones"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.milestones||"-"}),"priority"===t&&(0,S.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${$s(e.priority)}`,children:e.priority}),"complexity"===t&&(0,S.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Us(e.complexity)}`,children:e.complexity||"-"}),"impact"===t&&(0,S.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Rs(e.impact)}`,children:e.impact||"-"}),"unit"===t&&(0,S.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+(e.unit&&e.unit>0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.unit||"Not set"}),"target"===t&&(0,S.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+(e.target?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"),children:e.target||"-"}),"effort_estimate_label"===t&&(0,S.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+(e.effort_estimate_label?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"),children:e.effort_estimate_label||"-"}),"effortEstimate"===t&&(0,S.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+(e.effort_estimate_label?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"),children:e.effort_estimate_label||"-"}),"time_estimate"===t&&(0,S.jsx)("div",{className:"flex items-center space-x-1",children:(0,S.jsxs)("span",{className:"text-sm text-gray-900",children:[e.time_estimate_hours||0,"h ",e.time_estimate_minutes||0,"m"]})}),"make_private"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.make_private?"Yes":"No"}),"share"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.share?"Yes":"No"}),"repeat"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.repeat?"Yes":"No"}),"is_dependent"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.is_dependent?"Yes":"No"}),"validation_by"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.validation_by||"-"}),"effort_label"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.effort_label||"-"}),"checklist"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.checklist||"-"}),"workflow_guide"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.workflow_guide||"-"}),"timer_started_at"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.timer_started_at||"-"}),"logged_seconds"===t&&(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,S.jsx)(x.A,{className:"w-4 h-4 text-gray-500"}),(0,S.jsx)("span",{className:"text-xs font-mono",children:Ts(e)})]}),Es(e)&&(Et[e.id]||e.timer_started_at)&&(0,S.jsx)("div",{className:"flex space-x-1",children:(0,S.jsx)("button",{onClick:()=>vs(e.id),className:"p-1 bg-red-500 text-white rounded hover:bg-red-600",title:"Stop Timer",children:(0,S.jsx)(g.A,{className:"w-3 h-3"})})}),Ds(e)&&!Et[e.id]&&!e.timer_started_at&&(0,S.jsx)("div",{className:"flex space-x-1",children:(()=>{const t=us(),s=!t;return(0,S.jsx)("button",{onClick:()=>bs(e.id),className:"p-1 rounded "+(s?"bg-green-500 text-white hover:bg-green-600":"bg-gray-300 text-gray-500 cursor-not-allowed"),title:t?`You have an active timer on: ${t.title}`:"Start Timer",disabled:!s,children:(0,S.jsx)(y,{className:"w-3 h-3"})})})()})]}),"timer"===t&&(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,S.jsx)(x.A,{className:"w-4 h-4 text-gray-500"}),(0,S.jsx)("span",{className:"text-xs font-mono",children:Ts(e)})]}),Es(e)&&(Et[e.id]||e.timer_started_at)&&(0,S.jsx)("div",{className:"flex space-x-1",children:(0,S.jsx)("button",{onClick:()=>vs(e.id),className:"p-1 bg-red-500 text-white rounded hover:bg-red-600",title:"Stop Timer",children:(0,S.jsx)(g.A,{className:"w-3 h-3"})})}),Ds(e)&&!Et[e.id]&&!e.timer_started_at&&(0,S.jsx)("div",{className:"flex space-x-1",children:(()=>{const t=us(),s=!t;return(0,S.jsx)("button",{onClick:()=>bs(e.id),className:"p-1 rounded "+(s?"bg-green-500 text-white hover:bg-green-600":"bg-gray-300 text-gray-500 cursor-not-allowed"),title:t?`You have an active timer on: ${t.title}`:"Start Timer",disabled:!s,children:(0,S.jsx)(y,{className:"w-3 h-3"})})})()})]}),"created_at"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.created_at||"-"}),"updated_at"===t&&(0,S.jsx)("span",{className:"text-sm text-gray-900",children:e.updated_at||"-"}),"score"===t&&(0,S.jsxs)("div",{className:"flex flex-col items-center space-y-1",children:[(0,S.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${ys(ps(e))}`,children:ps(e)}),(0,S.jsx)("span",{className:"text-xs text-gray-500",children:gs(ps(e))})]}),"actions"===t&&(0,S.jsx)(N.A,{onSelect:()=>is(e),onEdit:As(e)?()=>(e=>{if(!As(e))return void alert("You do not have permission to edit this task.");le({editingTask:e});const t=(()=>{const t=(e.description||"").trim(),s=(e.assigned_to||"").trim();return t?s&&t.toLowerCase()===s.toLowerCase()||null!==D&&void 0!==D&&D.name&&t.toLowerCase()===D.name.toLowerCase()?"":e.description||"":""})();Wt({title:e.title||"",department:e.department||"",taskCategory:e.task_category||"",project:e.project||"",startDate:e.start_date||"",dueDate:e.due_date||"",withoutDueDate:1===e.without_due_date,assignedTo:ms(e.assigned_to,ce),status:e.status||"",description:t,responsible:ms(e.responsible,ce),accountable:ms(e.accountable,ce),consulted:ms(e.consulted,ce),informed:ms(e.informed,ce),trained:ms(e.trained,ce),labels:e.labels||"",milestones:e.milestones||"",priority:e.priority||"",complexity:e.complexity||"",impact:e.impact||"",unit:e.unit||"",target:e.target||"",effortEstimateLabel:e.effort_estimate_label||"",timeEstimateHours:e.time_estimate_hours||0,timeEstimateMinutes:e.time_estimate_minutes||0,makePrivate:1===e.make_private,share:1===e.share,repeat:1===e.repeat,isDependent:1===e.is_dependent,validationBy:e.validation_by||"",effortLabel:e.effort_label||"",checklist:e.checklist||"",workflowGuide:e.workflow_guide||""}),se({showModal:!0})})(e):void 0,onDelete:Ss(e)?()=>(async e=>{const t=oe.find(t=>t.id===e);if(t)if(Ss(t)){if(confirm("Are you sure you want to delete this task?"))try{const t=await fetch(`http://localhost:5000/api/tasks/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json","user-role":(null===D||void 0===D?void 0:D.role)||"employee","user-permissions":JSON.stringify("admin"===(null===D||void 0===D?void 0:D.role)?["all"]:(null===D||void 0===D?void 0:D.permissions)||[])},body:JSON.stringify({user_role:(null===D||void 0===D?void 0:D.role)||"employee",user_permissions:(null===D||void 0===D?void 0:D.permissions)||[]})});if(t.ok)(0,a.startTransition)(()=>{zt()}),alert("Task deleted successfully");else{const e=await t.json();403===t.status?alert(`Access denied: ${e.error}`):alert(e.error||"Failed to delete task")}}catch(ue){console.error("Error deleting task:",ue),alert("Failed to delete task")}}else alert("You do not have permission to delete this task.");else alert("Task not found")})(e.id):void 0,itemType:"task"})]},t)})},e.id))})]})})}),Le&&"admin"!==(null===D||void 0===D?void 0:D.role)&&(0,S.jsx)("div",{className:"mt-6 flex justify-center",children:(0,S.jsx)(j.A,{onClick:async()=>{if(Pe||!Le||"admin"===(null===D||void 0===D?void 0:D.role))return;se({loadingMore:!0});const e=Me+1,t=Xt();await zt(!0,e,!0,t)},disabled:Pe,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:Pe?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Loading More Tasks..."]}):`Load More Tasks (${Ee-oe.length} remaining)`})}),(0,S.jsx)(b.A,{isOpen:fe,onClose:Ps,title:nt?"Edit Task":"Add Task",size:"xl",children:(0,S.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),console.log("Form data before submission:",Ht),Ht.title.trim())if(Ht.assignedTo&&0!==Ht.assignedTo.length)try{const e=nt?`http://localhost:5000/api/tasks/${nt.id}`:"http://localhost:5000/api/tasks",t=nt?"PUT":"POST",s={...Ht,assigned_to:xs(Ht.assignedTo),responsible:xs(Ht.responsible),accountable:xs(Ht.accountable),consulted:xs(Ht.consulted),informed:xs(Ht.informed),trained:xs(Ht.trained),impact:Ht.impact,complexity:Ht.complexity,unit:Ht.unit,target:Ht.target,effort_estimate_label:Ht.effortEstimateLabel,time_estimate_hours:Ht.timeEstimateHours,time_estimate_minutes:Ht.timeEstimateMinutes};Object.keys(s).forEach(e=>{void 0!==s[e]&&""!==s[e]||delete s[e]}),console.log("Sending task data to API:",s);const l=await fetch(e,{method:t,headers:{"Content-Type":"application/json","user-role":(null===D||void 0===D?void 0:D.role)||"employee","user-permissions":JSON.stringify("admin"===(null===D||void 0===D?void 0:D.role)?["all"]:(null===D||void 0===D?void 0:D.permissions)||[])},body:JSON.stringify(s)});if(l.ok){const e=await l.json();console.log("Task saved successfully:",e),(0,a.startTransition)(()=>{zt()}),Ps()}else{const e=await l.text();console.error("Failed to save task:",e),alert("Failed to save task: "+e)}}catch(ue){console.error("Error saving task:",ue),alert("Failed to save task")}else alert("Please assign the task to at least one person. This ensures the task remains visible and manageable.");else alert("Please enter a task title")},className:"space-y-6",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Task Info"}),(0,S.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),(0,S.jsx)(v.A,{type:"text",placeholder:"e.g. Title",value:Ht.title,onChange:e=>Wt({...Ht,title:e.target.value}),required:!0})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),(0,S.jsxs)("div",{className:"flex",children:[(0,S.jsxs)("select",{value:Ht.department,onChange:e=>Wt({...Ht,department:e.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),(de||[]).map(e=>(0,S.jsx)("option",{value:e.name,children:e.name},e.id))]}),(0,S.jsx)(j.A,{variant:"secondary",className:"rounded-l-none",children:"Add"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Category"}),(0,S.jsxs)("div",{className:"flex",children:[(0,S.jsxs)("select",{value:Ht.taskCategory,onChange:e=>Wt({...Ht,taskCategory:e.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),(0,S.jsx)("option",{value:"Development",children:"Development"}),(0,S.jsx)("option",{value:"Design",children:"Design"}),(0,S.jsx)("option",{value:"Testing",children:"Testing"}),(0,S.jsx)("option",{value:"Documentation",children:"Documentation"})]}),(0,S.jsx)(j.A,{variant:"secondary",className:"rounded-l-none",children:"Add"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),(0,S.jsxs)("div",{className:"flex",children:[(0,S.jsxs)("select",{value:Ht.project,onChange:e=>Wt({...Ht,project:e.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),(0,S.jsx)("option",{value:"Website Redesign",children:"Website Redesign"}),(0,S.jsx)("option",{value:"Mobile App",children:"Mobile App"}),(0,S.jsx)("option",{value:"System Upgrade",children:"System Upgrade"})]}),(0,S.jsx)(j.A,{variant:"secondary",className:"rounded-l-none",children:"Add"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,S.jsxs)("div",{className:"relative",children:[(0,S.jsx)(v.A,{type:"date",value:Ht.startDate,onChange:e=>Wt({...Ht,startDate:e.target.value})}),(0,S.jsx)(x.A,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),(0,S.jsxs)("div",{className:"relative",children:[(0,S.jsx)(v.A,{type:"date",value:Ht.dueDate,onChange:e=>Wt({...Ht,dueDate:e.target.value}),disabled:Ht.withoutDueDate}),(0,S.jsx)(x.A,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"})]}),(0,S.jsx)("div",{className:"mt-2",children:(0,S.jsxs)("label",{className:"flex items-center",children:[(0,S.jsx)("input",{type:"checkbox",checked:Ht.withoutDueDate,onChange:e=>Wt({...Ht,withoutDueDate:e.target.checked}),className:"rounded border-gray-300"}),(0,S.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Without due date"})]})})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),(0,S.jsx)(k.A,{options:(()=>{const e=ce.filter(e=>"Active"===e.status||"active"===e.status||1===e.status);return!e.find(e=>e.name===(null===D||void 0===D?void 0:D.name)||e.employee_id===(null===D||void 0===D?void 0:D.id))&&null!==D&&void 0!==D&&D.name&&e.unshift({id:D.id||"current-user",name:D.name,employee_id:D.employee_id||D.id||"current-user",status:"Active"}),e.map(e=>({value:e.id,label:`${e.name} (${e.employee_id})`}))})(),value:Ht.assignedTo,onChange:e=>Wt({...Ht,assignedTo:e}),placeholder:"Select employees...",searchPlaceholder:"Search employees..."})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,S.jsxs)("select",{value:Ht.status,onChange:e=>Wt({...Ht,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),(0,S.jsx)("option",{value:"Pending",children:"Pending"}),(0,S.jsx)("option",{value:"In Progress",children:"In Progress"}),(0,S.jsx)("option",{value:"Completed",children:"Completed"}),(0,S.jsx)("option",{value:"On Hold",children:"On Hold"}),(0,S.jsx)("option",{value:"Cancelled",children:"Cancelled"})]})]})]}),(0,S.jsxs)("div",{className:"mt-4",children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,S.jsx)("textarea",{value:Ht.description,onChange:e=>Wt({...Ht,description:e.target.value}),rows:"3",placeholder:"Add task description...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"RACIT Matrix"}),(0,S.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Responsible"}),(0,S.jsx)(k.A,{options:ce.filter(e=>"Active"===e.status).map(e=>({value:e.id,label:`${e.name} (${e.employee_id})`})),value:Ht.responsible,onChange:e=>Wt({...Ht,responsible:e}),placeholder:"Select employees...",searchPlaceholder:"Search employees..."})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Accountable"}),(0,S.jsx)(k.A,{options:ce.filter(e=>"Active"===e.status).map(e=>({value:e.id,label:`${e.name} (${e.employee_id})`})),value:Ht.accountable,onChange:e=>Wt({...Ht,accountable:e}),placeholder:"Select employees...",searchPlaceholder:"Search employees..."})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Consulted"}),(0,S.jsx)(k.A,{options:ce.filter(e=>"Active"===e.status).map(e=>({value:e.id,label:`${e.name} (${e.employee_id})`})),value:Ht.consulted,onChange:e=>Wt({...Ht,consulted:e}),placeholder:"Select employees...",searchPlaceholder:"Search employees..."})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Informed"}),(0,S.jsx)(k.A,{options:ce.filter(e=>"Active"===e.status).map(e=>({value:e.id,label:`${e.name} (${e.employee_id})`})),value:Ht.informed,onChange:e=>Wt({...Ht,informed:e}),placeholder:"Select employees...",searchPlaceholder:"Search employees..."})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trained"}),(0,S.jsx)(k.A,{options:ce.filter(e=>"Active"===e.status).map(e=>({value:e.id,label:`${e.name} (${e.employee_id})`})),value:Ht.trained,onChange:e=>Wt({...Ht,trained:e}),placeholder:"Select employees...",searchPlaceholder:"Search employees..."})]})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Other Details"}),(0,S.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Label"}),(0,S.jsxs)("div",{className:"flex",children:[(0,S.jsxs)("select",{value:Ht.labels,onChange:e=>Wt({...Ht,labels:e.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),Object.keys(Z.labels).map(e=>(0,S.jsx)("option",{value:e,children:e},e)),(me||[]).map(e=>(0,S.jsx)("option",{value:e.name,children:e.name},e.id))]}),(0,S.jsx)(j.A,{variant:"secondary",className:"rounded-l-none",children:"Add"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Milestones"}),(0,S.jsxs)("div",{className:"flex",children:[(0,S.jsxs)("select",{value:Ht.milestones,onChange:e=>Wt({...Ht,milestones:e.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),(0,S.jsx)("option",{value:"Phase 1",children:"Phase 1"}),(0,S.jsx)("option",{value:"Phase 2",children:"Phase 2"}),(0,S.jsx)("option",{value:"Phase 3",children:"Phase 3"})]}),(0,S.jsx)(j.A,{variant:"secondary",className:"rounded-l-none",children:"Add"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,S.jsxs)("select",{value:Ht.priority,onChange:e=>Wt({...Ht,priority:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),Object.keys(Z.priority).map(e=>(0,S.jsx)("option",{value:e,children:e},e))]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Estimate"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("input",{type:"number",min:"0",max:"999",value:Ht.timeEstimateHours,onChange:e=>Wt({...Ht,timeEstimateHours:parseInt(e.target.value)||0}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-center focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0"}),(0,S.jsx)("span",{className:"text-sm text-gray-600",children:"hrs"}),(0,S.jsx)("input",{type:"number",min:"0",max:"59",value:Ht.timeEstimateMinutes,onChange:e=>Wt({...Ht,timeEstimateMinutes:parseInt(e.target.value)||0}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-center focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0"}),(0,S.jsx)("span",{className:"text-sm text-gray-600",children:"mins"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complexity"}),(0,S.jsxs)("select",{value:Ht.complexity,onChange:e=>{console.log("Complexity changed to:",e.target.value),Wt({...Ht,complexity:e.target.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),Object.keys(Z.complexity).map(e=>(0,S.jsx)("option",{value:e,children:e},e))]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Impact"}),(0,S.jsxs)("select",{value:Ht.impact,onChange:e=>{console.log("Impact changed to:",e.target.value),Wt({...Ht,impact:e.target.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),Object.keys(Z.impact).map(e=>{return(0,S.jsx)("option",{value:e,title:(t=e,{"Compliance & Risk":"Essential work that must be done to meet legal, regulatory, or contractual obligations and to avoid penalties or security threats.","Revenue Growth":"Tasks that are directly focused on increasing the company's income and sales.","Customer Experience":"Tasks aimed at improving customer satisfaction, loyalty, and retention. This focuses on making existing customers happier.","Cost Reduction":"Tasks that are directly focused on decreasing the company's expenses and improving profitability.","Efficiency & Process":"Work aimed at improving internal workflows, automating manual steps, and saving employee time. It makes the company run smoother.","Innovation & Development":"Tasks related to creating entirely new products, services, or capabilities for the future. This is forward-looking, research-and-development work.","Knowledge & Training":"Internal tasks focused on upskilling the team, creating documentation, and sharing information across the company."}[t]||""),children:e},e);var t})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effort Estimate Label"}),(0,S.jsxs)("select",{value:Ht.effortEstimateLabel,onChange:e=>{console.log("Effort Estimate Label changed to:",e.target.value),Wt({...Ht,effortEstimateLabel:e.target.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),Object.keys(Z.effort).map(e=>(0,S.jsx)("option",{value:e,children:e},e))]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit"}),(0,S.jsx)("input",{type:"number",value:Ht.unit,onChange:e=>Wt({...Ht,unit:e.target.value}),placeholder:"Enter number of units",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target"}),(0,S.jsx)("input",{type:"text",value:Ht.target,onChange:e=>Wt({...Ht,target:e.target.value}),placeholder:"Enter target (optional)",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,S.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,S.jsxs)("label",{className:"flex items-center",children:[(0,S.jsx)("input",{type:"checkbox",checked:Ht.makePrivate,onChange:e=>Wt({...Ht,makePrivate:e.target.checked}),className:"rounded border-gray-300"}),(0,S.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Make Private"})]}),(0,S.jsxs)("label",{className:"flex items-center",children:[(0,S.jsx)("input",{type:"checkbox",checked:Ht.share,onChange:e=>Wt({...Ht,share:e.target.checked}),className:"rounded border-gray-300"}),(0,S.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Share"})]}),(0,S.jsxs)("label",{className:"flex items-center",children:[(0,S.jsx)("input",{type:"checkbox",checked:Ht.repeat,onChange:e=>Wt({...Ht,repeat:e.target.checked}),className:"rounded border-gray-300"}),(0,S.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Repeat"})]}),(0,S.jsxs)("label",{className:"flex items-center",children:[(0,S.jsx)("input",{type:"checkbox",checked:Ht.isDependent,onChange:e=>Wt({...Ht,isDependent:e.target.checked}),className:"rounded border-gray-300"}),(0,S.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Task is dependent on another task"})]})]}),(0,S.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Validation By"}),(0,S.jsx)(v.A,{type:"text",placeholder:"e.g. Validation By",value:Ht.validationBy,onChange:e=>Wt({...Ht,validationBy:e.target.value})})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effort Label"}),(0,S.jsx)(v.A,{type:"text",placeholder:"e.g. Effort Label",value:Ht.effortLabel,onChange:e=>Wt({...Ht,effortLabel:e.target.value})})]})]}),(0,S.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Checklist"}),(0,S.jsx)("textarea",{value:Ht.checklist,onChange:e=>Wt({...Ht,checklist:e.target.value}),rows:"3",placeholder:"Add checklist items, one per line.",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Workflow Guide"}),(0,S.jsx)("textarea",{value:Ht.workflowGuide,onChange:e=>Wt({...Ht,workflowGuide:e.target.value}),rows:"3",placeholder:"Add workflow guidance, one step per line.",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),(0,S.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,S.jsx)(j.A,{variant:"secondary",onClick:Ps,children:"Cancel"}),(0,S.jsx)(j.A,{variant:"primary",type:"submit",children:"Save & Add More"}),(0,S.jsx)(j.A,{variant:"primary",type:"submit",children:"Save Task"})]})]})}),(0,S.jsx)(b.A,{isOpen:be,onClose:()=>se({showImportModal:!1}),title:"Import Tasks",size:"md",children:(0,S.jsx)("div",{className:"space-y-4",children:ct?(0,S.jsx)("div",{className:"p-4 rounded-md "+(ct.errorCount>0?"bg-yellow-50 border border-yellow-200":"bg-green-50 border border-green-200"),children:(0,S.jsxs)("div",{className:"text-sm",children:[(0,S.jsx)("div",{className:"font-medium",children:ct.errorCount>0?"Import completed with errors":"Import completed successfully"}),(0,S.jsx)("div",{className:"mt-1",children:ct.message}),ct.errors&&(0,S.jsxs)("div",{className:"mt-2",children:[(0,S.jsx)("div",{className:"font-medium text-sm",children:"Errors:"}),(0,S.jsx)("ul",{className:"list-disc list-inside text-xs mt-1",children:ct.errors.map((e,t)=>(0,S.jsx)("li",{children:e},t))})]})]})}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,S.jsx)("p",{children:"Upload an Excel file (.xlsx) or CSV file with the following columns:"}),(0,S.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Title"})," (required) - Task title"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Department"})," - Department name"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Task Category"})," - Task category"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Project"})," - Project name"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Start Date"})," - Start date (YYYY-MM-DD)"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Due Date"})," - Due date (YYYY-MM-DD)"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Without Due Date"})," - Yes/No"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Assigned To"})," - Person assigned to the task"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Status"})," - Pending, In Progress, Completed, On Hold, Cancelled"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Description"})," - Task description"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Responsible"})," - RACI matrix - Responsible person"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Accountable"})," - RACI matrix - Accountable person"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Consulted"})," - RACI matrix - Consulted person"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Informed"})," - RACI matrix - Informed person"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Trained"})," - RACI matrix - Trained person"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Labels"})," - Task labels (comma-separated)"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Milestones"})," - Task milestones"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Priority"})," - Low, Medium, High"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Complexity"})," - Low, Medium, High"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Impact"})," - Compliance & Risk, Revenue Growth, Customer Experience, Cost Reduction, Efficiency & Process, Innovation & Development, Knowledge & Training"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Unit"})," - Numeric value for task completion"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Target"})," - Target description"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Effort Estimate Label"})," - 1 Day, 1 Week, 1 Month"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Make Private"})," - Yes/No"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Share"})," - Yes/No"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Repeat"})," - Yes/No"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Task is dependent on another task"})," - Yes/No"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Validation By"})," - Person who validates the task"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Effort Label"})," - Effort category"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Checklist"})," - Checklist items (one per line)"]}),(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:"Workflow Guide"})," - Workflow steps (one per line)"]})]}),(0,S.jsx)("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-md",children:(0,S.jsxs)("p",{className:"text-blue-800 text-xs",children:[(0,S.jsx)("strong",{children:"Note:"})," For a complete list of all available columns and sample data, download the sample file below."]})})]}),(0,S.jsx)("div",{className:"border-t pt-4",children:(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Sample Import File"}),(0,S.jsx)("p",{className:"text-xs text-gray-500",children:"Download a CSV file with all columns and sample data"})]}),(0,S.jsxs)(j.A,{variant:"secondary",onClick:()=>{const e=[{Title:"Sample Task 1",Department:"Engineering","Task Category":"Development",Project:"Project Alpha","Start Date":"2025-01-15","Due Date":"2025-01-30","Without Due Date":"No","Assigned To":"John Doe, Jane Smith",Status:"In Progress",Description:"This is a sample task description for demonstration purposes.",Responsible:"John Doe",Accountable:"Jane Smith",Consulted:"Mike Johnson",Informed:"Sarah Wilson",Trained:"Alex Brown",Labels:"Deadline, Improvements",Milestones:"Phase 1, Phase 2",Priority:"High",Complexity:"Medium",Impact:"Revenue Growth",Unit:"5",Target:"Complete feature implementation","Effort Estimate Label":"1 Week","Make Private":"No",Share:"Yes",Repeat:"No","Task is dependent on another task":"No","Validation By":"Project Manager","Effort Label":"Development",Checklist:"Requirements review\nDesign approval\nCode implementation\nTesting\nDeployment","Workflow Guide":"1. Review requirements\n2. Create design\n3. Implement code\n4. Test thoroughly\n5. Deploy to production"},{Title:"Sample Task 2",Department:"Marketing","Task Category":"Campaign",Project:"Project Beta","Start Date":"2025-01-20","Due Date":"2025-02-15","Without Due Date":"No","Assigned To":"Sarah Wilson",Status:"Pending",Description:"Marketing campaign for Q1 product launch.",Responsible:"Sarah Wilson",Accountable:"Marketing Manager",Consulted:"Design Team",Informed:"Sales Team",Trained:"Marketing Team",Labels:"Money, Sale",Milestones:"Campaign Design, Launch, Analysis",Priority:"Medium",Complexity:"Low",Impact:"Customer Experience",Unit:"3",Target:"Increase brand awareness by 25%","Effort Estimate Label":"1 Month","Make Private":"No",Share:"Yes",Repeat:"Yes","Task is dependent on another task":"No","Validation By":"Marketing Director","Effort Label":"Campaign Management",Checklist:"Define target audience\nCreate campaign materials\nSet up tracking\nLaunch campaign\nMonitor performance","Workflow Guide":"1. Research target audience\n2. Design campaign materials\n3. Set up analytics\n4. Launch campaign\n5. Monitor and optimize"},{Title:"Sample Task 3",Department:"Sales","Task Category":"Lead Generation",Project:"Project Gamma","Start Date":"2025-01-25","Due Date":"2025-02-10","Without Due Date":"No","Assigned To":"Mike Johnson",Status:"Completed",Description:"Generate qualified leads for enterprise sales team.",Responsible:"Mike Johnson",Accountable:"Sales Manager",Consulted:"Marketing Team",Informed:"Product Team",Trained:"Sales Representatives",Labels:"Sale, Daily Operations",Milestones:"Lead Research, Outreach, Qualification",Priority:"Low",Complexity:"High",Impact:"Revenue Growth",Unit:"10",Target:"Generate 50 qualified leads","Effort Estimate Label":"1 Week","Make Private":"No",Share:"Yes",Repeat:"Yes","Task is dependent on another task":"No","Validation By":"Sales Director","Effort Label":"Lead Generation",Checklist:"Research potential clients\nCreate outreach strategy\nExecute outreach campaign\nQualify responses\nHand off to sales team","Workflow Guide":"1. Research target companies\n2. Create personalized outreach\n3. Send initial emails\n4. Follow up with calls\n5. Qualify interest level"}],t=Object.keys(e[0]),s=[t.join(","),...e.map(e=>t.map(t=>{const s=e[t];return"string"===typeof s&&(s.includes(",")||s.includes('"'))?`"${s.replace(/"/g,'""')}"`:s}).join(","))].join("\n"),a=new Blob([s],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),r=URL.createObjectURL(a);l.setAttribute("href",r),l.setAttribute("download","sample_tasks_import.csv"),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)},className:"flex items-center space-x-2",children:[(0,S.jsx)(i.A,{className:"w-4 h-4"}),(0,S.jsx)("span",{children:"Download Sample"})]})]})}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select File"}),(0,S.jsx)("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:e=>le({selectedFile:e.target.files[0]}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,S.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,S.jsx)(j.A,{variant:"secondary",onClick:()=>se({showImportModal:!1}),disabled:ot,children:"Cancel"}),(0,S.jsx)(j.A,{variant:"primary",onClick:async()=>{if(!dt)return void alert("Please select a file");le({importLoading:!0});const e=new FormData;e.append("file",dt);try{console.log("Starting import...");const t=await fetch("http://localhost:5000/api/tasks/import",{method:"POST",body:e});if(console.log("Response status:",t.status),t.ok){const e=await t.json();console.log("Import result:",e),le({importResult:e}),(0,a.startTransition)(()=>{zt()}),le({selectedFile:null}),setTimeout(()=>{le({importResult:null}),se({showImportModal:!1})},5e3)}else{const e=await t.text();console.error("Import failed:",e),alert(`Import failed: ${e}`)}}catch(ue){console.error("Error importing tasks:",ue),alert("Import failed. Please check your connection and try again.")}finally{le({importLoading:!1})}},disabled:!dt||ot,children:ot?"Importing...":"Import Tasks"})]})]})})}),(0,S.jsx)(b.A,{isOpen:je,onClose:()=>se({showFilterModal:!1}),title:"Filters",size:"md",children:(0,S.jsxs)("div",{className:"space-y-4",children:[(0,S.jsxs)("div",{className:"space-y-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),(0,S.jsxs)("select",{value:Nt,onChange:e=>(0,a.startTransition)(()=>re({department:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),(de||[]).map(e=>(0,S.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,S.jsxs)("select",{value:gt,onChange:e=>(0,a.startTransition)(()=>re({status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),(0,S.jsx)("option",{value:"Pending",children:"Pending"}),(0,S.jsx)("option",{value:"In Progress",children:"In Progress"}),(0,S.jsx)("option",{value:"Completed",children:"Completed"}),(0,S.jsx)("option",{value:"Cancelled",children:"Cancelled"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),(0,S.jsx)(k.A,{options:ce.filter(e=>"Active"===e.status).map(e=>({value:e.id,label:`${e.name} (${e.employee_id})`})),value:wt,onChange:e=>(0,a.startTransition)(()=>re({assignedTo:e})),placeholder:"Select employees...",searchPlaceholder:"Search employees..."})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,S.jsxs)("select",{value:yt,onChange:e=>(0,a.startTransition)(()=>re({priority:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),(0,S.jsx)("option",{value:"High",children:"High"}),(0,S.jsx)("option",{value:"Medium",children:"Medium"}),(0,S.jsx)("option",{value:"Low",children:"Low"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complexity"}),(0,S.jsxs)("select",{value:ft,onChange:e=>(0,a.startTransition)(()=>re({complexity:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),(0,S.jsx)("option",{value:"High",children:"High"}),(0,S.jsx)("option",{value:"Medium",children:"Medium"}),(0,S.jsx)("option",{value:"Low",children:"Low"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Impact"}),(0,S.jsxs)("select",{value:bt,onChange:e=>(0,a.startTransition)(()=>re({impact:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),(0,S.jsx)("option",{value:"Compliance & Risk",title:"Essential work that must be done to meet legal, regulatory, or contractual obligations and to avoid penalties or security threats.",children:"Compliance & Risk"}),(0,S.jsx)("option",{value:"Revenue Growth",title:"Tasks that are directly focused on increasing the company's income and sales.",children:"Revenue Growth"}),(0,S.jsx)("option",{value:"Customer Experience",title:"Tasks aimed at improving customer satisfaction, loyalty, and retention. This focuses on making existing customers happier.",children:"Customer Experience"}),(0,S.jsx)("option",{value:"Cost Reduction",title:"Tasks that are directly focused on decreasing the company's expenses and improving profitability.",children:"Cost Reduction"}),(0,S.jsx)("option",{value:"Efficiency & Process",title:"Work aimed at improving internal workflows, automating manual steps, and saving employee time. It makes the company run smoother.",children:"Efficiency & Process"}),(0,S.jsx)("option",{value:"Innovation & Development",title:"Tasks related to creating entirely new products, services, or capabilities for the future. This is forward-looking, research-and-development work.",children:"Innovation & Development"}),(0,S.jsx)("option",{value:"Knowledge & Training",title:"Internal tasks focused on upskilling the team, creating documentation, and sharing information across the company.",children:"Knowledge & Training"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effort Estimate Label"}),(0,S.jsxs)("select",{value:jt,onChange:e=>(0,a.startTransition)(()=>re({effortEstimateLabel:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),(0,S.jsx)("option",{value:"1 Day",children:"1 Day"}),(0,S.jsx)("option",{value:"1 Week",children:"1 Week"}),(0,S.jsx)("option",{value:"1 Month",children:"1 Month"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit"}),(0,S.jsxs)("div",{className:"flex space-x-2",children:[(0,S.jsx)("input",{type:"number",value:vt,onChange:e=>(0,a.startTransition)(()=>re({unit:e.target.value})),placeholder:"Filter by unit value",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"}),(0,S.jsx)("button",{onClick:()=>re({unit:""}),className:"px-3 py-2 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 transition-colors",children:"Clear"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target"}),(0,S.jsxs)("div",{className:"flex space-x-2",children:[(0,S.jsx)("input",{type:"text",value:kt,onChange:e=>(0,a.startTransition)(()=>re({target:e.target.value})),placeholder:"Filter by target text",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,S.jsx)("button",{onClick:()=>re({target:""}),className:"px-3 py-2 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 transition-colors",children:"Clear"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Label"}),(0,S.jsxs)("select",{value:_t,onChange:e=>(0,a.startTransition)(()=>re({labels:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select..."}),(me||[]).map(e=>(0,S.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Responsible"}),(0,S.jsx)(k.A,{options:ce.filter(e=>"Active"===e.status).map(e=>({value:e.id,label:`${e.name} (${e.employee_id})`})),value:Ct,onChange:e=>(0,a.startTransition)(()=>re({responsible:e})),placeholder:"Select employees...",searchPlaceholder:"Search employees..."})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Accountable"}),(0,S.jsx)(k.A,{options:ce.filter(e=>"Active"===e.status).map(e=>({value:e.id,label:`${e.name} (${e.employee_id})`})),value:Tt,onChange:e=>(0,a.startTransition)(()=>re({accountable:e})),placeholder:"Select employees...",searchPlaceholder:"Search employees..."})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Consulted"}),(0,S.jsx)(k.A,{options:ce.filter(e=>"Active"===e.status).map(e=>({value:e.id,label:`${e.name} (${e.employee_id})`})),value:At,onChange:e=>(0,a.startTransition)(()=>re({consulted:e})),placeholder:"Select employees...",searchPlaceholder:"Search employees..."})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Informed"}),(0,S.jsx)(k.A,{options:ce.filter(e=>"Active"===e.status).map(e=>({value:e.id,label:`${e.name} (${e.employee_id})`})),value:St,onChange:e=>(0,a.startTransition)(()=>re({informed:e})),placeholder:"Select employees...",searchPlaceholder:"Search employees..."})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trained"}),(0,S.jsx)(k.A,{options:ce.filter(e=>"Active"===e.status).map(e=>({value:e.id,label:`${e.name} (${e.employee_id})`})),value:Dt,onChange:e=>(0,a.startTransition)(()=>re({trained:e})),placeholder:"Select employees...",searchPlaceholder:"Search employees..."})]})]}),(0,S.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,S.jsx)(j.A,{variant:"secondary",onClick:()=>{re({status:"",priority:"",complexity:"",impact:"",effortEstimateLabel:"",unit:"",target:"",department:"",assignedTo:[],labels:"",responsible:[],accountable:[],consulted:[],informed:[],trained:[]}),se({searchTerm:""}),se({currentPage:1,hasMoreTasks:!0}),zt(!0,1,!1,{})},children:"Clear Filters"}),(0,S.jsx)(j.A,{variant:"primary",onClick:()=>{se({showFilterModal:!1}),se({currentPage:1,hasMoreTasks:!0});const e=Xt();zt(!0,1,!1,e)},children:"Apply Filters"})]})]})}),(0,S.jsx)(b.A,{isOpen:Se,onClose:()=>se({showExportModal:!1}),title:"Export Tasks",size:"md",children:(0,S.jsxs)("div",{className:"space-y-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Export Format"}),(0,S.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Choose the format for your task export:"})]}),(0,S.jsxs)("div",{className:"space-y-3",children:[(0,S.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,S.jsx)("input",{type:"radio",id:"csv-format",name:"export-format",value:"csv",defaultChecked:!0,className:"w-4 h-4 text-blue-600"}),(0,S.jsx)("label",{htmlFor:"csv-format",className:"text-sm font-medium text-gray-700",children:"CSV (Comma Separated Values)"})]}),(0,S.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,S.jsx)("input",{type:"radio",id:"excel-format",name:"export-format",value:"excel",className:"w-4 h-4 text-blue-600"}),(0,S.jsx)("label",{htmlFor:"excel-format",className:"text-sm font-medium text-gray-700",children:"Excel (.xlsx)"})]})]}),(0,S.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,S.jsxs)("div",{className:"flex",children:[(0,S.jsx)("div",{className:"flex-shrink-0",children:(0,S.jsx)("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,S.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,S.jsxs)("div",{className:"ml-3",children:[(0,S.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"Export Information"}),(0,S.jsxs)("div",{className:"mt-2 text-sm text-blue-700",children:[(0,S.jsx)("p",{children:"The export will include all task data including:"}),(0,S.jsxs)("ul",{className:"list-disc list-inside mt-1",children:[(0,S.jsx)("li",{children:"Task details (title, description, status, priority)"}),(0,S.jsx)("li",{children:"Assignment information (assigned employees, department)"}),(0,S.jsx)("li",{children:"Time estimates and scoring data"}),(0,S.jsx)("li",{children:"Dates and timestamps"})]})]})]})]})}),(0,S.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,S.jsx)(j.A,{variant:"secondary",onClick:()=>se({showExportModal:!1}),children:"Cancel"}),(0,S.jsxs)(j.A,{variant:"primary",onClick:()=>{!async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"csv";try{const t=await fetch(`http://localhost:5000/api/tasks/export?format=${e}`);if(t.ok){const s=await t.blob(),a=window.URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download=`tasks-export-${(new Date).toISOString().split("T")[0]}.${"excel"===e?"xlsx":"csv"}`,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(a),document.body.removeChild(l),se({showExportModal:!1})}else{const e=await t.json();alert(e.error||"Export failed")}}catch(ue){console.error("Error exporting tasks:",ue),alert("Export failed. Please check your connection and try again.")}}(document.querySelector('input[name="export-format"]:checked').value)},children:[(0,S.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"Export Tasks"]})]})]})}),(0,S.jsx)(b.A,{isOpen:De,onClose:()=>se({showUpdateModal:!1}),title:"Update Existing Tasks",size:"md",children:(0,S.jsx)("div",{className:"space-y-4",children:ct?(0,S.jsx)("div",{className:"p-4 rounded-md "+(ct.errorCount>0?"bg-yellow-50 border border-yellow-200":"bg-green-50 border border-green-200"),children:(0,S.jsxs)("div",{className:"text-sm",children:[(0,S.jsx)("div",{className:"font-medium",children:ct.errorCount>0?"Update completed with errors":"Update completed successfully"}),(0,S.jsx)("div",{className:"mt-1",children:ct.message}),ct.errors&&(0,S.jsxs)("div",{className:"mt-2",children:[(0,S.jsx)("div",{className:"font-medium text-sm",children:"Errors:"}),(0,S.jsx)("ul",{className:"list-disc list-inside text-sm mt-1",children:ct.errors.map((e,t)=>(0,S.jsx)("li",{className:"text-red-600",children:e},t))})]})]})}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Update Instructions"}),(0,S.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[(0,S.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:'Upload a file with existing task data to update. The file must include a "Task ID" column to identify which tasks to update. Only the fields you provide will be updated.'}),(0,S.jsxs)("div",{className:"mt-3",children:[(0,S.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Supported Fields:"}),(0,S.jsxs)("div",{className:"text-xs text-gray-600 grid grid-cols-2 gap-1",children:[(0,S.jsx)("span",{children:"\u2022 Title"}),(0,S.jsx)("span",{children:"\u2022 Description"}),(0,S.jsx)("span",{children:"\u2022 Status"}),(0,S.jsx)("span",{children:"\u2022 Priority"}),(0,S.jsx)("span",{children:"\u2022 Complexity"}),(0,S.jsx)("span",{children:"\u2022 Impact"}),(0,S.jsx)("span",{children:"\u2022 Unit"}),(0,S.jsx)("span",{children:"\u2022 Target"}),(0,S.jsx)("span",{children:"\u2022 Effort Estimate"}),(0,S.jsx)("span",{children:"\u2022 Time Estimate (Hours)"}),(0,S.jsx)("span",{children:"\u2022 Time Estimate (Minutes)"}),(0,S.jsx)("span",{children:"\u2022 Due Date"}),(0,S.jsx)("span",{children:"\u2022 Start Date"}),(0,S.jsx)("span",{children:"\u2022 Assigned To"}),(0,S.jsx)("span",{children:"\u2022 Department"}),(0,S.jsx)("span",{children:"\u2022 Labels"}),(0,S.jsx)("span",{children:"\u2022 Checklist"}),(0,S.jsx)("span",{children:"\u2022 Workflow Guide"})]})]})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload File"}),(0,S.jsx)("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:(0,S.jsxs)("div",{className:"space-y-1 text-center",children:[(0,S.jsx)(n.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,S.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,S.jsxs)("label",{htmlFor:"update-file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500",children:[(0,S.jsx)("span",{children:dt?dt.name:"Select a file"}),(0,S.jsx)("input",{id:"update-file-upload",name:"update-file-upload",type:"file",className:"sr-only",onChange:e=>le({selectedFile:e.target.files[0]}),accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"})]}),(0,S.jsx)("p",{className:"pl-1",children:!dt&&"or drag and drop"})]}),(0,S.jsx)("p",{className:"text-xs text-gray-500",children:"CSV, XLSX, or XLS files only"})]})})]}),(0,S.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,S.jsx)(j.A,{variant:"secondary",onClick:()=>se({showUpdateModal:!1}),disabled:ot,children:"Cancel"}),(0,S.jsx)(j.A,{variant:"primary",onClick:async()=>{if(dt){le({importLoading:!0});try{const e=new FormData;e.append("file",dt);const t=await fetch("http://localhost:5000/api/tasks/update",{method:"POST",body:e});if(console.log("Response status:",t.status),t.ok){const e=await t.json();console.log("Update result:",e),le({importResult:e}),(0,a.startTransition)(()=>{zt()}),le({selectedFile:null}),setTimeout(()=>{le({importResult:null}),se({showUpdateModal:!1})},5e3)}else{const e=await t.text();console.error("Update failed:",e),alert(`Update failed: ${e}`)}}catch(ue){console.error("Error updating tasks:",ue),alert("Update failed. Please check your connection and try again.")}finally{le({importLoading:!1})}}else alert("Please select a file")},disabled:!dt||ot,children:ot?"Updating...":"Update Tasks"})]})]})})}),ke&&pe&&(0,S.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,S.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl h-[95vh] overflow-y-auto",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-white sticky top-0 z-10",children:[(0,S.jsx)("div",{className:"flex items-center space-x-4",children:(0,S.jsxs)("div",{children:[(0,S.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:pe.title}),(0,S.jsxs)("p",{className:"text-sm text-gray-500",children:["Task ID: ",pe.id]})]})}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsxs)("button",{onClick:()=>Ms(pe.id,"Completed"),disabled:!ws(pe),className:"px-4 py-2 rounded-lg transition-colors flex items-center space-x-2 "+(ws(pe)?"bg-green-500 text-white hover:bg-green-600":"bg-gray-300 text-gray-500 cursor-not-allowed"),title:ws(pe)?"Mark task as complete":ks(pe)||Ns(pe)?ks(pe)?"Cannot complete: Unit value must be set":"Cannot complete: All checklist items must be completed first":"Cannot complete: Both checklist items and unit value must be completed",children:[(0,S.jsx)(m.A,{className:"w-4 h-4"}),(0,S.jsx)("span",{children:"Mark As Complete"})]}),(()=>{const e=Et[pe.id]||pe.timer_started_at,t=us(),s=Ds(pe)&&!t,a=Es(pe)&&e;return Ds(pe)||Es(pe)?(0,S.jsx)("button",{onClick:()=>e?js(pe.id):bs(pe.id),className:"px-4 py-2 rounded-lg transition-colors flex items-center space-x-2 "+(e?"bg-red-500 text-white hover:bg-red-600":s?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-300 text-gray-500 cursor-not-allowed"),disabled:!s&&!a,title:t&&!e?`You have an active timer on: ${t.title}`:e?"Stop Timer":"Start Timer",children:e?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(g.A,{className:"w-4 h-4"}),(0,S.jsx)("span",{children:"Stop Timer"})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(y,{className:"w-4 h-4"}),(0,S.jsx)("span",{children:"Start Timer"})]})}):null})(),(0,S.jsx)("button",{onClick:()=>{se({selectedTask:null,showDetailModal:!1,taskDetailTab:"files"})},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,S.jsx)(f.A,{className:"w-5 h-5 text-gray-500"})})]})]}),(0,S.jsxs)("div",{className:"flex min-h-[calc(95vh-120px)]",children:[(0,S.jsxs)("div",{className:"w-2/3 p-6 border-r border-gray-200",children:[(0,S.jsxs)("div",{className:"space-y-6",children:[(0,S.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Project"}),(0,S.jsx)("p",{className:"text-gray-900",children:pe.project||"-"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Priority"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-3 h-3 rounded-full "+("High"===pe.priority?"bg-red-500":"Medium"===pe.priority?"bg-yellow-500":"bg-green-500")}),(0,S.jsx)("span",{className:"text-gray-900",children:pe.priority||"Medium"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Complexity"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-3 h-3 rounded-full "+("High"===pe.complexity?"bg-purple-500":"Medium"===pe.complexity?"bg-orange-500":"bg-blue-500")}),(0,S.jsx)("span",{className:"text-gray-900",children:pe.complexity||"Low"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Impact"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-3 h-3 rounded-full "+("Compliance & Risk"===pe.impact?"bg-red-500":"Revenue Growth"===pe.impact?"bg-green-500":"Customer Experience"===pe.impact?"bg-blue-500":"Cost Reduction"===pe.impact?"bg-purple-500":"Efficiency & Process"===pe.impact?"bg-orange-500":"Innovation & Development"===pe.impact?"bg-indigo-500":"Knowledge & Training"===pe.impact?"bg-teal-500":"bg-gray-400")}),(0,S.jsx)("span",{className:"text-gray-900",children:pe.impact||"Not set"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Effort Estimate Label"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-3 h-3 rounded-full "+(pe.effort_estimate_label?"bg-blue-500":"bg-gray-400")}),(0,S.jsx)("span",{className:"text-gray-900",children:pe.effort_estimate_label||"Not set"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Unit"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-3 h-3 rounded-full "+(pe.unit&&pe.unit>0?"bg-green-500":"bg-red-500")}),(0,S.jsx)("span",{className:"text-gray-900",children:pe.unit||"Not set"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Target"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-3 h-3 rounded-full "+(pe.target?"bg-blue-500":"bg-gray-400")}),(0,S.jsx)("span",{className:"text-gray-900",children:pe.target||"Not set"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Assigned To"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:pe.assigned_to?pe.assigned_to.charAt(0).toUpperCase():"U"}),(0,S.jsx)("span",{className:"text-gray-900",children:pe.assigned_to||"Unassigned"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Short Code"}),(0,S.jsx)("p",{className:"text-gray-900",children:"-"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Milestones"}),(0,S.jsx)("p",{className:"text-gray-900",children:pe.milestones||"-"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Assigned By"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-8 h-8 bg-black rounded-full flex items-center justify-center text-white text-sm font-medium",children:"A"}),(0,S.jsx)("span",{className:"text-gray-900",children:"Admin"})]})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Label"}),(0,S.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:pe.labels||"No Label"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Task Category"}),(0,S.jsx)("p",{className:"text-gray-900",children:pe.task_category||"General"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Description"}),(0,S.jsx)("p",{className:"text-gray-900",children:pe.description||"-"})]}),pe.checklist&&(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Checklist"}),ks(pe)?(0,S.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:[(0,S.jsx)(m.A,{className:"w-3 h-3 mr-1"}),"Complete"]}):(0,S.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:[(0,S.jsx)(u.A,{className:"w-3 h-3 mr-1"}),"Incomplete"]})]}),(0,S.jsxs)("div",{className:"rounded-lg p-4 "+(ks(pe)?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"),children:[pe.checklist.split("\n").filter(e=>""!==e.trim()).map((e,t)=>(0,S.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,S.jsx)("input",{type:"checkbox",checked:_s(pe.id,t),onChange:()=>{return e=pe.id,s=t,void setChecklistCompletion(t=>{const a=[...t[e]||[]];return a.includes(s)?{...t,[e]:a.filter(e=>e!==s)}:{...t,[e]:[...a,s].sort((e,t)=>e-t)}});var e,s},className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),(0,S.jsx)("span",{className:""+(_s(pe.id,t)?"line-through text-gray-500":ks(pe)?"text-gray-900":"text-yellow-800"),children:e.trim()})]},t)),!ks(pe)&&(0,S.jsx)("div",{className:"mt-3 p-2 bg-yellow-100 rounded text-xs text-yellow-800",children:"\u26a0\ufe0f All checklist items must be completed before marking this task as complete."}),ks(pe)&&(0,S.jsx)("div",{className:"mt-3 p-2 bg-green-100 rounded text-xs text-green-800",children:"\u2705 All checklist items completed! You can now mark this task as complete."})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Unit Value"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[pe.unit&&parseFloat(pe.unit)>0&&(0,S.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:[(0,S.jsx)("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-1"}),"Editable"]}),Ns(pe)?(0,S.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:[(0,S.jsx)(m.A,{className:"w-3 h-3 mr-1"}),"Valid"]}):(0,S.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-red-100 text-red-800 rounded-full",children:[(0,S.jsx)(u.A,{className:"w-3 h-3 mr-1"}),"Required"]})]})]}),(0,S.jsxs)("div",{className:"rounded-lg p-4 "+(Ns(pe)?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[(0,S.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,S.jsxs)("div",{className:"flex-1",children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter Unit Value"}),(0,S.jsx)("input",{type:"number",value:(null===pe||void 0===pe?void 0:pe.unit)||"",onChange:e=>{const t=e.target.value;console.log("Unit input changed:",t),P(e=>{const s={...e,selectedTask:{...e.selectedTask,unit:t}};return console.log("Updated state:",s),s})},placeholder:"Enter number of units",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"}),(0,S.jsx)("button",{onClick:async()=>{try{(await fetch(`http://localhost:5000/api/tasks/${pe.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({unit:pe.unit,user_name:(null===D||void 0===D?void 0:D.name)||"Admin",user_id:(null===D||void 0===D?void 0:D.id)||1})})).ok?(se(e=>({...e,selectedTask:{...e.selectedTask,unit:pe.unit}})),te({tasks:oe.map(e=>e.id===pe.id?{...e,unit:pe.unit}:e)}),alert("Unit value saved successfully!")):alert("Failed to update unit value")}catch(ue){console.error("Error updating unit value:",ue),alert("Failed to update unit value")}},disabled:!pe.unit||parseFloat(pe.unit)<=0,className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"Save Unit Value"})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center",children:[(0,S.jsx)("span",{className:"text-sm font-medium text-gray-700 mb-1",children:"Current Value:"}),(0,S.jsx)("span",{className:"text-lg font-bold "+(Ns(pe)?"text-green-800":"text-red-800"),children:pe.unit||"Not set"})]})]}),!Ns(pe)&&(0,S.jsx)("div",{className:"mt-3 p-2 bg-red-100 rounded text-xs text-red-800",children:"\u26a0\ufe0f Unit value must be set to a number greater than 0 before marking this task as complete."}),Ns(pe)&&(0,S.jsx)("div",{className:"mt-3 p-2 bg-green-100 rounded text-xs text-green-800",children:"\u2705 Unit value is valid! You can now mark this task as complete."})]})]}),pe.workflow_guide&&(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Workflow Guide"}),(0,S.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:pe.workflow_guide.split("\n").map((e,t)=>(0,S.jsxs)("div",{className:"flex items-start space-x-2 mb-2",children:[(0,S.jsx)("span",{className:"w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-medium mt-0.5",children:t+1}),(0,S.jsx)("span",{className:"text-gray-900",children:e.trim()})]},t))})]}),(0,S.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Validation By"}),(0,S.jsx)("p",{className:"text-gray-900",children:pe.validation_by||"-"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Effort Label"}),(0,S.jsx)("p",{className:"text-gray-900",children:pe.effort_label||"-"})]})]})]}),(0,S.jsxs)("div",{className:"mt-8",children:[(0,S.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"RACIT Matrix"}),(0,S.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,S.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,S.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Responsible"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:pe.responsible?pe.responsible.charAt(0).toUpperCase():"R"}),(0,S.jsx)("span",{className:"text-sm text-gray-900",children:pe.responsible||"Unassigned"})]})]}),(0,S.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,S.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Accountable"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:pe.accountable?pe.accountable.charAt(0).toUpperCase():"A"}),(0,S.jsx)("span",{className:"text-sm text-gray-900",children:pe.accountable||"Unassigned"})]})]}),(0,S.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,S.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Consulted"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:pe.consulted?pe.consulted.charAt(0).toUpperCase():"C"}),(0,S.jsx)("span",{className:"text-sm text-gray-900",children:pe.consulted||"Unassigned"})]})]}),(0,S.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,S.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Informed"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:pe.informed?pe.informed.charAt(0).toUpperCase():"I"}),(0,S.jsx)("span",{className:"text-sm text-gray-900",children:pe.informed||"Unassigned"})]})]})]})]})]}),(0,S.jsx)("div",{className:"w-1/3 p-6 bg-gray-50",children:(0,S.jsxs)("div",{className:"space-y-4",children:[(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,S.jsx)("span",{className:"font-medium text-gray-900",children:"Due"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Created On"}),(0,S.jsx)("p",{className:"text-gray-900",children:new Date(pe.created_at).toLocaleDateString("en-US",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Start Date"}),(0,S.jsx)("p",{className:"text-gray-900",children:pe.start_date?new Date(pe.start_date).toLocaleDateString("en-US",{weekday:"short",day:"2-digit",month:"short",year:"numeric"}):"-"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Due Date"}),(0,S.jsx)("p",{className:"text-gray-900",children:pe.due_date?new Date(pe.due_date).toLocaleDateString("en-US",{weekday:"short",day:"2-digit",month:"short",year:"numeric"}):"-"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Hours Logged"}),(0,S.jsx)("p",{className:"text-gray-900",children:pe.logged_seconds?`${Math.floor(pe.logged_seconds/3600)}h ${Math.floor(pe.logged_seconds%3600/60)}m`:"0s"})]})]})})]}),(0,S.jsxs)("div",{className:"border-t border-gray-200",children:[(0,S.jsx)("div",{className:"flex border-b border-gray-200 bg-white sticky top-0 z-10",children:["Files","Sub Task","Comment","Timesheet","Notes","History"].map(e=>(0,S.jsx)("button",{onClick:()=>se({taskDetailTab:e.toLowerCase().replace(" ","")}),className:"px-6 py-3 text-sm font-medium border-b-2 transition-colors "+(ye===e.toLowerCase().replace(" ","")?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:e},e))}),(0,S.jsxs)("div",{className:"p-6 min-h-[500px]",children:["files"===ye&&(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,S.jsx)("input",{type:"file",onChange:async e=>{const t=e.target.files[0];if(!t||!pe)return;const s=e.target.nextElementSibling;s&&(s.disabled=!0,s.textContent="Uploading...");try{const s=new FormData;s.append("attachments",t),s.append("uploaded_by",(null===D||void 0===D?void 0:D.id)||1);const l=await fetch(`http://localhost:5000/api/tasks/${pe.id}/upload`,{method:"POST",body:s});if(l.ok){const t=await l.json();try{const e=await fetch(`http://localhost:5000/api/tasks/${pe.id}/attachments`);if(e.ok){const t=await e.json();qe(t.attachments||[])}}catch(a){console.error("Error reloading attachments:",a),qe(e=>[...e||[],...t.files||[]])}e.target.value=""}else{const e=await l.json();alert(`Upload failed: ${e.error}`)}}catch(ue){console.error("Upload error:",ue),alert("Upload failed. Please try again.")}finally{const t=e.target.nextElementSibling;t&&(t.disabled=!1,t.innerHTML='<Plus className="w-4 h-4" /><span>Upload File</span>')}},className:"hidden",id:"file-upload"}),(0,S.jsxs)("label",{htmlFor:"file-upload",className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors cursor-pointer flex items-center space-x-2",children:[(0,S.jsx)(d.A,{className:"w-4 h-4"}),(0,S.jsx)("span",{children:"Upload File"})]})]}),(0,S.jsx)("div",{className:"space-y-2",children:(Ie||[]).map(e=>(0,S.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,S.jsxs)("p",{className:"text-sm text-gray-500",children:[e.size," \u2022 ",e.uploadedAt]})]}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("button",{onClick:()=>(async e=>{if(pe)try{const t=await fetch(`http://localhost:5000/api/tasks/${pe.id}/attachments/${e.id}/download`);if(t.ok){const s=await t.blob(),a=window.URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download=e.name,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(a),document.body.removeChild(l)}else{const e=await t.json();alert(`Download failed: ${e.error}`)}}catch(ue){console.error("Download error:",ue),alert("Download failed. Please try again.")}})(e),className:"text-blue-500 hover:text-blue-700",title:"Download",children:(0,S.jsx)(i.A,{className:"w-4 h-4"})}),(0,S.jsx)("button",{onClick:()=>(async e=>{if(pe)try{const s=await fetch(`http://localhost:5000/api/tasks/${pe.id}/attachments/${e}`,{method:"DELETE"});if(s.ok)try{const e=await fetch(`http://localhost:5000/api/tasks/${pe.id}/attachments`);if(e.ok){const t=await e.json();qe(t.attachments||[])}}catch(t){console.error("Error reloading attachments:",t),qe(t=>(t||[]).filter(t=>t.id!==e))}else{const e=await s.json();alert(`Delete failed: ${e.error}`)}}catch(ue){console.error("Delete error:",ue),alert("Delete failed. Please try again.")}})(e.id),className:"text-red-500 hover:text-red-700",title:"Remove file",children:(0,S.jsx)(p.A,{className:"w-4 h-4"})})]})]},e.id))})]}),"subtask"===ye&&(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,S.jsx)("input",{type:"text",value:ze,onChange:e=>st(e.target.value),placeholder:"Add new subtask...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,S.jsx)("button",{onClick:()=>{if(ze.trim()){const e={id:Date.now(),title:ze,completed:!1};Qe(t=>[...Array.isArray(t)?t:[],e]),st("")}},className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Add"})]}),(0,S.jsx)("div",{className:"space-y-2",children:Array.isArray($e)?$e.map(e=>(0,S.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,S.jsx)("input",{type:"checkbox",checked:e.completed,onChange:()=>{return t=e.id,void Qe(e=>(Array.isArray(e)?e:[]).map(e=>e.id===t?{...e,completed:!e.completed}:e));var t},className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),Ve===e.id?(0,S.jsxs)("div",{className:"flex-1 flex items-center space-x-2",children:[(0,S.jsx)("input",{type:"text",value:Ye,onChange:e=>lt(e.target.value),className:"flex-1 px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:e=>"Enter"===e.key&&cs(),autoFocus:!0}),(0,S.jsx)("button",{onClick:cs,className:"px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600 transition-colors",children:"Save"}),(0,S.jsx)("button",{onClick:ds,className:"px-2 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"Cancel"})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("span",{className:"flex-1 "+(e.completed?"line-through text-gray-500":"text-gray-900"),children:e.title}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("button",{onClick:()=>{return t=e.id,s=e.title,at(t),void lt(s);var t,s},className:"text-blue-500 hover:text-blue-700 transition-colors",title:"Edit subtask",children:(0,S.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,S.jsx)("button",{onClick:()=>{return t=e.id,void Qe(e=>(Array.isArray(e)?e:[]).filter(e=>e.id!==t));var t},className:"text-red-500 hover:text-red-700 transition-colors",title:"Delete subtask",children:(0,S.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]},e.id)):null})]}),"comment"===ye&&(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,S.jsx)("input",{type:"text",value:We,onChange:e=>tt(e.target.value),placeholder:"Add a comment...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,S.jsx)("button",{onClick:()=>{if(We.trim()){const e={id:Date.now(),user:(null===D||void 0===D?void 0:D.name)||"User",comment:We,timestamp:(new Date).toLocaleString()};Ke(t=>[...Array.isArray(t)?t:[],e]),tt("")}},className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Add"})]}),(0,S.jsx)("div",{className:"space-y-3",children:Array.isArray(Ue)?Ue.map(e=>(0,S.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,S.jsx)("span",{className:"font-medium text-gray-900",children:e.user}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("span",{className:"text-sm text-gray-500",children:e.timestamp}),(0,S.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,S.jsx)("button",{onClick:()=>{return t=e.id,s=e.comment,rt(t),void it(s);var t,s},className:"text-blue-500 hover:text-blue-700 transition-colors",title:"Edit comment",children:(0,S.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,S.jsx)("button",{onClick:()=>{return t=e.id,void Ke(e=>(Array.isArray(e)?e:[]).filter(e=>e.id!==t));var t},className:"text-red-500 hover:text-red-700 transition-colors",title:"Delete comment",children:(0,S.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]}),Je===e.id?(0,S.jsxs)("div",{className:"space-y-2",children:[(0,S.jsx)("textarea",{value:Ge,onChange:e=>it(e.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",autoFocus:!0}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("button",{onClick:os,className:"px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600 transition-colors",children:"Save"}),(0,S.jsx)("button",{onClick:ns,className:"px-2 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"Cancel"})]})]}):(0,S.jsx)("p",{className:"text-gray-700",children:e.comment})]},e.id)):null})]}),"timesheet"===ye&&(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-blue-900",children:"Total Time Spent"}),(0,S.jsx)("p",{className:"text-sm text-blue-700",children:"All logged time entries for this task"})]}),(0,S.jsxs)("div",{className:"text-right",children:[(0,S.jsxs)("div",{className:"text-2xl font-bold text-blue-900",children:[Math.floor(U/60),"m ",U%60,"s"]}),(0,S.jsxs)("div",{className:"text-sm text-blue-600",children:[Re.length," time entries"]})]})]})}),0===Re.length?(0,S.jsxs)("div",{className:"text-center py-8",children:[(0,S.jsx)("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,S.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,S.jsx)("p",{className:"text-gray-500 text-lg",children:"No timesheet entries yet"}),(0,S.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:"Time entries will appear here when timers are stopped"})]}):(0,S.jsx)("div",{className:"overflow-x-auto",children:(0,S.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,S.jsx)("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"px-4 py-3",children:"Employee"}),(0,S.jsx)("th",{className:"px-4 py-3",children:"Start Time"}),(0,S.jsx)("th",{className:"px-4 py-3",children:"End Time"}),(0,S.jsx)("th",{className:"px-4 py-3",children:"Memo"}),(0,S.jsx)("th",{className:"px-4 py-3",children:"Hours Logged"})]})}),(0,S.jsx)("tbody",{children:Re.map(e=>(0,S.jsxs)("tr",{className:"bg-white border-b hover:bg-gray-50",children:[(0,S.jsx)("td",{className:"px-4 py-4",children:(0,S.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,S.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:e.employee_name?e.employee_name.charAt(0).toUpperCase():"U"}),(0,S.jsx)("div",{children:(0,S.jsx)("div",{className:"font-medium text-gray-900",children:e.employee_name})})]})}),(0,S.jsx)("td",{className:"px-4 py-4 text-gray-900",children:e.formatted_start_time||(e.start_time?new Date(e.start_time).toLocaleString():"-")}),(0,S.jsx)("td",{className:"px-4 py-4 text-gray-900",children:e.formatted_end_time||(e.end_time?new Date(e.end_time).toLocaleString():"-")}),(0,S.jsx)("td",{className:"px-4 py-4",children:(0,S.jsx)("div",{className:"max-w-xs",children:(0,S.jsx)("p",{className:"text-gray-700 truncate",title:e.memo,children:e.memo||"No memo"})})}),(0,S.jsx)("td",{className:"px-4 py-4",children:(0,S.jsxs)("span",{className:"font-mono text-blue-600 font-medium",children:[Math.floor(e.hours_logged_seconds/60),"m ",e.hours_logged_seconds%60,"s"]})})]},e.id))})]})})]}),"notes"===ye&&(0,S.jsx)("div",{children:(0,S.jsx)("textarea",{value:Fe,onChange:e=>{return t=e.target.value,void Ze(t);var t},placeholder:"Add notes about this task...",className:"w-full h-32 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"})}),"history"===ye&&(0,S.jsxs)("div",{children:["admin"===(null===D||void 0===D?void 0:D.role)&&He.length>0&&(0,S.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Task History"}),(0,S.jsxs)("button",{onClick:()=>{pe&&He.length>0&&se({showDeleteAllHistoryModal:!0})},className:"inline-flex items-center px-3 py-2 text-sm font-medium text-red-700 bg-red-100 border border-red-300 rounded-md hover:bg-red-200 hover:text-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors",title:"Delete all history for this task",children:[(0,S.jsx)(p.A,{className:"w-4 h-4 mr-2"}),"Delete All History"]})]}),(0,S.jsx)("div",{className:"space-y-4",children:0===He.length?(0,S.jsxs)("div",{className:"text-center py-12",children:[(0,S.jsx)("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,S.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,S.jsx)("p",{className:"text-gray-500 text-lg",children:"No history available for this task"}),(0,S.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:"History will appear here when actions are performed on this task"})]}):He.map(e=>(0,S.jsxs)("div",{className:"flex items-start space-x-4 p-4 bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[(0,S.jsx)("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium flex-shrink-0",children:e.user_name?e.user_name.charAt(0).toUpperCase():"U"}),(0,S.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,S.jsx)("span",{className:"font-semibold text-gray-900 text-base",children:e.action}),(0,S.jsx)("span",{className:"text-sm text-gray-500 font-medium",children:e.formatted_date})]}),(0,S.jsx)("p",{className:"text-gray-700 mb-2",children:e.description}),e.user_name&&(0,S.jsxs)("p",{className:"text-sm text-gray-600 font-medium",children:["by ",e.user_name]}),e.old_value&&e.new_value&&(0,S.jsxs)("div",{className:"mt-3 flex items-center space-x-3",children:[(0,S.jsx)("span",{className:"text-sm text-gray-600 font-medium",children:"Status:"}),(0,S.jsx)("span",{className:"text-sm bg-red-100 text-red-800 px-3 py-1 rounded-full font-medium",children:e.old_value}),(0,S.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,S.jsx)("span",{className:"text-sm bg-green-100 text-green-800 px-3 py-1 rounded-full font-medium",children:e.new_value})]}),"admin"===(null===D||void 0===D?void 0:D.role)&&(0,S.jsx)("div",{className:"mt-3 flex justify-end",children:(0,S.jsxs)("button",{onClick:()=>(async e=>{const t=He.find(t=>t.id===e);t&&(ne({historyToDelete:t}),se({showDeleteHistoryModal:!0}))})(e.id),className:"inline-flex items-center px-3 py-1.5 text-xs font-medium text-red-700 bg-red-100 border border-red-300 rounded-md hover:bg-red-200 hover:text-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors",title:"Delete this history entry",children:[(0,S.jsx)(p.A,{className:"w-3 h-3 mr-1"}),"Delete"]})})]})]},e.id))})]})]})]})]})}),_e&&(0,S.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,S.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,S.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Stop Timer"}),(0,S.jsx)("button",{onClick:()=>se({showStopTimerModal:!1}),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,S.jsx)(f.A,{className:"w-5 h-5 text-gray-500"})})]}),(0,S.jsxs)("div",{className:"p-6 space-y-4",children:[(0,S.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),(0,S.jsx)("input",{type:"text",value:It,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-900"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),(0,S.jsx)("input",{type:"text",value:$t,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-900"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Time"}),(0,S.jsx)("input",{type:"text",value:Ut,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-900"})]}),(0,S.jsxs)("div",{children:[(0,S.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Memo ",(0,S.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,S.jsx)("textarea",{value:Pt,onChange:e=>ie({stopTimerMemo:e.target.value}),placeholder:"Enter a memo about what you worked on...",rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",required:!0}),(0,S.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Please describe what you worked on during this time period."})]})]}),(0,S.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200",children:[(0,S.jsx)("button",{onClick:()=>se({showStopTimerModal:!1}),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,S.jsxs)("button",{onClick:async()=>{if(Pt.trim())try{const e=Et[Lt],t=e?Math.floor((Date.now()-e)/1e3):0;(await fetch(`http://localhost:5000/api/tasks/${Lt}/stop-timer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({loggedSeconds:t,user_name:(null===D||void 0===D?void 0:D.name)||"Admin",user_id:(null===D||void 0===D?void 0:D.id)||1,memo:Pt.trim()})})).ok?(Mt[Lt]&&clearInterval(Mt[Lt]),ie(e=>{const t={...e.activeTimers};return delete t[Lt],{...e,activeTimers:t}}),ie(e=>{const t={...e.intervals};return delete t[Lt],{...e,intervals:t}}),Bt(),pe&&pe.id===Lt&&(Jt(Lt),fetch(`http://localhost:5000/api/tasks/${Lt}/history`).then(e=>e.json()).then(e=>et(e)).catch(e=>console.error("Error refreshing history:",e))),se({showStopTimerModal:!1}),ie({stopTimerTaskId:null,stopTimerMemo:"",stopTimerStartTime:"",stopTimerEndTime:"",stopTimerTotalTime:""})):alert("Failed to stop timer")}catch(ue){console.error("Error stopping timer:",ue),alert("Failed to stop timer")}else alert("Please enter a memo before stopping the timer")},disabled:!Pt.trim(),className:"px-4 py-2 rounded-lg transition-colors flex items-center space-x-2 "+(Pt.trim()?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:[(0,S.jsx)(m.A,{className:"w-4 h-4"}),(0,S.jsx)("span",{children:"Save"})]})]})]})}),Ce&&Rt&&(0,S.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,S.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,S.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Delete History Entry"}),(0,S.jsx)("button",{onClick:()=>{se({showDeleteHistoryModal:!1}),ne({historyToDelete:null})},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,S.jsx)(f.A,{className:"w-5 h-5 text-gray-500"})})]}),(0,S.jsxs)("div",{className:"p-6 space-y-4",children:[(0,S.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,S.jsx)("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:(0,S.jsx)(p.A,{className:"w-5 h-5 text-red-600"})}),(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{className:"text-gray-900 font-medium",children:"Are you sure you want to delete this history entry?"}),(0,S.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"This action cannot be undone."})]})]}),(0,S.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,S.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,S.jsx)("span",{className:"font-medium",children:"Action:"})," ",Rt.action]}),(0,S.jsxs)("p",{className:"text-sm text-gray-700 mt-1",children:[(0,S.jsx)("span",{className:"font-medium",children:"Date:"})," ",Rt.formatted_date]}),Rt.description&&(0,S.jsxs)("p",{className:"text-sm text-gray-700 mt-1",children:[(0,S.jsx)("span",{className:"font-medium",children:"Description:"})," ",Rt.description]})]})]}),(0,S.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200",children:[(0,S.jsx)("button",{onClick:()=>{se({showDeleteHistoryModal:!1}),ne({historyToDelete:null})},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,S.jsxs)("button",{onClick:async()=>{if(Rt)try{const e=await fetch(`http://localhost:5000/api/task-history/${Rt.id}/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_role:(null===D||void 0===D?void 0:D.role)||"employee"})});if(e.ok)pe&&await Jt(pe.id),se({showDeleteHistoryModal:!1}),ne({historyToDelete:null}),alert("History entry deleted successfully");else{const t=await e.json();alert(t.error||"Failed to delete history entry")}}catch(ue){console.error("Error deleting history entry:",ue),alert("Failed to delete history entry")}},className:"px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors flex items-center space-x-2",children:[(0,S.jsx)(p.A,{className:"w-4 h-4"}),(0,S.jsx)("span",{children:"Delete"})]})]})]})}),Te&&(0,S.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,S.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,S.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Delete All Task History"}),(0,S.jsx)("button",{onClick:()=>se({showDeleteAllHistoryModal:!1}),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,S.jsx)(f.A,{className:"w-5 h-5 text-gray-500"})})]}),(0,S.jsxs)("div",{className:"p-6 space-y-4",children:[(0,S.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,S.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,S.jsx)(p.A,{className:"w-6 h-6 text-red-600"})}),(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{className:"text-gray-900 font-medium",children:"Are you sure you want to delete ALL history for this task?"}),(0,S.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["This action cannot be undone and will remove ",He.length," history entries."]})]})]}),(0,S.jsxs)("div",{className:"bg-red-50 border border-red-200 p-4 rounded-lg",children:[(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)(u.A,{className:"w-5 h-5 text-red-600"}),(0,S.jsx)("p",{className:"text-sm font-medium text-red-800",children:"Warning"})]}),(0,S.jsxs)("p",{className:"text-sm text-red-700 mt-2",children:["This will permanently delete all ",He.length,' history entries for "',null===pe||void 0===pe?void 0:pe.title,'". This action cannot be undone and may affect task tracking and reporting.']})]})]}),(0,S.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200",children:[(0,S.jsx)("button",{onClick:()=>se({showDeleteAllHistoryModal:!1}),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,S.jsxs)("button",{onClick:async()=>{if(pe)try{const e=await fetch(`http://localhost:5000/api/task-history/task/${pe.id}/delete-all`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_role:(null===D||void 0===D?void 0:D.role)||"employee"})});if(e.ok){const t=await e.json();await Jt(pe.id),se({showDeleteAllHistoryModal:!1}),alert(t.message)}else{const t=await e.json();alert(t.error||"Failed to delete all history entries")}}catch(ue){console.error("Error deleting all history entries:",ue),alert("Failed to delete all history entries")}},className:"px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors flex items-center space-x-2",children:[(0,S.jsx)(p.A,{className:"w-4 h-4"}),(0,S.jsx)("span",{children:"Delete All History"})]})]})]})}),Ae&&Ot&&(0,S.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,S.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,S.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Checklist Incomplete"}),(0,S.jsx)("button",{onClick:()=>{se({showChecklistWarningModal:!1}),setChecklistWarningTask(null)},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,S.jsx)(f.A,{className:"w-5 h-5 text-gray-500"})})]}),(0,S.jsxs)("div",{className:"p-6 space-y-4",children:[(0,S.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,S.jsx)("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:(0,S.jsx)(u.A,{className:"w-6 h-6 text-yellow-600"})}),(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{className:"text-gray-900 font-medium",children:"Cannot Complete Task"}),(0,S.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:ks(Ot)||Ns(Ot)?ks(Ot)?"Unit value must be set before marking this task as complete.":"All checklist items must be completed before marking this task as complete.":"Both checklist items and unit value must be completed before marking this task as complete."})]})]}),(0,S.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg",children:[(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)(u.A,{className:"w-5 h-5 text-yellow-600"}),(0,S.jsxs)("p",{className:"text-sm font-medium text-yellow-800",children:["Task: ",Ot.title]})]}),Ot.checklist&&!ks(Ot)&&(0,S.jsxs)("div",{className:"mt-3",children:[(0,S.jsx)("p",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Checklist Items:"}),(0,S.jsx)("div",{className:"space-y-1",children:Ot.checklist.split("\n").filter(e=>""!==e.trim()).map((e,t)=>(0,S.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-yellow-700",children:[(0,S.jsx)("div",{className:"w-3 h-3 border-2 border-yellow-400 rounded-sm"}),(0,S.jsx)("span",{children:e.trim()})]},t))})]}),!Ns(Ot)&&(0,S.jsxs)("div",{className:"mt-3",children:[(0,S.jsx)("p",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Unit Value:"}),(0,S.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-yellow-700",children:[(0,S.jsx)("div",{className:"w-3 h-3 border-2 border-yellow-400 rounded-sm"}),(0,S.jsx)("span",{children:"Unit value is required and must be greater than 0"})]}),(0,S.jsxs)("p",{className:"text-sm text-yellow-700 mt-1",children:["Current value: ",Ot.unit||"Not set"]})]}),(0,S.jsx)("p",{className:"text-sm text-yellow-700 mt-3",children:ks(Ot)||Ns(Ot)?ks(Ot)?"Please set a valid unit value before marking this task as complete.":"Please complete all checklist items before marking this task as complete.":"Please complete all checklist items and set a valid unit value before marking this task as complete."})]})]}),(0,S.jsx)("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200",children:(0,S.jsx)("button",{onClick:()=>{se({showChecklistWarningModal:!1}),setChecklistWarningTask(null)},className:"px-4 py-2 text-white bg-yellow-600 rounded-lg hover:bg-yellow-700 transition-colors",children:"Got It"})})]})}),(0,S.jsx)(b.A,{isOpen:we,onClose:()=>se({showTaskCalculationModal:!1}),title:"Task Calculation & Scoring Configuration",size:"6xl",children:(0,S.jsxs)("div",{className:"space-y-6",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Scoring Weights (%)"}),(0,S.jsxs)("div",{className:"grid grid-cols-5 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Impact"}),(0,S.jsx)("input",{type:"number",value:X.impact,onChange:e=>updateScoringWeights({...X,impact:parseInt(e.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"100"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,S.jsx)("input",{type:"number",value:X.priority,onChange:e=>updateScoringWeights({...X,priority:parseInt(e.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"100"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complexity"}),(0,S.jsx)("input",{type:"number",value:X.complexity,onChange:e=>updateScoringWeights({...X,complexity:parseInt(e.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"100"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effort"}),(0,S.jsx)("input",{type:"number",value:X.effort,onChange:e=>updateScoringWeights({...X,effort:parseInt(e.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"100"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Labels"}),(0,S.jsx)("input",{type:"number",value:X.labels,onChange:e=>updateScoringWeights({...X,labels:parseInt(e.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"100"})]})]}),(0,S.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:["Total: ",Object.values(X).reduce((e,t)=>e+t,0),"%"]})]}),(0,S.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Impact Points"}),(0,S.jsx)("div",{className:"space-y-2",children:Object.entries(Z.impact).map(e=>{let[t,s]=e;return(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("span",{className:"text-sm text-gray-700",children:t}),(0,S.jsx)("input",{type:"number",value:s,onChange:e=>ee("impact",t,e.target.value),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",min:"0"})]},t)})})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Priority Points"}),(0,S.jsx)("div",{className:"space-y-2",children:Object.entries(Z.priority).map(e=>{let[t,s]=e;return(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("span",{className:"text-sm text-gray-700",children:t}),(0,S.jsx)("input",{type:"number",value:s,onChange:e=>ee("priority",t,e.target.value),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",min:"0"})]},t)})})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Complexity Points"}),(0,S.jsx)("div",{className:"space-y-2",children:Object.entries(Z.complexity).map(e=>{let[t,s]=e;return(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("span",{className:"text-sm text-gray-700",children:t}),(0,S.jsx)("input",{type:"number",value:s,onChange:e=>ee("complexity",t,e.target.value),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",min:"0"})]},t)})})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Effort Points"}),(0,S.jsx)("div",{className:"space-y-2",children:Object.entries(Z.effort).map(e=>{let[t,s]=e;return(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("span",{className:"text-sm text-gray-700",children:t}),(0,S.jsx)("input",{type:"number",value:s,onChange:e=>ee("effort",t,e.target.value),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",min:"0"})]},t)})})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Labels Points"}),(0,S.jsx)("div",{className:"space-y-2",children:Object.entries(Z.labels).map(e=>{let[t,s]=e;return(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("span",{className:"text-sm text-gray-700",children:t}),(0,S.jsx)("input",{type:"number",value:s,onChange:e=>ee("labels",t,e.target.value),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",min:"0"})]},t)})})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Task Scores"}),(0,S.jsx)("div",{className:"overflow-x-auto",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,S.jsx)("thead",{className:"bg-gray-50",children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Task"}),(0,S.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),(0,S.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),(0,S.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Breakdown"})]})}),(0,S.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:oe.slice(0,10).map(e=>{const t=ps(e),s=(e=>fs(e))(e);return(0,S.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,S.jsxs)("td",{className:"px-6 py-4",children:[(0,S.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,S.jsxs)("div",{className:"text-sm text-gray-500",children:[e.impact," \u2022 ",e.priority," \u2022 ",e.complexity]})]}),(0,S.jsx)("td",{className:"px-6 py-4",children:(0,S.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${ys(t)}`,children:t})}),(0,S.jsx)("td",{className:"px-6 py-4",children:(0,S.jsx)("span",{className:"text-sm text-gray-900",children:gs(t)})}),(0,S.jsx)("td",{className:"px-6 py-4",children:(0,S.jsxs)("div",{className:"text-xs text-gray-600 space-y-1",children:[(0,S.jsxs)("div",{children:["Impact: ",s.impact]}),(0,S.jsxs)("div",{children:["Priority: ",s.priority]}),(0,S.jsxs)("div",{children:["Complexity: ",s.complexity]}),(0,S.jsxs)("div",{children:["Effort: ",s.effort]}),(0,S.jsxs)("div",{children:["Labels: ",s.labels]})]})})]},e.id)})})]})})]})]})}),(0,S.jsx)(b.A,{isOpen:ve,onClose:()=>se({showColumnModal:!1}),title:"Customize Table Columns",size:"lg",children:(0,S.jsxs)("div",{className:"space-y-6",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Select which columns you want to display, customize their widths, and set their order:"}),(0,S.jsxs)("div",{className:"mb-6",children:[(0,S.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Column Visibility"}),(0,S.jsx)("div",{className:"grid grid-cols-2 gap-3 max-h-64 overflow-y-auto",children:[{key:"checkbox",name:"Select"},{key:"id",name:"ID"},{key:"title",name:"Title"},{key:"task",name:"Task"},{key:"department",name:"Department"},{key:"task_category",name:"Task Category"},{key:"project",name:"Project"},{key:"start_date",name:"Start Date"},{key:"due_date",name:"Due Date"},{key:"without_due_date",name:"Without Due Date"},{key:"assigned_to",name:"Assigned To"},{key:"assignedTo",name:"Assigned To"},{key:"status",name:"Status"},{key:"description",name:"Description"},{key:"responsible",name:"Responsible"},{key:"accountable",name:"Accountable"},{key:"consulted",name:"Consulted"},{key:"informed",name:"Informed"},{key:"trained",name:"Trained"},{key:"labels",name:"Labels"},{key:"label_id",name:"Label ID"},{key:"milestones",name:"Milestones"},{key:"priority",name:"Priority"},{key:"complexity",name:"Complexity"},{key:"impact",name:"Impact"},{key:"unit",name:"Unit"},{key:"target",name:"Target"},{key:"effort_estimate_label",name:"Effort Estimate"},{key:"effortEstimate",name:"Effort Estimate"},{key:"time_estimate",name:"Time Estimate"},{key:"make_private",name:"Make Private"},{key:"share",name:"Share"},{key:"repeat",name:"Repeat"},{key:"is_dependent",name:"Is Dependent"},{key:"validation_by",name:"Validation By"},{key:"effort_label",name:"Effort Label"},{key:"checklist",name:"Checklist"},{key:"workflow_guide",name:"Workflow Guide"},{key:"timer_started_at",name:"Timer Started At"},{key:"logged_seconds",name:"Logged Seconds"},{key:"timer",name:"Timer / Time"},{key:"created_at",name:"Created At"},{key:"updated_at",name:"Updated At"},{key:"score",name:"Score"},{key:"actions",name:"Actions"}].map(e=>(0,S.jsxs)("label",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",children:[(0,S.jsx)("input",{type:"checkbox",checked:Y[e.key],onChange:()=>{return t=e.key,void J(e=>({...e,[t]:!e[t]}));var t},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,S.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.name})]},e.key))})]}),(0,S.jsxs)("div",{className:"mb-6",children:[(0,S.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Column Order"}),(0,S.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:K.map((e,t)=>{var s;return Y[e]&&(0,S.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-gray-50",children:[(0,S.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,S.jsxs)("span",{className:"text-sm text-gray-500 w-8 text-center",children:["#",t+1]}),(0,S.jsx)("span",{className:"text-sm font-medium text-gray-700",children:(null===(s=[{key:"checkbox",name:"Select"},{key:"id",name:"ID"},{key:"title",name:"Title"},{key:"task",name:"Task"},{key:"department",name:"Department"},{key:"task_category",name:"Task Category"},{key:"project",name:"Project"},{key:"start_date",name:"Start Date"},{key:"due_date",name:"Due Date"},{key:"without_due_date",name:"Without Due Date"},{key:"assigned_to",name:"Assigned To"},{key:"assignedTo",name:"Assigned To"},{key:"status",name:"Status"},{key:"description",name:"Description"},{key:"responsible",name:"Responsible"},{key:"accountable",name:"Accountable"},{key:"consulted",name:"Consulted"},{key:"informed",name:"Informed"},{key:"trained",name:"Trained"},{key:"labels",name:"Labels"},{key:"label_id",name:"Label ID"},{key:"milestones",name:"Milestones"},{key:"priority",name:"Priority"},{key:"complexity",name:"Complexity"},{key:"impact",name:"Impact"},{key:"unit",name:"Unit"},{key:"target",name:"Target"},{key:"effort_estimate_label",name:"Effort Estimate"},{key:"effortEstimate",name:"Effort Estimate"},{key:"time_estimate",name:"Time Estimate"},{key:"make_private",name:"Make Private"},{key:"share",name:"Share"},{key:"repeat",name:"Repeat"},{key:"is_dependent",name:"Is Dependent"},{key:"validation_by",name:"Validation By"},{key:"effort_label",name:"Effort Label"},{key:"checklist",name:"Checklist"},{key:"workflow_guide",name:"Workflow Guide"},{key:"timer_started_at",name:"Timer Started At"},{key:"logged_seconds",name:"Logged Seconds"},{key:"timer",name:"Timer / Time"},{key:"created_at",name:"Created At"},{key:"updated_at",name:"Updated At"},{key:"score",name:"Score"},{key:"actions",name:"Actions"}].find(t=>t.key===e))||void 0===s?void 0:s.name)||e})]}),(0,S.jsxs)("div",{className:"flex space-x-2",children:[(0,S.jsx)("button",{onClick:()=>(e=>{Q(t=>{const s=[...t],a=s.indexOf(e);return a>0&&([s[a],s[a-1]]=[s[a-1],s[a]]),s})})(e),disabled:0===t,className:"p-1 rounded "+(0===t?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-100 text-blue-600 hover:bg-blue-200"),title:"Move Up",children:"\u2191"}),(0,S.jsx)("button",{onClick:()=>(e=>{Q(t=>{const s=[...t],a=s.indexOf(e);return a<s.length-1&&([s[a],s[a+1]]=[s[a+1],s[a]]),s})})(e),disabled:t===K.length-1,className:"p-1 rounded "+(t===K.length-1?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-100 text-blue-600 hover:bg-blue-200"),title:"Move Down",children:"\u2193"})]})]},e)})})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Column Widths"}),(0,S.jsx)("div",{className:"space-y-3",children:[{key:"checkbox",name:"Select"},{key:"id",name:"ID"},{key:"title",name:"Title"},{key:"task",name:"Task"},{key:"department",name:"Department"},{key:"task_category",name:"Task Category"},{key:"project",name:"Project"},{key:"start_date",name:"Start Date"},{key:"due_date",name:"Due Date"},{key:"without_due_date",name:"Without Due Date"},{key:"assigned_to",name:"Assigned To"},{key:"assignedTo",name:"Assigned To"},{key:"status",name:"Status"},{key:"description",name:"Description"},{key:"responsible",name:"Responsible"},{key:"accountable",name:"Accountable"},{key:"consulted",name:"Consulted"},{key:"informed",name:"Informed"},{key:"trained",name:"Trained"},{key:"labels",name:"Labels"},{key:"label_id",name:"Label ID"},{key:"milestones",name:"Milestones"},{key:"priority",name:"Priority"},{key:"complexity",name:"Complexity"},{key:"impact",name:"Impact"},{key:"unit",name:"Unit"},{key:"target",name:"Target"},{key:"effort_estimate_label",name:"Effort Estimate"},{key:"effortEstimate",name:"Effort Estimate"},{key:"time_estimate",name:"Time Estimate"},{key:"make_private",name:"Make Private"},{key:"share",name:"Share"},{key:"repeat",name:"Repeat"},{key:"is_dependent",name:"Is Dependent"},{key:"validation_by",name:"Validation By"},{key:"effort_label",name:"Effort Label"},{key:"checklist",name:"Checklist"},{key:"workflow_guide",name:"Workflow Guide"},{key:"timer_started_at",name:"Timer Started At"},{key:"logged_seconds",name:"Logged Seconds"},{key:"timer",name:"Timer / Time"},{key:"created_at",name:"Created At"},{key:"updated_at",name:"Updated At"},{key:"score",name:"Score"},{key:"actions",name:"Actions"}].map(e=>Y[e.key]&&(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("span",{className:"text-sm text-gray-700 w-32",children:e.name}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("input",{type:"range",min:"60",max:"500",value:G[e.key],onChange:t=>{return s=e.key,a=parseInt(t.target.value),void q(e=>({...e,[s]:Math.max(60,Math.min(500,a))}));var s,a},className:"w-32"}),(0,S.jsxs)("span",{className:"text-sm text-gray-500 w-12 text-right",children:[G[e.key],"px"]})]})]},e.key))})]})]}),(0,S.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[(0,S.jsx)(j.A,{variant:"secondary",onClick:()=>{J({checkbox:!0,id:!1,title:!0,task:!0,department:!0,task_category:!1,project:!1,start_date:!1,due_date:!0,without_due_date:!1,assigned_to:!0,assignedTo:!0,status:!0,description:!1,responsible:!1,accountable:!1,consulted:!1,informed:!1,trained:!1,labels:!1,label_id:!1,milestones:!1,priority:!0,complexity:!0,impact:!0,unit:!0,target:!0,effort_estimate_label:!0,effortEstimate:!0,time_estimate:!0,make_private:!1,share:!1,repeat:!1,is_dependent:!1,validation_by:!1,effort_label:!1,checklist:!1,workflow_guide:!1,timer_started_at:!1,logged_seconds:!0,timer:!0,created_at:!1,updated_at:!1,score:!0,actions:!0}),q({checkbox:60,id:80,title:300,department:120,task_category:120,project:120,start_date:100,due_date:100,without_due_date:100,assigned_to:150,status:100,description:200,responsible:120,accountable:120,consulted:120,informed:120,trained:120,labels:120,label_id:80,milestones:120,priority:100,complexity:100,impact:100,unit:80,target:80,effort_estimate_label:120,time_estimate:120,make_private:100,share:80,repeat:80,is_dependent:100,validation_by:120,effort_label:120,checklist:150,workflow_guide:150,timer_started_at:120,logged_seconds:100,created_at:120,updated_at:120,score:80,actions:100}),Q(["checkbox","task","title","department","assignedTo","assigned_to","priority","complexity","impact","effortEstimate","effort_estimate_label","score","unit","target","status","timer","logged_seconds","actions","id","task_category","project","start_date","due_date","without_due_date","description","responsible","accountable","consulted","informed","trained","labels","label_id","milestones","make_private","share","repeat","is_dependent","validation_by","effort_label","checklist","workflow_guide","timer_started_at","created_at","updated_at"]),null!==D&&void 0!==D&&D.id&&(localStorage.removeItem(`taskColumns_${D.id}`),localStorage.removeItem(`taskColumnWidths_${D.id}`),localStorage.removeItem(`taskColumnOrder_${D.id}`))},children:"Reset to Default"}),(0,S.jsxs)("div",{className:"flex space-x-3",children:[(0,S.jsx)(j.A,{variant:"secondary",onClick:()=>se({showColumnModal:!1}),children:"Cancel"}),(0,S.jsx)(j.A,{onClick:()=>se({showColumnModal:!1}),children:"Apply"})]})]})]})})]}))});D.displayName="Tasks";const E=D}}]);
//# sourceMappingURL=991.8990f5e9.chunk.js.map