{"version":3,"file":"static/js/757.a45730d2.chunk.js","mappings":"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","sources":["components/views/Errors.js"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport { Trash2 } from 'lucide-react';\nimport { useAuth } from '../../contexts/AuthContext';\n\nexport default function Errors() {\n  const { user } = useAuth();\n  const [employees, setEmployees] = useState([]);\n  const [tasks, setTasks] = useState([]);\n  const [form, setForm] = useState({ employee_id: '', task_id: '', severity: 'High', description: '', error_date: '' });\n  const [submitting, setSubmitting] = useState(false);\n  const [errors, setErrors] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedErrors, setSelectedErrors] = useState([]);\n  const [deleting, setDeleting] = useState(false);\n\n  useEffect(() => {\n    const fetchInitial = async () => {\n      // Prepare headers with user permissions for the tasks request\n      const tasksHeaders = {};\n      if (user) {\n        tasksHeaders['user-role'] = user.role || 'employee';\n        tasksHeaders['user-permissions'] = JSON.stringify(user.permissions || []);\n        tasksHeaders['user-name'] = user.name || '';\n      }\n      \n      const [empRes, taskRes] = await Promise.all([\n        fetch('http://localhost:5000/api/employees'),\n        fetch('http://localhost:5000/api/tasks', { headers: tasksHeaders })\n      ]);\n      if (empRes.ok) {\n        const empData = await empRes.json();\n        // Handle both paginated and non-paginated responses\n        setEmployees(Array.isArray(empData.data) ? empData.data : (Array.isArray(empData) ? empData : []));\n      }\n      if (taskRes.ok) {\n        const taskData = await taskRes.json();\n        // Handle both paginated and non-paginated responses\n        setTasks(Array.isArray(taskData.data) ? taskData.data : (Array.isArray(taskData) ? taskData : []));\n      }\n    };\n    \n    if (user) {\n      fetchInitial();\n    }\n    fetch('http://localhost:5000/api/errors').then(r=>r.ok?r.json():[]).then(setErrors).catch(()=>{});\n  }, [user]);\n\n  const filteredTasks = useMemo(() => {\n    if (!form.employee_id) return [];\n    const employee = (employees || []).find(e => String(e.id) === String(form.employee_id));\n    if (!employee) return [];\n    const name = employee.name;\n    return (tasks || []).filter(t => t.assigned_to && t.assigned_to.includes(name));\n  }, [form.employee_id, employees, tasks]);\n\n  const displayedErrors = useMemo(() => {\n    const q = searchTerm.trim().toLowerCase();\n    if (!q) return errors;\n    return errors.filter(e => (e.employee_name || '').toLowerCase().includes(q));\n  }, [errors, searchTerm]);\n\n  const submit = async (e) => {\n    e.preventDefault();\n    if (!form.employee_id || !form.task_id || !form.description.trim()) return alert('All fields are required.');\n    setSubmitting(true);\n    try {\n      const res = await fetch('http://localhost:5000/api/errors', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(form)\n      });\n      const text = await res.text();\n      let data;\n      try { data = JSON.parse(text); } catch { data = { error: text }; }\n      if (!res.ok) throw new Error(data.error || 'Failed to save');\n      setForm({ employee_id: '', task_id: '', severity: 'High', description: '', error_date: '' });\n      setErrors(prev => [data.item, ...prev]);\n      alert('Saved');\n    } catch (err) {\n      alert(err.message);\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Handle individual delete\n  const handleDelete = async (id) => {\n    if (!confirm('Are you sure you want to delete this error record?')) return;\n    \n    setDeleting(true);\n    try {\n      const response = await fetch(`http://localhost:5000/api/errors/${id}`, {\n        method: 'DELETE',\n      });\n      \n      if (response.ok) {\n        setErrors(prev => prev.filter(error => error.id !== id));\n        setSelectedErrors(prev => prev.filter(selectedId => selectedId !== id));\n      } else {\n        const error = await response.json();\n        alert(error.error || 'Error deleting record');\n      }\n    } catch (error) {\n      console.error('Error deleting error:', error);\n      alert('Error deleting record');\n    } finally {\n      setDeleting(false);\n    }\n  };\n\n  // Handle bulk delete\n  const handleBulkDelete = async () => {\n    if (selectedErrors.length === 0) {\n      alert('Please select errors to delete');\n      return;\n    }\n    \n    if (!confirm(`Are you sure you want to delete ${selectedErrors.length} error record(s)?`)) return;\n    \n    setDeleting(true);\n    try {\n      const response = await fetch('http://localhost:5000/api/errors/bulk', {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ ids: selectedErrors }),\n      });\n      \n      if (response.ok) {\n        const result = await response.json();\n        setErrors(prev => prev.filter(error => !selectedErrors.includes(error.id)));\n        setSelectedErrors([]);\n        alert(result.message);\n      } else {\n        const error = await response.json();\n        alert(error.error || 'Error deleting records');\n      }\n    } catch (error) {\n      console.error('Error bulk deleting errors:', error);\n      alert('Error deleting records');\n    } finally {\n      setDeleting(false);\n    }\n  };\n\n  // Handle individual checkbox change\n  const handleSelectError = (errorId) => {\n    setSelectedErrors(prev => {\n      const newSelected = prev.includes(errorId)\n        ? prev.filter(id => id !== errorId)\n        : [...prev, errorId];\n      return newSelected;\n    });\n  };\n\n  // Handle select all checkbox\n  const handleSelectAll = () => {\n    const allDisplayedIds = displayedErrors.map(error => error.id);\n    const allSelected = allDisplayedIds.every(id => selectedErrors.includes(id));\n    \n    if (allSelected) {\n      setSelectedErrors(prev => prev.filter(id => !allDisplayedIds.includes(id)));\n    } else {\n      setSelectedErrors(prev => [...new Set([...prev, ...allDisplayedIds])]);\n    }\n  };\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"flex justify-between items-center mb-6\">\n        <h1 className=\"text-2xl font-semibold text-gray-900\">Employee Errors</h1>\n      </div>\n\n      <form onSubmit={submit} className=\"space-y-4 bg-white p-6 rounded-lg shadow-sm border\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Employee *</label>\n            <select \n              value={form.employee_id} \n              onChange={e=>setForm(f=>({...f, employee_id: e.target.value, task_id: ''}))} \n              className=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"\n              required\n            >\n              <option value=\"\">Select Employee...</option>\n              {(employees || []).map(emp => <option key={emp.id} value={emp.id}>{emp.name}</option>)}\n            </select>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Task *</label>\n            <select \n              value={form.task_id} \n              onChange={e=>setForm(f=>({...f, task_id: e.target.value}))} \n              className=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100\" \n              disabled={!form.employee_id}\n              required\n            >\n              <option value=\"\">Select Task...</option>\n              {filteredTasks.map(task => <option key={task.id} value={task.id}>{task.title}</option>)}\n            </select>\n            {!form.employee_id && (\n              <p className=\"text-xs text-gray-500 mt-1\">Please select an employee first</p>\n            )}\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Error Date</label>\n            <input \n              type=\"date\" \n              value={form.error_date} \n              onChange={e=>setForm(f=>({...f, error_date: e.target.value}))} \n              className=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\" \n            />\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Severity *</label>\n            <select \n              value={form.severity} \n              onChange={e=>setForm(f=>({...f, severity: e.target.value}))} \n              className=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"\n              required\n            >\n              <option value=\"High\">High</option>\n              <option value=\"Medium\">Medium</option>\n              <option value=\"Low\">Low</option>\n            </select>\n          </div>\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">Description *</label>\n          <textarea \n            value={form.description} \n            onChange={e=>setForm(f=>({...f, description: e.target.value}))} \n            className=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\" \n            rows={4} \n            placeholder=\"Describe the error in detail...\"\n            required\n          />\n        </div>\n        <div className=\"flex justify-end pt-4\">\n          <button \n            type=\"submit\" \n            disabled={submitting} \n            className=\"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200\"\n          >\n            {submitting ? 'Saving...' : 'Save Error'}\n          </button>\n        </div>\n      </form>\n\n      <div className=\"mt-8 bg-white rounded-lg shadow-sm border\">\n        <div className=\"px-6 py-4 border-b flex items-center justify-between\">\n          <div className=\"flex items-center space-x-4\">\n            <h2 className=\"text-lg font-semibold text-gray-900\">Error Records</h2>\n            {selectedErrors.length > 0 && (\n              <button\n                onClick={handleBulkDelete}\n                disabled={deleting}\n                className=\"flex items-center px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                <Trash2 className=\"w-4 h-4 mr-2\" />\n                {deleting ? 'Deleting...' : `Delete Selected (${selectedErrors.length})`}\n              </button>\n            )}\n          </div>\n          <input\n            type=\"text\"\n            placeholder=\"Search by employee...\"\n            value={searchTerm}\n            onChange={(e)=>setSearchTerm(e.target.value)}\n            className=\"border border-gray-300 rounded-lg px-3 py-2 w-64 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"\n          />\n        </div>\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full divide-y divide-gray-200\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-6 py-3 text-left\">\n                  <input\n                    type=\"checkbox\"\n                    checked={displayedErrors.length > 0 && displayedErrors.every(error => selectedErrors.includes(error.id))}\n                    onChange={handleSelectAll}\n                    className=\"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded\"\n                  />\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Employee</th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Task</th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Severity</th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Description</th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Error Date</th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Created</th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Actions</th>\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {displayedErrors.length === 0 ? (\n                <tr>\n                  <td colSpan=\"8\" className=\"px-6 py-8 text-center text-gray-500\">\n                    No error records found\n                  </td>\n                </tr>\n              ) : (\n                displayedErrors.map(err => (\n                  <tr key={err.id} className=\"hover:bg-gray-50\">\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedErrors.includes(err.id)}\n                        onChange={() => handleSelectError(err.id)}\n                        className=\"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded\"\n                      />\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">{err.employee_name}</td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">{err.task_title}</td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\n                        err.severity === 'High' ? 'bg-red-100 text-red-800' :\n                        err.severity === 'Medium' ? 'bg-yellow-100 text-yellow-800' :\n                        'bg-green-100 text-green-800'\n                      }`}>\n                        {err.severity}\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-4 text-sm text-gray-900 max-w-xs truncate\" title={err.description}>{err.description}</td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">{err.error_date ? new Date(err.error_date).toLocaleDateString() : '-'}</td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{new Date(err.created_at).toLocaleString()}</td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                      <button\n                        onClick={() => handleDelete(err.id)}\n                        disabled={deleting}\n                        className=\"text-red-600 hover:text-red-900 disabled:opacity-50 disabled:cursor-not-allowed\"\n                        title=\"Delete error\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </button>\n                    </td>\n                  </tr>\n                ))\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n\n"],"names":["Errors","user","useAuth","employees","setEmployees","useState","tasks","setTasks","form","setForm","employee_id","task_id","severity","description","error_date","submitting","setSubmitting","errors","setErrors","searchTerm","setSearchTerm","selectedErrors","setSelectedErrors","deleting","setDeleting","useEffect","async","tasksHeaders","role","JSON","stringify","permissions","name","empRes","taskRes","Promise","all","fetch","headers","ok","empData","json","Array","isArray","data","taskData","fetchInitial","then","r","catch","filteredTasks","useMemo","employee","find","e","String","id","filter","t","assigned_to","includes","displayedErrors","q","trim","toLowerCase","employee_name","_jsxs","className","children","_jsx","onSubmit","preventDefault","alert","res","method","body","text","parse","error","Error","prev","item","err","message","value","onChange","f","target","required","map","emp","disabled","task","title","type","rows","placeholder","length","onClick","confirm","response","ids","result","console","Trash2","checked","every","handleSelectAll","allDisplayedIds","allSelected","Set","colSpan","handleSelectError","errorId","task_title","Date","toLocaleDateString","created_at","toLocaleString","selectedId","handleDelete"],"sourceRoot":""}